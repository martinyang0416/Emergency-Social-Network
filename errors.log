[33m[1m[1m●[22m[1m Validation Warning[22m:[39m
[33m[39m
[33m  Unknown option [1m"test"[22m with value [1m"jest --detectOpenHandles"[22m was found.[39m
[33m  This is probably a typing mistake. Fixing it will remove this message.[39m
[33m[39m
[33m  [1mConfiguration Documentation:[22m[39m
[33m  https://jestjs.io/docs/configuration[39m
[33m[39m
[33m[1m[1m●[22m[1m Validation Warning[22m:[39m
[33m[39m
[33m  Unknown option [1m"test"[22m with value [1m"jest --detectOpenHandles"[22m was found.[39m
[33m  This is probably a typing mistake. Fixing it will remove this message.[39m
[33m[39m
[33m  [1mConfiguration Documentation:[22m[39m
[33m  https://jestjs.io/docs/configuration[39m
[33m[39m
[0m[7m[1m[31m FAIL [39m[22m[27m[0m [2mtests/integration/[22m[1mreviewController.test.js[22m ([0m[1m[41m5.117 s[49m[22m[0m)
  [1m● [22mConsole

    [2mconsole.log[22m
      SSH connection established.
[2m[22m
[2m      [2mat Client.log ([22m[2mconfigurations/mysqlDatabase.js[2m:180:25)[22m[2m[22m

    [2mconsole.log[22m
      Connected to database: sb2-test
[2m[22m
[2m      [2mat log ([22m[2mconfigurations/dbConfig.js[2m:62:17)[22m[2m[22m

    [2mconsole.log[22m
      Connected to database in setDatabaseconnection: sb2
[2m[22m
[2m      [2mat log ([22m[2mconfigurations/dbConfig.js[2m:31:17)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching reviews: Error: Unknown column 'u.account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/reviewModel.js:20:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/reviewModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/reviewModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/reviewModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/reviewModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/reviewModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5) {[39m
[31m        code: 'ER_BAD_FIELD_ERROR',[39m
[31m        errno: 1054,[39m
[31m        sql: '\n' +[39m
[31m          '            SELECT u.user_name AS reviewer_name,\n' +[39m
[31m          '                rr.review_content,\n' +[39m
[31m          '                rr.upvote_downvote,\n' +[39m
[31m          '                rr.created_at\n' +[39m
[31m          '            FROM resource_reviews rr\n' +[39m
[31m          '            JOIN user u ON rr.reviewer_id = u.id\n' +[39m
[31m          '            WHERE rr.resource_id = ?\n' +[39m
[31m          "            AND u.account_status = 'active'\n" +[39m
[31m          '            ORDER BY rr.created_at DESC;\n' +[39m
[31m          '        ',[39m
[31m        sqlState: '42S22',[39m
[31m        sqlMessage: "Unknown column 'u.account_status' in 'where clause'"[39m
[31m      }[39m
[2m[22m
[2m    [0m [90m 21 |[39m             [36mreturn[39m rows[33m;[39m[22m
[2m     [90m 22 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 23 |[39m             console[33m.[39merror([32m"Error fetching reviews:"[39m[33m,[39m error)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 24 |[39m             [36mthrow[39m error[33m;[39m[22m
[2m     [90m 25 |[39m         }[22m
[2m     [90m 26 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/reviewModel.js[2m:23:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching reviews: Error: Unknown column 'u.account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/reviewModel.js:20:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/reviewModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/reviewModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/reviewModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/reviewModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/reviewModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5) {[39m
[31m        code: 'ER_BAD_FIELD_ERROR',[39m
[31m        errno: 1054,[39m
[31m        sql: '\n' +[39m
[31m          '            SELECT u.user_name AS reviewer_name,\n' +[39m
[31m          '                rr.review_content,\n' +[39m
[31m          '                rr.upvote_downvote,\n' +[39m
[31m          '                rr.created_at\n' +[39m
[31m          '            FROM resource_reviews rr\n' +[39m
[31m          '            JOIN user u ON rr.reviewer_id = u.id\n' +[39m
[31m          '            WHERE rr.resource_id = ?\n' +[39m
[31m          "            AND u.account_status = 'active'\n" +[39m
[31m          '            ORDER BY rr.created_at DESC;\n' +[39m
[31m          '        ',[39m
[31m        sqlState: '42S22',[39m
[31m        sqlMessage: "Unknown column 'u.account_status' in 'where clause'"[39m
[31m      }[39m
[2m[22m
[2m    [0m [90m 14 |[39m             })[33m;[39m[22m
[2m     [90m 15 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 16 |[39m             console[33m.[39merror([32m"Error fetching reviews:"[39m[33m,[39m error)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 17 |[39m             res[33m.[39mstatus([35m500[39m)[33m.[39mjson({[22m
[2m     [90m 18 |[39m                 message[33m:[39m [32m"Error fetching reviews"[39m[33m,[39m[22m
[2m     [90m 19 |[39m                 error[33m:[39m error[33m.[39mmessage[33m,[39m[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/reviewController.js[2m:16:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/reviewController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/reviewController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/reviewController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/reviewController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/reviewController.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching reviews: Error: Unknown column 'u.account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/reviewModel.js:20:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/reviewModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/reviewModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/reviewModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/reviewModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/reviewModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5) {[39m
[31m        code: 'ER_BAD_FIELD_ERROR',[39m
[31m        errno: 1054,[39m
[31m        sql: '\n' +[39m
[31m          '            SELECT u.user_name AS reviewer_name,\n' +[39m
[31m          '                rr.review_content,\n' +[39m
[31m          '                rr.upvote_downvote,\n' +[39m
[31m          '                rr.created_at\n' +[39m
[31m          '            FROM resource_reviews rr\n' +[39m
[31m          '            JOIN user u ON rr.reviewer_id = u.id\n' +[39m
[31m          '            WHERE rr.resource_id = ?\n' +[39m
[31m          "            AND u.account_status = 'active'\n" +[39m
[31m          '            ORDER BY rr.created_at DESC;\n' +[39m
[31m          '        ',[39m
[31m        sqlState: '42S22',[39m
[31m        sqlMessage: "Unknown column 'u.account_status' in 'where clause'"[39m
[31m      }[39m
[2m[22m
[2m    [0m [90m 21 |[39m             [36mreturn[39m rows[33m;[39m[22m
[2m     [90m 22 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 23 |[39m             console[33m.[39merror([32m"Error fetching reviews:"[39m[33m,[39m error)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 24 |[39m             [36mthrow[39m error[33m;[39m[22m
[2m     [90m 25 |[39m         }[22m
[2m     [90m 26 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/reviewModel.js[2m:23:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching reviews: Error: Unknown column 'u.account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/reviewModel.js:20:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/reviewModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/reviewModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/reviewModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/reviewModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/reviewModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5) {[39m
[31m        code: 'ER_BAD_FIELD_ERROR',[39m
[31m        errno: 1054,[39m
[31m        sql: '\n' +[39m
[31m          '            SELECT u.user_name AS reviewer_name,\n' +[39m
[31m          '                rr.review_content,\n' +[39m
[31m          '                rr.upvote_downvote,\n' +[39m
[31m          '                rr.created_at\n' +[39m
[31m          '            FROM resource_reviews rr\n' +[39m
[31m          '            JOIN user u ON rr.reviewer_id = u.id\n' +[39m
[31m          '            WHERE rr.resource_id = ?\n' +[39m
[31m          "            AND u.account_status = 'active'\n" +[39m
[31m          '            ORDER BY rr.created_at DESC;\n' +[39m
[31m          '        ',[39m
[31m        sqlState: '42S22',[39m
[31m        sqlMessage: "Unknown column 'u.account_status' in 'where clause'"[39m
[31m      }[39m
[2m[22m
[2m    [0m [90m 14 |[39m             })[33m;[39m[22m
[2m     [90m 15 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 16 |[39m             console[33m.[39merror([32m"Error fetching reviews:"[39m[33m,[39m error)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 17 |[39m             res[33m.[39mstatus([35m500[39m)[33m.[39mjson({[22m
[2m     [90m 18 |[39m                 message[33m:[39m [32m"Error fetching reviews"[39m[33m,[39m[22m
[2m     [90m 19 |[39m                 error[33m:[39m error[33m.[39mmessage[33m,[39m[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/reviewController.js[2m:16:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/reviewController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/reviewController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/reviewController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/reviewController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/reviewController.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching reviews: Error: Unknown column 'u.account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/reviewModel.js:20:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/reviewModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/reviewModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/reviewModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/reviewModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/reviewModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5) {[39m
[31m        code: 'ER_BAD_FIELD_ERROR',[39m
[31m        errno: 1054,[39m
[31m        sql: '\n' +[39m
[31m          '            SELECT u.user_name AS reviewer_name,\n' +[39m
[31m          '                rr.review_content,\n' +[39m
[31m          '                rr.upvote_downvote,\n' +[39m
[31m          '                rr.created_at\n' +[39m
[31m          '            FROM resource_reviews rr\n' +[39m
[31m          '            JOIN user u ON rr.reviewer_id = u.id\n' +[39m
[31m          '            WHERE rr.resource_id = ?\n' +[39m
[31m          "            AND u.account_status = 'active'\n" +[39m
[31m          '            ORDER BY rr.created_at DESC;\n' +[39m
[31m          '        ',[39m
[31m        sqlState: '42S22',[39m
[31m        sqlMessage: "Unknown column 'u.account_status' in 'where clause'"[39m
[31m      }[39m
[2m[22m
[2m    [0m [90m 21 |[39m             [36mreturn[39m rows[33m;[39m[22m
[2m     [90m 22 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 23 |[39m             console[33m.[39merror([32m"Error fetching reviews:"[39m[33m,[39m error)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 24 |[39m             [36mthrow[39m error[33m;[39m[22m
[2m     [90m 25 |[39m         }[22m
[2m     [90m 26 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/reviewModel.js[2m:23:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching reviews: Error: Unknown column 'u.account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/reviewModel.js:20:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/reviewModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/reviewModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/reviewModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/reviewModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/reviewModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5) {[39m
[31m        code: 'ER_BAD_FIELD_ERROR',[39m
[31m        errno: 1054,[39m
[31m        sql: '\n' +[39m
[31m          '            SELECT u.user_name AS reviewer_name,\n' +[39m
[31m          '                rr.review_content,\n' +[39m
[31m          '                rr.upvote_downvote,\n' +[39m
[31m          '                rr.created_at\n' +[39m
[31m          '            FROM resource_reviews rr\n' +[39m
[31m          '            JOIN user u ON rr.reviewer_id = u.id\n' +[39m
[31m          '            WHERE rr.resource_id = ?\n' +[39m
[31m          "            AND u.account_status = 'active'\n" +[39m
[31m          '            ORDER BY rr.created_at DESC;\n' +[39m
[31m          '        ',[39m
[31m        sqlState: '42S22',[39m
[31m        sqlMessage: "Unknown column 'u.account_status' in 'where clause'"[39m
[31m      }[39m
[2m[22m
[2m    [0m [90m 14 |[39m             })[33m;[39m[22m
[2m     [90m 15 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 16 |[39m             console[33m.[39merror([32m"Error fetching reviews:"[39m[33m,[39m error)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 17 |[39m             res[33m.[39mstatus([35m500[39m)[33m.[39mjson({[22m
[2m     [90m 18 |[39m                 message[33m:[39m [32m"Error fetching reviews"[39m[33m,[39m[22m
[2m     [90m 19 |[39m                 error[33m:[39m error[33m.[39mmessage[33m,[39m[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/reviewController.js[2m:16:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/reviewController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/reviewController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/reviewController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/reviewController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/reviewController.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error adding review: Reviewer not found[39m
[2m[22m
[2m    [0m [90m 62 |[39m             [36mreturn[39m result[33m;[39m[22m
[2m     [90m 63 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 64 |[39m             console[33m.[39merror([32m"Error adding review:"[39m[33m,[39m error[33m.[39mmessage)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 65 |[39m             [36mthrow[39m error[33m;[39m[22m
[2m     [90m 66 |[39m         }        [22m
[2m     [90m 67 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/reviewModel.js[2m:64:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error adding review: Error: Reviewer not found[39m
[31m          at _callee2$ (/Users/shangchienliu/Desktop/f24-fse-sb2/models/reviewModel.js:43:23)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/reviewModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/reviewModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/reviewModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/reviewModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/reviewModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[2m[22m
[2m    [0m [90m 49 |[39m             })[33m;[39m[22m
[2m     [90m 50 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 51 |[39m             console[33m.[39merror([32m"Error adding review:"[39m[33m,[39m error)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 52 |[39m             res[33m.[39mstatus([35m500[39m)[33m.[39mjson({ message[33m:[39m [32m"Error adding review"[39m[33m,[39m error[33m:[39m error[33m.[39mmessage })[33m;[39m[22m
[2m     [90m 53 |[39m         }[22m
[2m     [90m 54 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/reviewController.js[2m:51:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/reviewController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/reviewController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/reviewController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/reviewController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/reviewController.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error adding review: Reviewer not found[39m
[2m[22m
[2m    [0m [90m 62 |[39m             [36mreturn[39m result[33m;[39m[22m
[2m     [90m 63 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 64 |[39m             console[33m.[39merror([32m"Error adding review:"[39m[33m,[39m error[33m.[39mmessage)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 65 |[39m             [36mthrow[39m error[33m;[39m[22m
[2m     [90m 66 |[39m         }        [22m
[2m     [90m 67 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/reviewModel.js[2m:64:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error adding review: Error: Reviewer not found[39m
[31m          at _callee2$ (/Users/shangchienliu/Desktop/f24-fse-sb2/models/reviewModel.js:43:23)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/reviewModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/reviewModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/reviewModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/reviewModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/reviewModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[2m[22m
[2m    [0m [90m 49 |[39m             })[33m;[39m[22m
[2m     [90m 50 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 51 |[39m             console[33m.[39merror([32m"Error adding review:"[39m[33m,[39m error)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 52 |[39m             res[33m.[39mstatus([35m500[39m)[33m.[39mjson({ message[33m:[39m [32m"Error adding review"[39m[33m,[39m error[33m:[39m error[33m.[39mmessage })[33m;[39m[22m
[2m     [90m 53 |[39m         }[22m
[2m     [90m 54 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/reviewController.js[2m:51:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/reviewController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/reviewController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/reviewController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/reviewController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/reviewController.js[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mIntegration Tests for ReviewController › getReviews › should fetch all reviews for a given resource ID successfully (positive)[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 73 |[39m             [36mawait[39m [33mReviewController[39m[33m.[39mgetReviews(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 74 |[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 75 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m    |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 76 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith({[22m
[2m     [90m 77 |[39m                 message[33m:[39m [32m"Reviews fetched successfully"[39m[33m,[39m[22m
[2m     [90m 78 |[39m                 data[33m:[39m expect[33m.[39marrayContaining([[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:75:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mIntegration Tests for ReviewController › getReviews › should return an empty array if no reviews exist for the resource (positive)[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 100 |[39m             [36mawait[39m [33mReviewController[39m[33m.[39mgetReviews(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 101 |[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 102 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 103 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith({[22m
[2m     [90m 104 |[39m                 message[33m:[39m [32m"Reviews fetched successfully"[39m[33m,[39m[22m
[2m     [90m 105 |[39m                 data[33m:[39m [][33m,[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:102:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mIntegration Tests for ReviewController › getReviews › should return 500 if there is an error fetching reviews (negative)[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 117 |[39m[22m
[2m     [90m 118 |[39m             [36mawait[39m [33mReviewController[39m[33m.[39mgetReviews(req[33m,[39m res)[33m;[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 119 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 120 |[39m[22m
[2m     [90m 121 |[39m             jest[33m.[39mrestoreAllMocks()[33m;[39m[22m
[2m     [90m 122 |[39m         })[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:119:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mIntegration Tests for ReviewController › getReviews › should return 500 if there is an error fetching reviews (negative)[39m[22m

    Database Error
[2m[22m
[2m    [0m [90m 108 |[39m[22m
[2m     [90m 109 |[39m         it([32m"should return 500 if there is an error fetching reviews (negative)"[39m[33m,[39m [36masync[39m () [33m=>[39m {[22m
[2m    [31m[1m>[22m[2m[39m[90m 110 |[39m             jest[33m.[39mspyOn(dbConnection[33m,[39m [32m"query"[39m)[33m.[39mmockRejectedValueOnce([36mnew[39m [33mError[39m([32m"Database Error"[39m))[33m;[39m[22m
[2m     [90m     |[39m                                                                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 111 |[39m[22m
[2m     [90m 112 |[39m             [36mconst[39m req [33m=[39m { params[33m:[39m { resourceId[33m:[39m [35m1[39m } }[33m;[39m[22m
[2m     [90m 113 |[39m             [36mconst[39m res [33m=[39m {[0m[22m
[2m[22m
[2m      [2mat _callee7$ ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:110:69)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat _next ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Object.<anonymous> ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mIntegration Tests for ReviewController › addReview › should add a new review successfully (positive)[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m201[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 142 |[39m             [36mawait[39m [33mReviewController[39m[33m.[39maddReview(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 143 |[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 144 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m201[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 145 |[39m[22m
[2m     [90m 146 |[39m             [36mconst[39m [rows] [33m=[39m [36mawait[39m dbConnection[33m.[39mquery([22m
[2m     [90m 147 |[39m                 [32m"SELECT * FROM resource_reviews WHERE review_content = ?"[39m[33m,[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:144:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mIntegration Tests for ReviewController › addReview › should return 500 if there is an error adding the review (negative)[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m201[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 192 |[39m[22m
[2m     [90m 193 |[39m             [36mawait[39m [33mReviewController[39m[33m.[39maddReview(req[33m,[39m res)[33m;[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 194 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m201[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 195 |[39m[22m
[2m     [90m 196 |[39m             jest[33m.[39mrestoreAllMocks()[33m;[39m[22m
[2m     [90m 197 |[39m         })[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:194:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mIntegration Tests for ReviewController › addReview › should return 500 if there is an error adding the review (negative)[39m[22m

    Database Error
[2m[22m
[2m    [0m [90m 179 |[39m[22m
[2m     [90m 180 |[39m         it([32m"should return 500 if there is an error adding the review (negative)"[39m[33m,[39m [36masync[39m () [33m=>[39m {[22m
[2m    [31m[1m>[22m[2m[39m[90m 181 |[39m             jest[33m.[39mspyOn(dbConnection[33m,[39m [32m"query"[39m)[33m.[39mmockRejectedValueOnce([36mnew[39m [33mError[39m([32m"Database Error"[39m))[33m;[39m[22m
[2m     [90m     |[39m                                                                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 182 |[39m[22m
[2m     [90m 183 |[39m             [36mconst[39m req [33m=[39m {[22m
[2m     [90m 184 |[39m                 params[33m:[39m { resourceId[33m:[39m [35m1[39m }[33m,[39m[0m[22m
[2m[22m
[2m      [2mat _callee11$ ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:181:69)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat _next ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Object.<anonymous> ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[0m[7m[1m[31m FAIL [39m[22m[27m[0m [2mtests/integration/[22m[1mannouncement.test.js[22m ([0m[1m[41m5.429 s[49m[22m[0m)
  [1m● [22mConsole

    [2mconsole.log[22m
      SSH connection established.
[2m[22m
[2m      [2mat Client.log ([22m[2mconfigurations/mysqlDatabase.js[2m:180:25)[22m[2m[22m

    [2mconsole.log[22m
      Connected to database: sb2-test
[2m[22m
[2m      [2mat log ([22m[2mconfigurations/dbConfig.js[2m:62:17)[22m[2m[22m

    [2mconsole.log[22m
      Connected to database in setDatabaseconnection: sb2
[2m[22m
[2m      [2mat log ([22m[2mconfigurations/dbConfig.js[2m:31:17)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error executing query Error: Unknown column 'account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:37:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[2m[22m
[2m    [0m [90m 51 |[39m             }[33m;[39m[22m
[2m     [90m 52 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 53 |[39m             console[33m.[39merror([32m"Error executing query"[39m[33m,[39m err[33m.[39mstack)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 54 |[39m             [36mthrow[39m err[33m;[39m[22m
[2m     [90m 55 |[39m         }[22m
[2m     [90m 56 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/userModel.js[2m:53:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error sending message: Unknown column 'account_status' in 'where clause'[39m
[2m[22m
[2m    [0m [90m 63 |[39m             })[33m;[39m[22m
[2m     [90m 64 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 65 |[39m             console[33m.[39merror([32m"Error sending message:"[39m[33m,[39m error[33m.[39mmessage)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 66 |[39m             res[33m.[39mstatus([35m500[39m)[33m.[39mjson({[22m
[2m     [90m 67 |[39m                 message[33m:[39m [32m"Error sending message"[39m[33m,[39m[22m
[2m     [90m 68 |[39m                 error[33m:[39m error[33m.[39mmessage[33m,[39m[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/messageController.js[2m:65:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error sending message: Sender name is missing.[39m
[2m[22m
[2m    [0m [90m 63 |[39m             })[33m;[39m[22m
[2m     [90m 64 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 65 |[39m             console[33m.[39merror([32m"Error sending message:"[39m[33m,[39m error[33m.[39mmessage)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 66 |[39m             res[33m.[39mstatus([35m500[39m)[33m.[39mjson({[22m
[2m     [90m 67 |[39m                 message[33m:[39m [32m"Error sending message"[39m[33m,[39m[22m
[2m     [90m 68 |[39m                 error[33m:[39m error[33m.[39mmessage[33m,[39m[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/messageController.js[2m:65:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat _next ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Function.<anonymous> ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Function.apply [as sendMessage] ([22m[2mcontrollers/messageController.js[2m:7:29)[22m[2m[22m
[2m      [2mat sendMessage ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:86:37)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat _next ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Object.<anonymous> ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error executing query Error: Unknown column 'account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:37:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[2m[22m
[2m    [0m [90m 51 |[39m             }[33m;[39m[22m
[2m     [90m 52 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 53 |[39m             console[33m.[39merror([32m"Error executing query"[39m[33m,[39m err[33m.[39mstack)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 54 |[39m             [36mthrow[39m err[33m;[39m[22m
[2m     [90m 55 |[39m         }[22m
[2m     [90m 56 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/userModel.js[2m:53:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error sending message: Unknown column 'account_status' in 'where clause'[39m
[2m[22m
[2m    [0m [90m 63 |[39m             })[33m;[39m[22m
[2m     [90m 64 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 65 |[39m             console[33m.[39merror([32m"Error sending message:"[39m[33m,[39m error[33m.[39mmessage)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 66 |[39m             res[33m.[39mstatus([35m500[39m)[33m.[39mjson({[22m
[2m     [90m 67 |[39m                 message[33m:[39m [32m"Error sending message"[39m[33m,[39m[22m
[2m     [90m 68 |[39m                 error[33m:[39m error[33m.[39mmessage[33m,[39m[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/messageController.js[2m:65:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error executing query Error: Unknown column 'account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:37:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[2m[22m
[2m    [0m [90m 51 |[39m             }[33m;[39m[22m
[2m     [90m 52 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 53 |[39m             console[33m.[39merror([32m"Error executing query"[39m[33m,[39m err[33m.[39mstack)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 54 |[39m             [36mthrow[39m err[33m;[39m[22m
[2m     [90m 55 |[39m         }[22m
[2m     [90m 56 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/userModel.js[2m:53:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error sending message: Unknown column 'account_status' in 'where clause'[39m
[2m[22m
[2m    [0m [90m 63 |[39m             })[33m;[39m[22m
[2m     [90m 64 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 65 |[39m             console[33m.[39merror([32m"Error sending message:"[39m[33m,[39m error[33m.[39mmessage)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 66 |[39m             res[33m.[39mstatus([35m500[39m)[33m.[39mjson({[22m
[2m     [90m 67 |[39m                 message[33m:[39m [32m"Error sending message"[39m[33m,[39m[22m
[2m     [90m 68 |[39m                 error[33m:[39m error[33m.[39mmessage[33m,[39m[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/messageController.js[2m:65:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m

    [2mconsole.log[22m
      Message ID:
[2m[22m
[2m      [2mat log ([22m[2mcontrollers/messageController.js[2m:76:17)[22m[2m[22m

    [2mconsole.log[22m
      2
[2m[22m
[2m      [2mat log ([22m[2mcontrollers/messageController.js[2m:77:17)[22m[2m[22m

    [2mconsole.log[22m
      number
[2m[22m
[2m      [2mat log ([22m[2mcontrollers/messageController.js[2m:78:17)[22m[2m[22m

    [2mconsole.log[22m
      correct
[2m[22m
[2m      [2mat log ([22m[2mmodels/messageModel.js[2m:129:25)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching messages: Error: Unknown column 'u.account_status' in 'where clause'[39m
[31m          at PromiseConnection.query (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:94:22)[39m
[31m          at query (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:141:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5) {[39m
[31m        code: 'ER_BAD_FIELD_ERROR',[39m
[31m        errno: 1054,[39m
[31m        sql: '\n' +[39m
[31m          '                SELECT a.announcement_content AS message_text,\n' +[39m
[31m          '                    a.announcement_sent_time AS message_sent_time,\n' +[39m
[31m          '                    u.user_name AS message_sender,\n' +[39m
[31m          '                    a.announcement_sender_status AS message_sender_status\n' +[39m
[31m          '                FROM announcements a\n' +[39m
[31m          '                JOIN user u ON a.sender_id = u.id\n' +[39m
[31m          "                WHERE u.account_status = 'active'\n" +[39m
[31m          '                ORDER BY a.announcement_sent_time ASC;\n' +[39m
[31m          '                ',[39m
[31m        sqlState: '42S22',[39m
[31m        sqlMessage: "Unknown column 'u.account_status' in 'where clause'"[39m
[31m      }[39m
[2m[22m
[2m    [0m [90m 143 |[39m             [36mreturn[39m rows[33m;[39m[22m
[2m     [90m 144 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 145 |[39m             console[33m.[39merror([32m'Error fetching messages:'[39m[33m,[39m error)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 146 |[39m             [36mthrow[39m error[33m;[39m[22m
[2m     [90m 147 |[39m         }[22m
[2m     [90m 148 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/messageModel.js[2m:145:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching messages: Error: Unknown column 'u.account_status' in 'where clause'[39m
[31m          at PromiseConnection.query (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:94:22)[39m
[31m          at query (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:141:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5) {[39m
[31m        code: 'ER_BAD_FIELD_ERROR',[39m
[31m        errno: 1054,[39m
[31m        sql: '\n' +[39m
[31m          '                SELECT a.announcement_content AS message_text,\n' +[39m
[31m          '                    a.announcement_sent_time AS message_sent_time,\n' +[39m
[31m          '                    u.user_name AS message_sender,\n' +[39m
[31m          '                    a.announcement_sender_status AS message_sender_status\n' +[39m
[31m          '                FROM announcements a\n' +[39m
[31m          '                JOIN user u ON a.sender_id = u.id\n' +[39m
[31m          "                WHERE u.account_status = 'active'\n" +[39m
[31m          '                ORDER BY a.announcement_sent_time ASC;\n' +[39m
[31m          '                ',[39m
[31m        sqlState: '42S22',[39m
[31m        sqlMessage: "Unknown column 'u.account_status' in 'where clause'"[39m
[31m      }[39m
[2m[22m
[2m    [0m [90m 86 |[39m             res[33m.[39mstatus([35m200[39m)[33m.[39mjson(modifiedMessages)[33m;[39m[22m
[2m     [90m 87 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 88 |[39m             console[33m.[39merror([32m"Error fetching messages:"[39m[33m,[39m error)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 89 |[39m             res[33m.[39mstatus([35m500[39m)[33m.[39mjson({ message[33m:[39m [32m"Error fetching messages"[39m })[33m;[39m[22m
[2m     [90m 90 |[39m         }[22m
[2m     [90m 91 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/messageController.js[2m:88:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m

    [2mconsole.log[22m
      Message ID:
[2m[22m
[2m      [2mat log ([22m[2mcontrollers/messageController.js[2m:76:17)[22m[2m[22m

    [2mconsole.log[22m
      2
[2m[22m
[2m      [2mat log ([22m[2mcontrollers/messageController.js[2m:77:17)[22m[2m[22m

    [2mconsole.log[22m
      number
[2m[22m
[2m      [2mat log ([22m[2mcontrollers/messageController.js[2m:78:17)[22m[2m[22m

    [2mconsole.log[22m
      correct
[2m[22m
[2m      [2mat log ([22m[2mmodels/messageModel.js[2m:129:25)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching messages: Error: Unknown column 'u.account_status' in 'where clause'[39m
[31m          at PromiseConnection.query (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:94:22)[39m
[31m          at query (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:141:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5) {[39m
[31m        code: 'ER_BAD_FIELD_ERROR',[39m
[31m        errno: 1054,[39m
[31m        sql: '\n' +[39m
[31m          '                SELECT a.announcement_content AS message_text,\n' +[39m
[31m          '                    a.announcement_sent_time AS message_sent_time,\n' +[39m
[31m          '                    u.user_name AS message_sender,\n' +[39m
[31m          '                    a.announcement_sender_status AS message_sender_status\n' +[39m
[31m          '                FROM announcements a\n' +[39m
[31m          '                JOIN user u ON a.sender_id = u.id\n' +[39m
[31m          "                WHERE u.account_status = 'active'\n" +[39m
[31m          '                ORDER BY a.announcement_sent_time ASC;\n' +[39m
[31m          '                ',[39m
[31m        sqlState: '42S22',[39m
[31m        sqlMessage: "Unknown column 'u.account_status' in 'where clause'"[39m
[31m      }[39m
[2m[22m
[2m    [0m [90m 143 |[39m             [36mreturn[39m rows[33m;[39m[22m
[2m     [90m 144 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 145 |[39m             console[33m.[39merror([32m'Error fetching messages:'[39m[33m,[39m error)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 146 |[39m             [36mthrow[39m error[33m;[39m[22m
[2m     [90m 147 |[39m         }[22m
[2m     [90m 148 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/messageModel.js[2m:145:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching messages: Error: Unknown column 'u.account_status' in 'where clause'[39m
[31m          at PromiseConnection.query (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:94:22)[39m
[31m          at query (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:141:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5) {[39m
[31m        code: 'ER_BAD_FIELD_ERROR',[39m
[31m        errno: 1054,[39m
[31m        sql: '\n' +[39m
[31m          '                SELECT a.announcement_content AS message_text,\n' +[39m
[31m          '                    a.announcement_sent_time AS message_sent_time,\n' +[39m
[31m          '                    u.user_name AS message_sender,\n' +[39m
[31m          '                    a.announcement_sender_status AS message_sender_status\n' +[39m
[31m          '                FROM announcements a\n' +[39m
[31m          '                JOIN user u ON a.sender_id = u.id\n' +[39m
[31m          "                WHERE u.account_status = 'active'\n" +[39m
[31m          '                ORDER BY a.announcement_sent_time ASC;\n' +[39m
[31m          '                ',[39m
[31m        sqlState: '42S22',[39m
[31m        sqlMessage: "Unknown column 'u.account_status' in 'where clause'"[39m
[31m      }[39m
[2m[22m
[2m    [0m [90m 86 |[39m             res[33m.[39mstatus([35m200[39m)[33m.[39mjson(modifiedMessages)[33m;[39m[22m
[2m     [90m 87 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 88 |[39m             console[33m.[39merror([32m"Error fetching messages:"[39m[33m,[39m error)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 89 |[39m             res[33m.[39mstatus([35m500[39m)[33m.[39mjson({ message[33m:[39m [32m"Error fetching messages"[39m })[33m;[39m[22m
[2m     [90m 90 |[39m         }[22m
[2m     [90m 91 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/messageController.js[2m:88:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mAnnouncement Feature Integration Test › sendAnnouncement › should send an announcement successfully[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 54 |[39m[22m
[2m     [90m 55 |[39m             [90m// Verify the response[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 56 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m    |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 57 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39mobjectContaining({[22m
[2m     [90m 58 |[39m                 message[33m:[39m [32m'Message sent successfully'[39m[33m,[39m[22m
[2m     [90m 59 |[39m                 result[33m:[39m expect[33m.[39many([33mObject[39m)[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:56:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mAnnouncement Feature Integration Test › Negative Test Cases for sendAnnouncement › should fail when message content is missing[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32mObjectContaining {"error": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null", "message": "Error sending message"}[39m
    Received: [31m{"error": "Unknown column 'account_status' in 'where clause'", "message": "Error sending message"}[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 111 |[39m             [90m// Verify the response[39m[22m
[2m     [90m 112 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m500[39m)[33m;[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 113 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39mobjectContaining({[22m
[2m     [90m     |[39m                              [31m[1m^[22m[2m[39m[22m
[2m     [90m 114 |[39m                 message[33m:[39m [32m'Error sending message'[39m[33m,[39m[22m
[2m     [90m 115 |[39m                 error[33m:[39m [32m'Bind parameters must not contain undefined. To pass SQL NULL specify JS null'[39m[22m
[2m     [90m 116 |[39m             }))[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:113:30)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mAnnouncement Feature Integration Test › Negative Test Cases for sendAnnouncement › should fail when the user does not exist[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32mObjectContaining {"error": "User with username 'nonExistentUser' not found.", "message": "Error sending message"}[39m
    Received: [31m{"error": "Unknown column 'account_status' in 'where clause'", "message": "Error sending message"}[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 135 |[39m             [90m// Verify the response[39m[22m
[2m     [90m 136 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m500[39m)[33m;[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 137 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39mobjectContaining({[22m
[2m     [90m     |[39m                              [31m[1m^[22m[2m[39m[22m
[2m     [90m 138 |[39m                 message[33m:[39m [32m'Error sending message'[39m[33m,[39m[22m
[2m     [90m 139 |[39m                 error[33m:[39m [32m"User with username 'nonExistentUser' not found."[39m[22m
[2m     [90m 140 |[39m             }))[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:137:30)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mAnnouncement Feature Integration Test › getAllAnnouncements › should retrieve all announcements[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 165 |[39m[22m
[2m     [90m 166 |[39m             [90m// Verify the response[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 167 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 168 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39many([33mArray[39m))[33m;[39m[22m
[2m     [90m 169 |[39m             [36mconst[39m announcements [33m=[39m res[33m.[39mjson[33m.[39mmock[33m.[39mcalls[[35m0[39m][[35m0[39m][33m;[39m[22m
[2m     [90m 170 |[39m             expect(announcements[33m.[39mlength)[33m.[39mtoBeGreaterThan([35m0[39m)[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:167:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mAnnouncement Feature Integration Test › Negative Test Cases for getAllAnnouncements › should return an empty array when there are no announcements[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 192 |[39m[22m
[2m     [90m 193 |[39m             [90m// Verify the response[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 194 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 195 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith([])[33m;[39m[22m
[2m     [90m 196 |[39m         })[33m;[39m[22m
[2m     [90m 197 |[39m     })[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:194:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m

[0m[7m[1m[31m FAIL [39m[22m[27m[0m [2mtests/integration/[22m[1mwalletControllet.test.js[22m ([0m[1m[41m5.568 s[49m[22m[0m)
  [1m● [22mConsole

    [2mconsole.log[22m
      SSH connection established.
[2m[22m
[2m      [2mat Client.log ([22m[2mconfigurations/mysqlDatabase.js[2m:180:25)[22m[2m[22m

    [2mconsole.log[22m
      Connected to database: sb2-test
[2m[22m
[2m      [2mat log ([22m[2mconfigurations/dbConfig.js[2m:62:17)[22m[2m[22m

    [2mconsole.log[22m
      Connected to database in setDatabaseconnection: sb2
[2m[22m
[2m      [2mat log ([22m[2mconfigurations/dbConfig.js[2m:31:17)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching user balance: Unknown column 'u.account_status' in 'where clause'[39m
[2m[22m
[2m    [0m [90m 22 |[39m             [36mreturn[39m rows[[35m0[39m][33m.[39mbalance[33m;[39m[22m
[2m     [90m 23 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 24 |[39m             console[33m.[39merror([32m"Error fetching user balance:"[39m[33m,[39m error[33m.[39mmessage)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 25 |[39m             [36mthrow[39m error[33m;[39m[22m
[2m     [90m 26 |[39m         }[22m
[2m     [90m 27 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/walletModel.js[2m:24:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/walletModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/walletModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/walletModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/walletModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/walletModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching balance: Unknown column 'u.account_status' in 'where clause'[39m
[2m[22m
[2m    [0m [90m 16 |[39m             res[33m.[39mstatus([35m200[39m)[33m.[39mjson({ balance })[33m;[39m[22m
[2m     [90m 17 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 18 |[39m             console[33m.[39merror([32m"Error fetching balance:"[39m[33m,[39m error[33m.[39mmessage)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 19 |[39m             res[33m.[39mstatus([35m500[39m)[33m.[39mjson({ message[33m:[39m [32m"Error fetching balance"[39m[33m,[39m error[33m:[39m error[33m.[39mmessage })[33m;[39m[22m
[2m     [90m 20 |[39m         }[22m
[2m     [90m 21 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/walletController.js[2m:18:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching user balance: Unknown column 'u.account_status' in 'where clause'[39m
[2m[22m
[2m    [0m [90m 22 |[39m             [36mreturn[39m rows[[35m0[39m][33m.[39mbalance[33m;[39m[22m
[2m     [90m 23 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 24 |[39m             console[33m.[39merror([32m"Error fetching user balance:"[39m[33m,[39m error[33m.[39mmessage)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 25 |[39m             [36mthrow[39m error[33m;[39m[22m
[2m     [90m 26 |[39m         }[22m
[2m     [90m 27 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/walletModel.js[2m:24:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/walletModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/walletModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/walletModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/walletModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/walletModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching balance: Unknown column 'u.account_status' in 'where clause'[39m
[2m[22m
[2m    [0m [90m 16 |[39m             res[33m.[39mstatus([35m200[39m)[33m.[39mjson({ balance })[33m;[39m[22m
[2m     [90m 17 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 18 |[39m             console[33m.[39merror([32m"Error fetching balance:"[39m[33m,[39m error[33m.[39mmessage)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 19 |[39m             res[33m.[39mstatus([35m500[39m)[33m.[39mjson({ message[33m:[39m [32m"Error fetching balance"[39m[33m,[39m error[33m:[39m error[33m.[39mmessage })[33m;[39m[22m
[2m     [90m 20 |[39m         }[22m
[2m     [90m 21 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/walletController.js[2m:18:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching user cards: Unknown column 'u.account_status' in 'where clause'[39m
[2m[22m
[2m    [0m [90m 114 |[39m             [36mreturn[39m rows[33m;[39m[22m
[2m     [90m 115 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 116 |[39m             console[33m.[39merror([32m"Error fetching user cards:"[39m[33m,[39m error[33m.[39mmessage)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 117 |[39m             [36mthrow[39m error[33m;[39m[22m
[2m     [90m 118 |[39m         }[22m
[2m     [90m 119 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/walletModel.js[2m:116:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/walletModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/walletModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/walletModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/walletModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/walletModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching cards: Unknown column 'u.account_status' in 'where clause'[39m
[2m[22m
[2m    [0m [90m 49 |[39m             res[33m.[39mstatus([35m200[39m)[33m.[39mjson(cards)[33m;[39m[22m
[2m     [90m 50 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 51 |[39m             console[33m.[39merror([32m"Error fetching cards:"[39m[33m,[39m error[33m.[39mmessage)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 52 |[39m             res[33m.[39mstatus([35m500[39m)[33m.[39mjson({ message[33m:[39m [32m"Error fetching cards"[39m[33m,[39m error[33m:[39m error[33m.[39mmessage })[33m;[39m[22m
[2m     [90m 53 |[39m         }[22m
[2m     [90m 54 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/walletController.js[2m:51:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching user cards: Unknown column 'u.account_status' in 'where clause'[39m
[2m[22m
[2m    [0m [90m 114 |[39m             [36mreturn[39m rows[33m;[39m[22m
[2m     [90m 115 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 116 |[39m             console[33m.[39merror([32m"Error fetching user cards:"[39m[33m,[39m error[33m.[39mmessage)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 117 |[39m             [36mthrow[39m error[33m;[39m[22m
[2m     [90m 118 |[39m         }[22m
[2m     [90m 119 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/walletModel.js[2m:116:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/walletModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/walletModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/walletModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/walletModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/walletModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching cards: Unknown column 'u.account_status' in 'where clause'[39m
[2m[22m
[2m    [0m [90m 49 |[39m             res[33m.[39mstatus([35m200[39m)[33m.[39mjson(cards)[33m;[39m[22m
[2m     [90m 50 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 51 |[39m             console[33m.[39merror([32m"Error fetching cards:"[39m[33m,[39m error[33m.[39mmessage)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 52 |[39m             res[33m.[39mstatus([35m500[39m)[33m.[39mjson({ message[33m:[39m [32m"Error fetching cards"[39m[33m,[39m error[33m:[39m error[33m.[39mmessage })[33m;[39m[22m
[2m     [90m 53 |[39m         }[22m
[2m     [90m 54 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/walletController.js[2m:51:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching user balance: Unknown column 'u.account_status' in 'where clause'[39m
[2m[22m
[2m    [0m [90m 22 |[39m             [36mreturn[39m rows[[35m0[39m][33m.[39mbalance[33m;[39m[22m
[2m     [90m 23 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 24 |[39m             console[33m.[39merror([32m"Error fetching user balance:"[39m[33m,[39m error[33m.[39mmessage)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 25 |[39m             [36mthrow[39m error[33m;[39m[22m
[2m     [90m 26 |[39m         }[22m
[2m     [90m 27 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/walletModel.js[2m:24:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/walletModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/walletModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/walletModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/walletModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/walletModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error processing donation: Error: Unknown column 'u.account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/walletModel.js:16:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/walletModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/walletModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/walletModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/walletModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/walletModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5) {[39m
[31m        code: 'ER_BAD_FIELD_ERROR',[39m
[31m        errno: 1054,[39m
[31m        sql: '\n' +[39m
[31m          '                SELECT w.balance\n' +[39m
[31m          '                FROM wallet w\n' +[39m
[31m          '                JOIN user u ON w.user_id = u.id\n' +[39m
[31m          '                WHERE u.user_name = ?\n' +[39m
[31m          "                AND u.account_status = 'active';\n" +[39m
[31m          '            ',[39m
[31m        sqlState: '42S22',[39m
[31m        sqlMessage: "Unknown column 'u.account_status' in 'where clause'"[39m
[31m      }[39m
[2m[22m
[2m    [0m [90m 174 |[39m             res[33m.[39mstatus([35m200[39m)[33m.[39mjson({ message[33m:[39m [32m"Donation successful"[39m })[33m;[39m[22m
[2m     [90m 175 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 176 |[39m             console[33m.[39merror([32m"Error processing donation:"[39m[33m,[39m error)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 177 |[39m             res[33m.[39mstatus([35m500[39m)[33m.[39mjson({ message[33m:[39m [32m"Failed to process donation"[39m })[33m;[39m[22m
[2m     [90m 178 |[39m         }[22m
[2m     [90m 179 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/walletController.js[2m:176:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching user balance: Unknown column 'u.account_status' in 'where clause'[39m
[2m[22m
[2m    [0m [90m 22 |[39m             [36mreturn[39m rows[[35m0[39m][33m.[39mbalance[33m;[39m[22m
[2m     [90m 23 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 24 |[39m             console[33m.[39merror([32m"Error fetching user balance:"[39m[33m,[39m error[33m.[39mmessage)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 25 |[39m             [36mthrow[39m error[33m;[39m[22m
[2m     [90m 26 |[39m         }[22m
[2m     [90m 27 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/walletModel.js[2m:24:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/walletModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/walletModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/walletModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/walletModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/walletModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error processing donation: Error: Unknown column 'u.account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/walletModel.js:16:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/walletModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/walletModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/walletModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/walletModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/walletModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5) {[39m
[31m        code: 'ER_BAD_FIELD_ERROR',[39m
[31m        errno: 1054,[39m
[31m        sql: '\n' +[39m
[31m          '                SELECT w.balance\n' +[39m
[31m          '                FROM wallet w\n' +[39m
[31m          '                JOIN user u ON w.user_id = u.id\n' +[39m
[31m          '                WHERE u.user_name = ?\n' +[39m
[31m          "                AND u.account_status = 'active';\n" +[39m
[31m          '            ',[39m
[31m        sqlState: '42S22',[39m
[31m        sqlMessage: "Unknown column 'u.account_status' in 'where clause'"[39m
[31m      }[39m
[2m[22m
[2m    [0m [90m 174 |[39m             res[33m.[39mstatus([35m200[39m)[33m.[39mjson({ message[33m:[39m [32m"Donation successful"[39m })[33m;[39m[22m
[2m     [90m 175 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 176 |[39m             console[33m.[39merror([32m"Error processing donation:"[39m[33m,[39m error)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 177 |[39m             res[33m.[39mstatus([35m500[39m)[33m.[39mjson({ message[33m:[39m [32m"Failed to process donation"[39m })[33m;[39m[22m
[2m     [90m 178 |[39m         }[22m
[2m     [90m 179 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/walletController.js[2m:176:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mWalletController Integration Test › getBalance › should return the correct balance for a user[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 48 |[39m             [36mawait[39m [33mWalletController[39m[33m.[39mgetBalance(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 49 |[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 50 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m    |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 51 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith({ balance[33m:[39m [32m"500.00"[39m })[33m;[39m[22m
[2m     [90m 52 |[39m         })[33m;[39m[22m
[2m     [90m 53 |[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:50:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mWalletController Integration Test › getBalance › should return 404 if wallet not found[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m404[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 61 |[39m             [36mawait[39m [33mWalletController[39m[33m.[39mgetBalance(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 62 |[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 63 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m404[39m)[33m;[39m[22m
[2m     [90m    |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 64 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith({ message[33m:[39m [32m'Wallet not found'[39m })[33m;[39m[22m
[2m     [90m 65 |[39m         })[33m;[39m[22m
[2m     [90m 66 |[39m     })[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:63:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mWalletController Integration Test › getCards › should return all cards for a user[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 76 |[39m             [36mawait[39m [33mWalletController[39m[33m.[39mgetCards(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 77 |[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 78 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m    |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 79 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39many([33mArray[39m))[33m;[39m[22m
[2m     [90m 80 |[39m         })[33m;[39m[22m
[2m     [90m 81 |[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:78:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mWalletController Integration Test › getCards › should return an empty array if user has no cards[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 89 |[39m             [36mawait[39m [33mWalletController[39m[33m.[39mgetCards(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 90 |[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 91 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m    |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 92 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith([])[33m;[39m[22m
[2m     [90m 93 |[39m         })[33m;[39m[22m
[2m     [90m 94 |[39m     })[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:91:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mWalletController Integration Test › processDonation › should process a donation successfully[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 110 |[39m             [36mawait[39m [33mWalletController[39m[33m.[39mprocessDonation(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 111 |[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 112 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 113 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith({ message[33m:[39m [32m'Donation successful'[39m })[33m;[39m[22m
[2m     [90m 114 |[39m[22m
[2m     [90m 115 |[39m             [36mconst[39m [rows] [33m=[39m [36mawait[39m dbConnection[33m.[39mquery([32m`[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:112:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mWalletController Integration Test › processDonation › should fail if sender has insufficient balance[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m400[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 134 |[39m             [36mawait[39m [33mWalletController[39m[33m.[39mprocessDonation(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 135 |[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 136 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m400[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 137 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith({ message[33m:[39m [32m'Insufficient balance'[39m })[33m;[39m[22m
[2m     [90m 138 |[39m         })[33m;[39m[22m
[2m     [90m 139 |[39m     })[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:136:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m

[0m[7m[1m[31m FAIL [39m[22m[27m[0m [2mtests/unit/[22m[1mincidentPostModel.test.js[22m
  [1m● [22mConsole

    [2m[31mconsole.error[39m[22m
[31m      Error inserting incident post: Invalid attempt to destructure non-iterable instance.[39m
[31m      In order to be iterable, non-array objects must have a [Symbol.iterator]() method.[39m
[2m[22m
[2m    [0m [90m 62 |[39m             }[33m;[39m[22m
[2m     [90m 63 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 64 |[39m             console[33m.[39merror([32m'Error inserting incident post:'[39m[33m,[39m err[33m.[39mmessage)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 65 |[39m             [36mthrow[39m [36mnew[39m [33mError[39m([32m'Failed to create incident post. Please try again later.'[39m)[33m;[39m[22m
[2m     [90m 66 |[39m         }              [22m
[2m     [90m 67 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/incidentPostModel.js[2m:64:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error inserting incident post: Database error[39m
[2m[22m
[2m    [0m [90m 62 |[39m             }[33m;[39m[22m
[2m     [90m 63 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 64 |[39m             console[33m.[39merror([32m'Error inserting incident post:'[39m[33m,[39m err[33m.[39mmessage)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 65 |[39m             [36mthrow[39m [36mnew[39m [33mError[39m([32m'Failed to create incident post. Please try again later.'[39m)[33m;[39m[22m
[2m     [90m 66 |[39m         }              [22m
[2m     [90m 67 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/incidentPostModel.js[2m:64:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error inserting image: Invalid attempt to destructure non-iterable instance.[39m
[31m      In order to be iterable, non-array objects must have a [Symbol.iterator]() method.[39m
[2m[22m
[2m    [0m [90m 103 |[39m             [36mreturn[39m result[33m;[39m[22m
[2m     [90m 104 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 105 |[39m             console[33m.[39merror([32m"Error inserting image:"[39m[33m,[39m err[33m.[39mmessage)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 106 |[39m             [36mthrow[39m err[33m;[39m[22m
[2m     [90m 107 |[39m         }[22m
[2m     [90m 108 |[39m         [0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/incidentPostModel.js[2m:105:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error inserting image: Database error[39m
[2m[22m
[2m    [0m [90m 103 |[39m             [36mreturn[39m result[33m;[39m[22m
[2m     [90m 104 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 105 |[39m             console[33m.[39merror([32m"Error inserting image:"[39m[33m,[39m err[33m.[39mmessage)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 106 |[39m             [36mthrow[39m err[33m;[39m[22m
[2m     [90m 107 |[39m         }[22m
[2m     [90m 108 |[39m         [0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/incidentPostModel.js[2m:105:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error: Database error[39m
[31m          at _callee6$ (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/incidentPostModel.test.js:122:44)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/incidentPostModel.test.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/incidentPostModel.test.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/incidentPostModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/incidentPostModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/incidentPostModel.test.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/incidentPostModel.test.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at Object.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/incidentPostModel.test.js:2:1)[39m
[31m          at Promise.then.completed (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:298:28)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at callAsyncCircusFn (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:231:10)[39m
[31m          at _callCircusTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:316:40)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m          at _runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:252:3)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:126:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at run (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:71:3)[39m
[31m          at runAndTransformResultsToJestFormat (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)[39m
[31m          at jestAdapter (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)[39m
[31m          at runTestInternal (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:367:16)[39m
[31m          at runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:444:34)[39m
[31m          at Object.worker (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/testWorker.js:106:12)[39m
[2m[22m
[2m    [0m [90m 118 |[39m             [36mreturn[39m result[33m;[39m[22m
[2m     [90m 119 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 120 |[39m             console[33m.[39merror(err)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 121 |[39m         }[22m
[2m     [90m 122 |[39m     }[22m
[2m     [90m 123 |[39m[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/incidentPostModel.js[2m:120:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error updating incident post: Error: No rows updated. Incident not found.[39m
[31m          at _callee4$ (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:136:23)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[2m[22m
[2m    [0m [90m 152 |[39m             [36mreturn[39m updatedRow[[35m0[39m][33m;[39m [90m// Assuming only one row is returned[39m[22m
[2m     [90m 153 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 154 |[39m             console[33m.[39merror([32m"Error updating incident post:"[39m[33m,[39m err)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 155 |[39m             [36mthrow[39m err[33m;[39m [90m// Rethrow the error to the caller[39m[22m
[2m     [90m 156 |[39m         }[22m
[2m     [90m 157 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/incidentPostModel.js[2m:154:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error updating incident post: Error: Database error[39m
[31m          at _callee9$ (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/incidentPostModel.test.js:175:23)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/incidentPostModel.test.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/incidentPostModel.test.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/incidentPostModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/incidentPostModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/incidentPostModel.test.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/incidentPostModel.test.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at Object.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/incidentPostModel.test.js:2:1)[39m
[31m          at Promise.then.completed (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:298:28)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at callAsyncCircusFn (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:231:10)[39m
[31m          at _callCircusTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:316:40)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m          at _runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:252:3)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:126:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at run (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:71:3)[39m
[31m          at runAndTransformResultsToJestFormat (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)[39m
[31m          at jestAdapter (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)[39m
[31m          at runTestInternal (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:367:16)[39m
[31m          at runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:444:34)[39m
[31m          at Object.worker (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/testWorker.js:106:12)[39m
[2m[22m
[2m    [0m [90m 152 |[39m             [36mreturn[39m updatedRow[[35m0[39m][33m;[39m [90m// Assuming only one row is returned[39m[22m
[2m     [90m 153 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 154 |[39m             console[33m.[39merror([32m"Error updating incident post:"[39m[33m,[39m err)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 155 |[39m             [36mthrow[39m err[33m;[39m [90m// Rethrow the error to the caller[39m[22m
[2m     [90m 156 |[39m         }[22m
[2m     [90m 157 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/incidentPostModel.js[2m:154:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m

    [2mconsole.log[22m
      Successfully deleted incident post with ID: 1
[2m[22m
[2m      [2mat log ([22m[2mmodels/incidentPostModel.js[2m:176:25)[22m[2m[22m

    [2m[33mconsole.warn[39m[22m
[33m      No incident post found with ID: 999[39m
[2m[22m
[2m    [0m [90m 181 |[39m                 }[33m;[39m[22m
[2m     [90m 182 |[39m             } [36melse[39m {[22m
[2m    [31m[1m>[22m[2m[39m[90m 183 |[39m                 console[33m.[39mwarn([32m`No incident post found with ID: ${id}`[39m)[33m;[39m[22m
[2m     [90m     |[39m                         [31m[1m^[22m[2m[39m[22m
[2m     [90m 184 |[39m                 [36mreturn[39m {[22m
[2m     [90m 185 |[39m                     success[33m:[39m [36mfalse[39m[33m,[39m[22m
[2m     [90m 186 |[39m                     message[33m:[39m [32m`No incident post found with ID ${id}.`[39m[33m,[39m[0m[22m
[2m[22m
[2m      [2mat warn ([22m[2mmodels/incidentPostModel.js[2m:183:25)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error deleting incident post: Error: Incident post ID is required for deletion.[39m
[31m          at _callee5$ (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:163:23)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at Function.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at Function.apply [as deleteIncidentPost] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:159:36)[39m
[31m          at deleteIncidentPost (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/incidentPostModel.test.js:221:46)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/incidentPostModel.test.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/incidentPostModel.test.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/incidentPostModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/incidentPostModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/incidentPostModel.test.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/incidentPostModel.test.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at Object.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/incidentPostModel.test.js:2:1)[39m
[31m          at Promise.then.completed (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:298:28)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at callAsyncCircusFn (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:231:10)[39m
[31m          at _callCircusTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:316:40)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m          at _runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:252:3)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:126:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at run (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:71:3)[39m
[31m          at runAndTransformResultsToJestFormat (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)[39m
[31m          at jestAdapter (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)[39m
[31m          at runTestInternal (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:367:16)[39m
[31m          at runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:444:34)[39m
[31m          at Object.worker (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/testWorker.js:106:12)[39m
[2m[22m
[2m    [0m [90m 190 |[39m         } [36mcatch[39m (err) {[22m
[2m     [90m 191 |[39m             [90m// Improved error handling[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 192 |[39m             console[33m.[39merror([32m"Error deleting incident post:"[39m[33m,[39m err)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 193 |[39m             [36mreturn[39m {[22m
[2m     [90m 194 |[39m                 success[33m:[39m [36mfalse[39m[33m,[39m[22m
[2m     [90m 195 |[39m                 message[33m:[39m err[33m.[39mmessage[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/incidentPostModel.js[2m:192:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat _next ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Function.<anonymous> ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Function.apply [as deleteIncidentPost] ([22m[2mmodels/incidentPostModel.js[2m:159:36)[22m[2m[22m
[2m      [2mat deleteIncidentPost ([22m[2m[0m[36mtests/unit/incidentPostModel.test.js[39m[0m[2m:221:46)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/unit/incidentPostModel.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/unit/incidentPostModel.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/unit/incidentPostModel.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/unit/incidentPostModel.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/unit/incidentPostModel.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat _next ([22m[2m[0m[36mtests/unit/incidentPostModel.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Object.<anonymous> ([22m[2m[0m[36mtests/unit/incidentPostModel.test.js[39m[0m[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching incident posts with images: Error: Database error[39m
[31m          at _callee14$ (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/incidentPostModel.test.js:279:42)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/incidentPostModel.test.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/incidentPostModel.test.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/incidentPostModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/incidentPostModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/incidentPostModel.test.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/incidentPostModel.test.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at Object.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/incidentPostModel.test.js:2:1)[39m
[31m          at Promise.then.completed (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:298:28)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at callAsyncCircusFn (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:231:10)[39m
[31m          at _callCircusTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:316:40)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m          at _runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:252:3)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:126:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at run (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:71:3)[39m
[31m          at runAndTransformResultsToJestFormat (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)[39m
[31m          at jestAdapter (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)[39m
[31m          at runTestInternal (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:367:16)[39m
[31m          at runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:444:34)[39m
[31m          at Object.worker (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/testWorker.js:106:12)[39m
[2m[22m
[2m    [0m [90m 253 |[39m             [36mreturn[39m [33mArray[39m[33m.[39m[36mfrom[39m(postMap[33m.[39mvalues())[33m;[39m[22m
[2m     [90m 254 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 255 |[39m             console[33m.[39merror([32m"Error fetching incident posts with images:"[39m[33m,[39m err)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 256 |[39m             [36mthrow[39m [36mnew[39m [33mError[39m([32m"Failed to retrieve incident posts"[39m)[33m;[39m[22m
[2m     [90m 257 |[39m         }[22m
[2m     [90m 258 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/incidentPostModel.js[2m:255:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching incident post by ID: Error: Database error[39m
[31m          at _callee17$ (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/incidentPostModel.test.js:315:42)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/incidentPostModel.test.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/incidentPostModel.test.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/incidentPostModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/incidentPostModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/incidentPostModel.test.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/incidentPostModel.test.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at Object.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/incidentPostModel.test.js:2:1)[39m
[31m          at Promise.then.completed (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:298:28)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at callAsyncCircusFn (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:231:10)[39m
[31m          at _callCircusTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:316:40)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m          at _runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:252:3)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:126:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at run (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:71:3)[39m
[31m          at runAndTransformResultsToJestFormat (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)[39m
[31m          at jestAdapter (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)[39m
[31m          at runTestInternal (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:367:16)[39m
[31m          at runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:444:34)[39m
[31m          at Object.worker (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/testWorker.js:106:12)[39m
[2m[22m
[2m    [0m [90m 288 |[39m             [36mreturn[39m post[33m;[39m[22m
[2m     [90m 289 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 290 |[39m             console[33m.[39merror([32m"Error fetching incident post by ID:"[39m[33m,[39m err)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 291 |[39m             [36mthrow[39m [36mnew[39m [33mError[39m([32m"Failed to retrieve the incident post"[39m)[33m;[39m[22m
[2m     [90m 292 |[39m         }[22m
[2m     [90m 293 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/incidentPostModel.js[2m:290:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mIncidentPostModel Unit Tests › createIncidentPost › should create a new incident post and return the created post[39m[22m

    Failed to create incident post. Please try again later.
[2m[22m
[2m    [0m [90m 63 |[39m         } [36mcatch[39m (err) {[22m
[2m     [90m 64 |[39m             console[33m.[39merror([32m'Error inserting incident post:'[39m[33m,[39m err[33m.[39mmessage)[33m;[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 65 |[39m             [36mthrow[39m [36mnew[39m [33mError[39m([32m'Failed to create incident post. Please try again later.'[39m)[33m;[39m[22m
[2m     [90m    |[39m                   [31m[1m^[22m[2m[39m[22m
[2m     [90m 66 |[39m         }              [22m
[2m     [90m 67 |[39m     }[22m
[2m     [90m 68 |[39m     [0m[22m
[2m[22m
[2m      [2mat _callee$ ([22m[2mmodels/incidentPostModel.js[2m:65:19)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mIncidentPostModel Unit Tests › insertImage › should insert an image successfully[39m[22m

    TypeError: Invalid attempt to destructure non-iterable instance.
    In order to be iterable, non-array objects must have a [Symbol.iterator]() method.
[2m[22m
[2m    [0m [90m 1 |[39m [36mimport[39m { json } [36mfrom[39m [32m'express'[39m[33m;[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 2 |[39m [36mimport[39m { getDatabaseConnection } [36mfrom[39m [32m'../configurations/dbConfig.js'[39m[33m;[39m[22m
[2m     [90m   |[39m [31m[1m^[22m[2m[39m[22m
[2m     [90m 3 |[39m[22m
[2m     [90m 4 |[39m [36mclass[39m [33mIncidentPostModel[39m {[22m
[2m     [90m 5 |[39m     [36mstatic[39m [36masync[39m createIncidentPost(title[33m,[39m details[33m,[39m resource_details[33m,[39m sender_name[33m,[39m sender_status) {[0m[22m
[2m[22m
[2m      [2mat _nonIterableRest ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat _nonIterableRest ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat _slicedToArray ([22m[2mmodels/incidentPostModel.js[2m:81:72)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mIncidentPostModel Unit Tests › insertImage › should handle database errors gracefully[39m[22m

    Database error
[2m[22m
[2m    [0m [90m 93 |[39m[22m
[2m     [90m 94 |[39m     it([32m"should handle database errors gracefully"[39m[33m,[39m [36masync[39m () [33m=>[39m {[22m
[2m    [31m[1m>[22m[2m[39m[90m 95 |[39m       mockDb[33m.[39mexecute[33m.[39mmockRejectedValueOnce([36mnew[39m [33mError[39m([32m"Database error"[39m))[33m;[39m[22m
[2m     [90m    |[39m                                            [31m[1m^[22m[2m[39m[22m
[2m     [90m 96 |[39m       [36mconst[39m result [33m=[39m [36mawait[39m [33mIncidentPostModel[39m[33m.[39minsertImage([22m
[2m     [90m 97 |[39m         [32m"testuser"[39m[33m,[39m[22m
[2m     [90m 98 |[39m         [35m1[39m[33m,[39m[0m[22m
[2m[22m
[2m      [2mat _callee4$ ([22m[2m[0m[36mtests/unit/incidentPostModel.test.js[39m[0m[2m:95:44)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/unit/incidentPostModel.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/unit/incidentPostModel.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/unit/incidentPostModel.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/unit/incidentPostModel.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/unit/incidentPostModel.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat _next ([22m[2m[0m[36mtests/unit/incidentPostModel.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Object.<anonymous> ([22m[2m[0m[36mtests/unit/incidentPostModel.test.js[39m[0m[2m:2:1)[22m[2m[22m

[0m[7m[1m[31m FAIL [39m[22m[27m[0m [2mtests/unit/[22m[1mincidentPostMessageModel.test.js[22m
  [1m● [22mConsole

    [2m[31mconsole.error[39m[22m
[31m      Error creating incident message: Invalid attempt to destructure non-iterable instance.[39m
[31m      In order to be iterable, non-array objects must have a [Symbol.iterator]() method.[39m
[2m[22m
[2m    [0m [90m 58 |[39m             [36mreturn[39m rows[[35m0[39m][33m;[39m[22m
[2m     [90m 59 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 60 |[39m             console[33m.[39merror([32m"Error creating incident message:"[39m[33m,[39m err[33m.[39mmessage)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 61 |[39m             [36mthrow[39m [36mnew[39m [33mError[39m([32m"An error occurred while creating the incident message"[39m)[33m;[39m[22m
[2m     [90m 62 |[39m         }        [22m
[2m     [90m 63 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/incidentPostMessageModel.js[2m:60:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/incidentPostMessageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/incidentPostMessageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mmodels/incidentPostMessageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostMessageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostMessageModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error creating incident message: Database error[39m
[2m[22m
[2m    [0m [90m 58 |[39m             [36mreturn[39m rows[[35m0[39m][33m;[39m[22m
[2m     [90m 59 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 60 |[39m             console[33m.[39merror([32m"Error creating incident message:"[39m[33m,[39m err[33m.[39mmessage)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 61 |[39m             [36mthrow[39m [36mnew[39m [33mError[39m([32m"An error occurred while creating the incident message"[39m)[33m;[39m[22m
[2m     [90m 62 |[39m         }        [22m
[2m     [90m 63 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/incidentPostMessageModel.js[2m:60:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/incidentPostMessageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/incidentPostMessageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/incidentPostMessageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostMessageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostMessageModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching incident post messages: Error: Database error[39m
[31m          at _callee4$ (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/incidentPostMessageModel.test.js:103:40)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/incidentPostMessageModel.test.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/incidentPostMessageModel.test.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/incidentPostMessageModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/incidentPostMessageModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/incidentPostMessageModel.test.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/incidentPostMessageModel.test.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at Object.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/incidentPostMessageModel.test.js:2:1)[39m
[31m          at Promise.then.completed (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:298:28)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at callAsyncCircusFn (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:231:10)[39m
[31m          at _callCircusTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:316:40)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m          at _runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:252:3)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:126:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at run (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:71:3)[39m
[31m          at runAndTransformResultsToJestFormat (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)[39m
[31m          at jestAdapter (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)[39m
[31m          at runTestInternal (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:367:16)[39m
[31m          at runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:444:34)[39m
[31m          at Object.worker (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/testWorker.js:106:12)[39m
[2m[22m
[2m    [0m [90m 87 |[39m                 [36mthrow[39m err[33m;[39m[22m
[2m     [90m 88 |[39m             }[22m
[2m    [31m[1m>[22m[2m[39m[90m 89 |[39m             console[33m.[39merror([32m"Error fetching incident post messages:"[39m[33m,[39m err)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 90 |[39m             [36mthrow[39m [36mnew[39m [33mError[39m([32m"An error occurred while fetching incident messages"[39m)[33m;[39m[22m
[2m     [90m 91 |[39m         }[22m
[2m     [90m 92 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/incidentPostMessageModel.js[2m:89:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/incidentPostMessageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/incidentPostMessageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/incidentPostMessageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostMessageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostMessageModel.js[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mIncidentPostMessageModel Unit Tests › createIncidentPostMessageByincidentID › should create a new incident message and return the inserted record[39m[22m

    An error occurred while creating the incident message
[2m[22m
[2m    [0m [90m 59 |[39m         } [36mcatch[39m (err) {[22m
[2m     [90m 60 |[39m             console[33m.[39merror([32m"Error creating incident message:"[39m[33m,[39m err[33m.[39mmessage)[33m;[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 61 |[39m             [36mthrow[39m [36mnew[39m [33mError[39m([32m"An error occurred while creating the incident message"[39m)[33m;[39m[22m
[2m     [90m    |[39m                   [31m[1m^[22m[2m[39m[22m
[2m     [90m 62 |[39m         }        [22m
[2m     [90m 63 |[39m     }[22m
[2m     [90m 64 |[39m[0m[22m
[2m[22m
[2m      [2mat _callee$ ([22m[2mmodels/incidentPostMessageModel.js[2m:61:19)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/incidentPostMessageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/incidentPostMessageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mmodels/incidentPostMessageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostMessageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostMessageModel.js[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mIncidentPostMessageModel Unit Tests › createIncidentPostMessageByincidentID › should throw an error if the INSERT query fails[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledTimes[2m([22m[32mexpected[39m[2m)[22m

    Expected number of calls: [32m1[39m
    Received number of calls: [31m2[39m
[2m[22m
[2m    [0m [90m 61 |[39m       )[33m.[39mrejects[33m.[39mtoThrow([32m"An error occurred while creating the incident message"[39m)[33m;[39m[22m
[2m     [90m 62 |[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 63 |[39m       expect(mockDb[33m.[39mexecute)[33m.[39mtoHaveBeenCalledTimes([35m1[39m)[33m;[39m[22m
[2m     [90m    |[39m                              [31m[1m^[22m[2m[39m[22m
[2m     [90m 64 |[39m     })[33m;[39m[22m
[2m     [90m 65 |[39m   })[33m;[39m[22m
[2m     [90m 66 |[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledTimes ([22m[2m[0m[36mtests/unit/incidentPostMessageModel.test.js[39m[0m[2m:63:30)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/unit/incidentPostMessageModel.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/unit/incidentPostMessageModel.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/unit/incidentPostMessageModel.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/unit/incidentPostMessageModel.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/unit/incidentPostMessageModel.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mIncidentPostMessageModel Unit Tests › getIncidentPostMessagesByincidentID › should fetch all messages for a given incident post ID[39m[22m

    [2mexpect([22m[31mreceived[39m[2m).[22mtoEqual[2m([22m[32mexpected[39m[2m) // deep equality[22m

    [32m- Expected  -  3[39m
    [31m+ Received  + 12[39m

    [2m  Array [[22m
    [32m-   "SELECT id, text, sent_time, sender_name, sender_status, incidentPost_id[39m
    [32m-                  FROM incidentMessage[39m
    [32m-                  WHERE incidentPost_id = ?;",[39m
    [31m+   "[39m
    [31m+                     SELECT im.id,[39m
    [31m+                         im.text,[39m
    [31m+                         im.sent_time,[39m
    [31m+                         u.user_name AS sender_name,[39m
    [31m+                         u.status AS sender_status,[39m
    [31m+                         im.incidentPost_id[39m
    [31m+                     FROM incidentMessage im[39m
    [31m+                     JOIN user u ON im.sender_id = u.id[39m
    [31m+                     WHERE im.incidentPost_id = ?[39m
    [31m+                     AND u.account_status = 'active';[39m
    [31m+                  ",[39m
    [2m    Array [[22m
    [2m      1,[22m
    [2m    ],[22m
    [2m  ][22m
[2m[22m
[2m    [0m [90m 91 |[39m[22m
[2m     [90m 92 |[39m       expect(mockDb[33m.[39mexecute)[33m.[39mtoHaveBeenCalledTimes([35m1[39m)[33m;[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 93 |[39m       expect(mockDb[33m.[39mexecute[33m.[39mmock[33m.[39mcalls[[35m0[39m])[33m.[39mtoEqual([[22m
[2m     [90m    |[39m                                            [31m[1m^[22m[2m[39m[22m
[2m     [90m 94 |[39m         [32m`SELECT id, text, sent_time, sender_name, sender_status, incidentPost_id[39m[22m
[2m     [90m 95 |[39m [32m                 FROM incidentMessage[39m[22m
[2m     [90m 96 |[39m [32m                 WHERE incidentPost_id = ?;`[39m[33m,[39m[0m[22m
[2m[22m
[2m      [2mat toEqual ([22m[2m[0m[36mtests/unit/incidentPostMessageModel.test.js[39m[0m[2m:93:44)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/unit/incidentPostMessageModel.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/unit/incidentPostMessageModel.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/unit/incidentPostMessageModel.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/unit/incidentPostMessageModel.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/unit/incidentPostMessageModel.test.js[39m[0m[2m:2:1)[22m[2m[22m

[0m[7m[1m[31m FAIL [39m[22m[27m[0m [2mtests/unit/[22m[1mmessageModel.test.js[22m
  [1m● [22mConsole

    [2m[31mconsole.error[39m[22m
[31m      Error inserting message: Invalid attempt to destructure non-iterable instance.[39m
[31m      In order to be iterable, non-array objects must have a [Symbol.iterator]() method.[39m
[2m[22m
[2m    [0m [90m 40 |[39m             [36mreturn[39m result[33m;[39m[22m
[2m     [90m 41 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 42 |[39m             console[33m.[39merror([32m"Error inserting message:"[39m[33m,[39m error[33m.[39mmessage)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 43 |[39m             [36mthrow[39m error[33m;[39m[22m
[2m     [90m 44 |[39m         }        [22m
[2m     [90m 45 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/messageModel.js[2m:42:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error inserting message: Database Error[39m
[2m[22m
[2m    [0m [90m 40 |[39m             [36mreturn[39m result[33m;[39m[22m
[2m     [90m 41 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 42 |[39m             console[33m.[39merror([32m"Error inserting message:"[39m[33m,[39m error[33m.[39mmessage)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 43 |[39m             [36mthrow[39m error[33m;[39m[22m
[2m     [90m 44 |[39m         }        [22m
[2m     [90m 45 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/messageModel.js[2m:42:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching messages: Error: Database Error[39m
[31m          at _callee4$ (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/messageModel.test.js:52:52)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/messageModel.test.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/messageModel.test.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/messageModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/messageModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/messageModel.test.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/messageModel.test.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at Object.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/messageModel.test.js:2:1)[39m
[31m          at Promise.then.completed (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:298:28)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at callAsyncCircusFn (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:231:10)[39m
[31m          at _callCircusTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:316:40)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m          at _runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:252:3)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:126:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at run (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:71:3)[39m
[31m          at runAndTransformResultsToJestFormat (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)[39m
[31m          at jestAdapter (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)[39m
[31m          at runTestInternal (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:367:16)[39m
[31m          at runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:444:34)[39m
[31m          at Object.worker (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/testWorker.js:106:12)[39m
[2m[22m
[2m    [0m [90m 143 |[39m             [36mreturn[39m rows[33m;[39m[22m
[2m     [90m 144 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 145 |[39m             console[33m.[39merror([32m'Error fetching messages:'[39m[33m,[39m error)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 146 |[39m             [36mthrow[39m error[33m;[39m[22m
[2m     [90m 147 |[39m         }[22m
[2m     [90m 148 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/messageModel.js[2m:145:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error inserting private message: TypeError: Invalid attempt to destructure non-iterable instance.[39m
[31m      In order to be iterable, non-array objects must have a [Symbol.iterator]() method.[39m
[31m          at _nonIterableRest (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at _nonIterableRest (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at _slicedToArray (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:202:85)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[2m[22m
[2m    [0m [90m 230 |[39m             [36mreturn[39m result[33m;[39m[22m
[2m     [90m 231 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 232 |[39m             console[33m.[39merror([32m'Error inserting private message:'[39m[33m,[39m error)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 233 |[39m             [36mthrow[39m error[33m;[39m[22m
[2m     [90m 234 |[39m         }[22m
[2m     [90m 235 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/messageModel.js[2m:232:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error inserting private message: Error: Database Error[39m
[31m          at _callee6$ (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/messageModel.test.js:76:54)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/messageModel.test.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/messageModel.test.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/messageModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/messageModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/messageModel.test.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/messageModel.test.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at Object.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/messageModel.test.js:2:1)[39m
[31m          at Promise.then.completed (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:298:28)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at callAsyncCircusFn (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:231:10)[39m
[31m          at _callCircusTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:316:40)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m          at _runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:252:3)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:126:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at run (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:71:3)[39m
[31m          at runAndTransformResultsToJestFormat (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)[39m
[31m          at jestAdapter (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)[39m
[31m          at runTestInternal (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:367:16)[39m
[31m          at runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:444:34)[39m
[31m          at Object.worker (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/testWorker.js:106:12)[39m
[2m[22m
[2m    [0m [90m 230 |[39m             [36mreturn[39m result[33m;[39m[22m
[2m     [90m 231 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 232 |[39m             console[33m.[39merror([32m'Error inserting private message:'[39m[33m,[39m error)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 233 |[39m             [36mthrow[39m error[33m;[39m[22m
[2m     [90m 234 |[39m         }[22m
[2m     [90m 235 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/messageModel.js[2m:232:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching private messages: Error: Database Error[39m
[31m          at _callee8$ (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/messageModel.test.js:96:54)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/messageModel.test.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/messageModel.test.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/messageModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/messageModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/messageModel.test.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/messageModel.test.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at Object.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/messageModel.test.js:2:1)[39m
[31m          at Promise.then.completed (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:298:28)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at callAsyncCircusFn (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:231:10)[39m
[31m          at _callCircusTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:316:40)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m          at _runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:252:3)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:126:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at run (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:71:3)[39m
[31m          at runAndTransformResultsToJestFormat (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)[39m
[31m          at jestAdapter (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)[39m
[31m          at runTestInternal (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:367:16)[39m
[31m          at runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:444:34)[39m
[31m          at Object.worker (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/testWorker.js:106:12)[39m
[2m[22m
[2m    [0m [90m 308 |[39m             [36mreturn[39m rows[33m;[39m[22m
[2m     [90m 309 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 310 |[39m             console[33m.[39merror([32m'Error fetching private messages:'[39m[33m,[39m error)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 311 |[39m             [36mthrow[39m error[33m;[39m[22m
[2m     [90m 312 |[39m         }[22m
[2m     [90m 313 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/messageModel.js[2m:310:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching unread messages: Error: Database Error[39m
[31m          at _callee10$ (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/messageModel.test.js:116:54)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/messageModel.test.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/messageModel.test.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/messageModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/messageModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/messageModel.test.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/messageModel.test.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at Object.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/messageModel.test.js:2:1)[39m
[31m          at Promise.then.completed (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:298:28)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at callAsyncCircusFn (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:231:10)[39m
[31m          at _callCircusTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:316:40)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m          at _runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:252:3)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:126:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at run (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:71:3)[39m
[31m          at runAndTransformResultsToJestFormat (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)[39m
[31m          at jestAdapter (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)[39m
[31m          at runTestInternal (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:367:16)[39m
[31m          at runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:444:34)[39m
[31m          at Object.worker (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/testWorker.js:106:12)[39m
[2m[22m
[2m    [0m [90m 333 |[39m             [36mreturn[39m rows[33m.[39mmap(row [33m=>[39m row[33m.[39mmessage_sender)[33m;[39m[22m
[2m     [90m 334 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 335 |[39m             console[33m.[39merror([32m'Error fetching unread messages:'[39m[33m,[39m error)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 336 |[39m             [36mthrow[39m error[33m;[39m[22m
[2m     [90m 337 |[39m         }[22m
[2m     [90m 338 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/messageModel.js[2m:335:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching unread messages: Error: Database Error[39m
[31m          at _callee12$ (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/messageModel.test.js:134:54)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/messageModel.test.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/messageModel.test.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/messageModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/messageModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/messageModel.test.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/messageModel.test.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at Object.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/messageModel.test.js:2:1)[39m
[31m          at Promise.then.completed (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:298:28)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at callAsyncCircusFn (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:231:10)[39m
[31m          at _callCircusTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:316:40)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m          at _runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:252:3)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:126:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at run (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:71:3)[39m
[31m          at runAndTransformResultsToJestFormat (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)[39m
[31m          at jestAdapter (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)[39m
[31m          at runTestInternal (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:367:16)[39m
[31m          at runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:444:34)[39m
[31m          at Object.worker (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/testWorker.js:106:12)[39m
[2m[22m
[2m    [0m [90m 359 |[39m             [36mreturn[39m rows[33m;[39m[22m
[2m     [90m 360 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 361 |[39m             console[33m.[39merror([32m'Error fetching unread messages:'[39m[33m,[39m error)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 362 |[39m             [36mthrow[39m error[33m;[39m[22m
[2m     [90m 363 |[39m         }[22m
[2m     [90m 364 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/messageModel.js[2m:361:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error updating messages to read: Error: Database Error[39m
[31m          at _callee14$ (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/messageModel.test.js:154:54)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/messageModel.test.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/messageModel.test.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/messageModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/messageModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/messageModel.test.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/messageModel.test.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at Object.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/messageModel.test.js:2:1)[39m
[31m          at Promise.then.completed (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:298:28)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at callAsyncCircusFn (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:231:10)[39m
[31m          at _callCircusTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:316:40)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m          at _runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:252:3)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:126:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at run (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:71:3)[39m
[31m          at runAndTransformResultsToJestFormat (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)[39m
[31m          at jestAdapter (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)[39m
[31m          at runTestInternal (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:367:16)[39m
[31m          at runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:444:34)[39m
[31m          at Object.worker (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/testWorker.js:106:12)[39m
[2m[22m
[2m    [0m [90m 376 |[39m             [36mreturn[39m result[33m;[39m[22m
[2m     [90m 377 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 378 |[39m             console[33m.[39merror([32m'Error updating messages to read:'[39m[33m,[39m error)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 379 |[39m             [36mthrow[39m error[33m;[39m[22m
[2m     [90m 380 |[39m         }[22m
[2m     [90m 381 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/messageModel.js[2m:378:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mMessageModel › createMessage › should create a public message successfully[39m[22m

    TypeError: Invalid attempt to destructure non-iterable instance.
    In order to be iterable, non-array objects must have a [Symbol.iterator]() method.
[2m[22m
[2m    [0m [90m 1 |[39m [36mimport[39m { getDatabaseConnection } [36mfrom[39m [32m'../configurations/dbConfig.js'[39m[33m;[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 2 |[39m[22m
[2m     [90m   |[39m [31m[1m^[22m[2m[39m[22m
[2m     [90m 3 |[39m [36mclass[39m [33mMessageModel[39m {[22m
[2m     [90m 4 |[39m     [90m// Existing method to create a public message[39m[22m
[2m     [90m 5 |[39m     [36mstatic[39m [36masync[39m createMessage(messageText[33m,[39m sender[33m,[39m status[33m,[39m timestamp[33m,[39m conversationId) {[0m[22m
[2m[22m
[2m      [2mat _nonIterableRest ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat _nonIterableRest ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat _slicedToArray ([22m[2mmodels/messageModel.js[2m:16:87)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mMessageModel › createPrivateMessage › should create a private message successfully[39m[22m

    TypeError: Invalid attempt to destructure non-iterable instance.
    In order to be iterable, non-array objects must have a [Symbol.iterator]() method.
[2m[22m
[2m    [0m [90m 1 |[39m [36mimport[39m { getDatabaseConnection } [36mfrom[39m [32m'../configurations/dbConfig.js'[39m[33m;[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 2 |[39m[22m
[2m     [90m   |[39m [31m[1m^[22m[2m[39m[22m
[2m     [90m 3 |[39m [36mclass[39m [33mMessageModel[39m {[22m
[2m     [90m 4 |[39m     [90m// Existing method to create a public message[39m[22m
[2m     [90m 5 |[39m     [36mstatic[39m [36masync[39m createMessage(messageText[33m,[39m sender[33m,[39m status[33m,[39m timestamp[33m,[39m conversationId) {[0m[22m
[2m[22m
[2m      [2mat _nonIterableRest ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat _nonIterableRest ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat _slicedToArray ([22m[2mmodels/messageModel.js[2m:202:85)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m

[0m[7m[1m[31m FAIL [39m[22m[27m[0m [2mtests/unit/[22m[1mreviewModel.test.js[22m
  [1m● [22mConsole

    [2m[31mconsole.error[39m[22m
[31m      Error fetching reviews: Error: Database Error[39m
[31m          at _callee2$ (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/reviewModel.test.js:44:54)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/reviewModel.test.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/reviewModel.test.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/reviewModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/reviewModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/reviewModel.test.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/reviewModel.test.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at Object.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/reviewModel.test.js:2:1)[39m
[31m          at Promise.then.completed (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:298:28)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at callAsyncCircusFn (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:231:10)[39m
[31m          at _callCircusTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:316:40)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m          at _runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:252:3)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:126:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at run (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:71:3)[39m
[31m          at runAndTransformResultsToJestFormat (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)[39m
[31m          at jestAdapter (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)[39m
[31m          at runTestInternal (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:367:16)[39m
[31m          at runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:444:34)[39m
[31m          at Object.worker (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/testWorker.js:106:12)[39m
[2m[22m
[2m    [0m [90m 21 |[39m             [36mreturn[39m rows[33m;[39m[22m
[2m     [90m 22 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 23 |[39m             console[33m.[39merror([32m"Error fetching reviews:"[39m[33m,[39m error)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 24 |[39m             [36mthrow[39m error[33m;[39m[22m
[2m     [90m 25 |[39m         }[22m
[2m     [90m 26 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/reviewModel.js[2m:23:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error adding review: Invalid attempt to destructure non-iterable instance.[39m
[31m      In order to be iterable, non-array objects must have a [Symbol.iterator]() method.[39m
[2m[22m
[2m    [0m [90m 62 |[39m             [36mreturn[39m result[33m;[39m[22m
[2m     [90m 63 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 64 |[39m             console[33m.[39merror([32m"Error adding review:"[39m[33m,[39m error[33m.[39mmessage)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 65 |[39m             [36mthrow[39m error[33m;[39m[22m
[2m     [90m 66 |[39m         }        [22m
[2m     [90m 67 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/reviewModel.js[2m:64:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error adding review: Database Error[39m
[2m[22m
[2m    [0m [90m 62 |[39m             [36mreturn[39m result[33m;[39m[22m
[2m     [90m 63 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 64 |[39m             console[33m.[39merror([32m"Error adding review:"[39m[33m,[39m error[33m.[39mmessage)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 65 |[39m             [36mthrow[39m error[33m;[39m[22m
[2m     [90m 66 |[39m         }        [22m
[2m     [90m 67 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/reviewModel.js[2m:64:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error adding review: Invalid attempt to destructure non-iterable instance.[39m
[31m      In order to be iterable, non-array objects must have a [Symbol.iterator]() method.[39m
[2m[22m
[2m    [0m [90m 62 |[39m             [36mreturn[39m result[33m;[39m[22m
[2m     [90m 63 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 64 |[39m             console[33m.[39merror([32m"Error adding review:"[39m[33m,[39m error[33m.[39mmessage)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 65 |[39m             [36mthrow[39m error[33m;[39m[22m
[2m     [90m 66 |[39m         }        [22m
[2m     [90m 67 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/reviewModel.js[2m:64:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error adding review: Invalid attempt to destructure non-iterable instance.[39m
[31m      In order to be iterable, non-array objects must have a [Symbol.iterator]() method.[39m
[2m[22m
[2m    [0m [90m 62 |[39m             [36mreturn[39m result[33m;[39m[22m
[2m     [90m 63 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 64 |[39m             console[33m.[39merror([32m"Error adding review:"[39m[33m,[39m error[33m.[39mmessage)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 65 |[39m             [36mthrow[39m error[33m;[39m[22m
[2m     [90m 66 |[39m         }        [22m
[2m     [90m 67 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/reviewModel.js[2m:64:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mReviewModel › getReviewsByResourceId › should fetch reviews by resource ID successfully (positive)[39m[22m

    [2mexpect([22m[31mreceived[39m[2m).[22mtoBe[2m([22m[32mexpected[39m[2m) // Object.is equality[22m

    Expected: [32m"SELECT reviewer_name, review_content, upvote_downvote, created_at FROM resource_reviews WHERE resource_id = ? ORDER BY created_at DESC"[39m
    Received: [31m"SELECT [7mu.user_name AS [27mreviewer_name, [7mrr.[27mreview_content, [7mrr.[27mupvote_downvote, [7mrr.[27mcreated_at FROM resource_reviews [7mrr JOIN user u ON rr.reviewer_id = u.id [27mWHERE [7mrr.[27mresource_id = ?[7m AND u.account_status = 'active'[27m ORDER BY [7mrr.[27mcreated_at DESC[7m;[27m"[39m
[2m[22m
[2m    [0m [90m 36 |[39m [32m            `[39m[33m;[39m[22m
[2m     [90m 37 |[39m             [36mconst[39m normalizeQuery [33m=[39m (query) [33m=>[39m query[33m.[39mreplace([35m/\s+/g[39m[33m,[39m [32m" "[39m)[33m.[39mtrim()[33m;[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 38 |[39m             expect(normalizeQuery(mockConnection[33m.[39mexecute[33m.[39mmock[33m.[39mcalls[[35m0[39m][[35m0[39m]))[33m.[39mtoBe(normalizeQuery(expectedQuery))[33m;[39m[22m
[2m     [90m    |[39m                                                                             [31m[1m^[22m[2m[39m[22m
[2m     [90m 39 |[39m             expect(mockConnection[33m.[39mexecute[33m.[39mmock[33m.[39mcalls[[35m0[39m][[35m1[39m])[33m.[39mtoEqual([[35m1[39m])[33m;[39m[22m
[2m     [90m 40 |[39m             expect(result)[33m.[39mtoEqual(reviews)[33m;[39m[22m
[2m     [90m 41 |[39m         })[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toBe ([22m[2m[0m[36mtests/unit/reviewModel.test.js[39m[0m[2m:38:77)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/unit/reviewModel.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/unit/reviewModel.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/unit/reviewModel.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/unit/reviewModel.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/unit/reviewModel.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mReviewModel › addReview › should add a new review successfully (positive)[39m[22m

    TypeError: Invalid attempt to destructure non-iterable instance.
    In order to be iterable, non-array objects must have a [Symbol.iterator]() method.
[2m[22m
[2m    [0m [90m 1 |[39m [36mimport[39m { getDatabaseConnection } [36mfrom[39m [32m"../configurations/dbConfig.js"[39m[33m;[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 2 |[39m[22m
[2m     [90m   |[39m [31m[1m^[22m[2m[39m[22m
[2m     [90m 3 |[39m [36mclass[39m [33mReviewModel[39m {[22m
[2m     [90m 4 |[39m     [90m// Fetch reviews by resource ID[39m[22m
[2m     [90m 5 |[39m     [36mstatic[39m [36masync[39m getReviewsByResourceId(resourceId) {[0m[22m
[2m[22m
[2m      [2mat _nonIterableRest ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat _nonIterableRest ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat _slicedToArray ([22m[2mmodels/reviewModel.js[2m:40:91)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m

[0m[7m[1m[31m FAIL [39m[22m[27m[0m [2mtests/integration/[22m[1memergencyContactController.test.js[22m ([0m[1m[41m6.804 s[49m[22m[0m)
  [1m● [22mConsole

    [2mconsole.log[22m
      SSH connection established.
[2m[22m
[2m      [2mat Client.log ([22m[2mconfigurations/mysqlDatabase.js[2m:180:25)[22m[2m[22m

    [2mconsole.log[22m
      Connected to database: sb2-test
[2m[22m
[2m      [2mat log ([22m[2mconfigurations/dbConfig.js[2m:62:17)[22m[2m[22m

    [2mconsole.log[22m
      Connected to database in setDatabaseconnection: sb2
[2m[22m
[2m      [2mat log ([22m[2mconfigurations/dbConfig.js[2m:31:17)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error executing query Error: Unknown column 'account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/emergencyContactModel.js:179:50)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/emergencyContactModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/emergencyContactModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/emergencyContactModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/emergencyContactModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/emergencyContactModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[2m[22m
[2m    [0m [90m 218 |[39m             [36mreturn[39m results[33m;[39m[22m
[2m     [90m 219 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 220 |[39m             console[33m.[39merror([32m"Error executing query"[39m[33m,[39m err[33m.[39mstack)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 221 |[39m             [36mthrow[39m err[33m;[39m[22m
[2m     [90m 222 |[39m         }[22m
[2m     [90m 223 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/emergencyContactModel.js[2m:220:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/emergencyContactModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/emergencyContactModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/emergencyContactModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/emergencyContactModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/emergencyContactModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error in sending connect request:  Error: Unknown column 'account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/emergencyContactModel.js:179:50)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/emergencyContactModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/emergencyContactModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/emergencyContactModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/emergencyContactModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/emergencyContactModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5) {[39m
[31m        code: 'ER_BAD_FIELD_ERROR',[39m
[31m        errno: 1054,[39m
[31m        sql: '\n' +[39m
[31m          '            SELECT id\n' +[39m
[31m          '            FROM user\n' +[39m
[31m          '            WHERE user_name = ?\n' +[39m
[31m          "            AND account_status = 'active';\n" +[39m
[31m          '            ',[39m
[31m        sqlState: '42S22',[39m
[31m        sqlMessage: "Unknown column 'account_status' in 'where clause'"[39m
[31m      }[39m
[2m[22m
[2m    [0m [90m 104 |[39m             })[33m;[39m[22m
[2m     [90m 105 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 106 |[39m             console[33m.[39merror([32m"Error in sending connect request: "[39m[33m,[39m err)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 107 |[39m             res[33m.[39mstatus([35m500[39m)[33m.[39mjson({ message[33m:[39m [32m"Internal Server Error"[39m })[33m;[39m[22m
[2m     [90m 108 |[39m         }[22m
[2m     [90m 109 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/emergencyContactController.js[2m:106:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/emergencyContactController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/emergencyContactController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/emergencyContactController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/emergencyContactController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/emergencyContactController.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error in sending connect request:  Error: Database error[39m
[31m          at Function.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/emergencyContactController.test.js:110:23)[39m
[31m          at /Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-mock/build/index.js:397:39[39m
[31m          at Function.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-mock/build/index.js:404:13)[39m
[31m          at Function.mockConstructor (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-mock/build/index.js:148:19)[39m
[31m          at insertPendingRequest (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/emergencyContactController.js:60:41)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/emergencyContactController.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/emergencyContactController.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/emergencyContactController.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/emergencyContactController.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/emergencyContactController.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/emergencyContactController.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at Function.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/emergencyContactController.js:2:1)[39m
[31m          at Function.apply [as sendConnectRequest] (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/emergencyContactController.js:56:36)[39m
[31m          at sendConnectRequest (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/emergencyContactController.test.js:113:46)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/emergencyContactController.test.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/emergencyContactController.test.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/emergencyContactController.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/emergencyContactController.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/emergencyContactController.test.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/emergencyContactController.test.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at Object.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/emergencyContactController.test.js:2:1)[39m
[31m          at Promise.then.completed (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:298:28)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at callAsyncCircusFn (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:231:10)[39m
[31m          at _callCircusTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:316:40)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m          at _runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:252:3)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:126:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at run (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:71:3)[39m
[31m          at runAndTransformResultsToJestFormat (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)[39m
[31m          at jestAdapter (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)[39m
[31m          at runTestInternal (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:367:16)[39m
[31m          at runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:444:34)[39m
[31m          at Object.worker (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/testWorker.js:106:12)[39m
[2m[22m
[2m    [0m [90m 104 |[39m             })[33m;[39m[22m
[2m     [90m 105 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 106 |[39m             console[33m.[39merror([32m"Error in sending connect request: "[39m[33m,[39m err)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 107 |[39m             res[33m.[39mstatus([35m500[39m)[33m.[39mjson({ message[33m:[39m [32m"Internal Server Error"[39m })[33m;[39m[22m
[2m     [90m 108 |[39m         }[22m
[2m     [90m 109 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/emergencyContactController.js[2m:106:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/emergencyContactController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/emergencyContactController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mcontrollers/emergencyContactController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/emergencyContactController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/emergencyContactController.js[2m:2:1)[22m[2m[22m
[2m      [2mat _next ([22m[2mcontrollers/emergencyContactController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Function.<anonymous> ([22m[2mcontrollers/emergencyContactController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Function.apply [as sendConnectRequest] ([22m[2mcontrollers/emergencyContactController.js[2m:56:36)[22m[2m[22m
[2m      [2mat sendConnectRequest ([22m[2m[0m[36mtests/integration/emergencyContactController.test.js[39m[0m[2m:113:46)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/emergencyContactController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/emergencyContactController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/emergencyContactController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/emergencyContactController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/emergencyContactController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat _next ([22m[2m[0m[36mtests/integration/emergencyContactController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Object.<anonymous> ([22m[2m[0m[36mtests/integration/emergencyContactController.test.js[39m[0m[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error executing query Error: Unknown column 'account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/emergencyContactModel.js:251:50)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/emergencyContactModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/emergencyContactModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/emergencyContactModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/emergencyContactModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/emergencyContactModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[2m[22m
[2m    [0m [90m 295 |[39m             [90m// return results;[39m[22m
[2m     [90m 296 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 297 |[39m             console[33m.[39merror([32m"Error executing query"[39m[33m,[39m err[33m.[39mstack)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 298 |[39m             [36mthrow[39m err[33m;[39m[22m
[2m     [90m 299 |[39m         }[22m
[2m     [90m 300 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/emergencyContactModel.js[2m:297:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/emergencyContactModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/emergencyContactModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/emergencyContactModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/emergencyContactModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/emergencyContactModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error in accepting connect request:  Error: Unknown column 'account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/emergencyContactModel.js:251:50)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/emergencyContactModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/emergencyContactModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/emergencyContactModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/emergencyContactModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/emergencyContactModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5) {[39m
[31m        code: 'ER_BAD_FIELD_ERROR',[39m
[31m        errno: 1054,[39m
[31m        sql: '\n' +[39m
[31m          '                SELECT id\n' +[39m
[31m          '                FROM user\n' +[39m
[31m          '                WHERE user_name = ?\n' +[39m
[31m          "                AND account_status = 'active';\n" +[39m
[31m          '            ',[39m
[31m        sqlState: '42S22',[39m
[31m        sqlMessage: "Unknown column 'account_status' in 'where clause'"[39m
[31m      }[39m
[2m[22m
[2m    [0m [90m 161 |[39m             })[33m;[39m[22m
[2m     [90m 162 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 163 |[39m             console[33m.[39merror([32m"Error in accepting connect request: "[39m[33m,[39m err)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 164 |[39m             res[33m.[39mstatus([35m500[39m)[33m.[39mjson({ message[33m:[39m [32m"Internal Server Error"[39m })[33m;[39m[22m
[2m     [90m 165 |[39m         }[22m
[2m     [90m 166 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/emergencyContactController.js[2m:163:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/emergencyContactController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/emergencyContactController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/emergencyContactController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/emergencyContactController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/emergencyContactController.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error in sharing resource:  Error: Database error[39m
[31m          at Function.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/emergencyContactController.test.js:275:23)[39m
[31m          at /Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-mock/build/index.js:397:39[39m
[31m          at Function.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-mock/build/index.js:404:13)[39m
[31m          at Function.mockConstructor (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-mock/build/index.js:148:19)[39m
[31m          at updateResource (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/emergencyContactController.js:237:41)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/emergencyContactController.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/emergencyContactController.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/emergencyContactController.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/emergencyContactController.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/emergencyContactController.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/emergencyContactController.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at Function.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/emergencyContactController.js:2:1)[39m
[31m          at Function.apply [as shareResource] (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/emergencyContactController.js:233:31)[39m
[31m          at shareResource (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/emergencyContactController.test.js:278:46)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/emergencyContactController.test.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/emergencyContactController.test.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/emergencyContactController.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/emergencyContactController.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/emergencyContactController.test.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/emergencyContactController.test.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at Object.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/emergencyContactController.test.js:2:1)[39m
[31m          at Promise.then.completed (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:298:28)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at callAsyncCircusFn (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:231:10)[39m
[31m          at _callCircusTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:316:40)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m          at _runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:252:3)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:126:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at run (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:71:3)[39m
[31m          at runAndTransformResultsToJestFormat (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)[39m
[31m          at jestAdapter (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)[39m
[31m          at runTestInternal (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:367:16)[39m
[31m          at runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:444:34)[39m
[31m          at Object.worker (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/testWorker.js:106:12)[39m
[2m[22m
[2m    [0m [90m 257 |[39m             res[33m.[39mstatus([35m200[39m)[33m.[39mjson({ message[33m:[39m [32m"Resource shared successfully"[39m })[33m;[39m[22m
[2m     [90m 258 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 259 |[39m             console[33m.[39merror([32m"Error in sharing resource: "[39m[33m,[39m err)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 260 |[39m             res[33m.[39mstatus([35m500[39m)[33m.[39mjson({ message[33m:[39m [32m"Internal Server Error"[39m })[33m;[39m[22m
[2m     [90m 261 |[39m         }[22m
[2m     [90m 262 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/emergencyContactController.js[2m:259:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/emergencyContactController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/emergencyContactController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mcontrollers/emergencyContactController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/emergencyContactController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/emergencyContactController.js[2m:2:1)[22m[2m[22m
[2m      [2mat _next ([22m[2mcontrollers/emergencyContactController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Function.<anonymous> ([22m[2mcontrollers/emergencyContactController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Function.apply [as shareResource] ([22m[2mcontrollers/emergencyContactController.js[2m:233:31)[22m[2m[22m
[2m      [2mat shareResource ([22m[2m[0m[36mtests/integration/emergencyContactController.test.js[39m[0m[2m:278:46)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/emergencyContactController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/emergencyContactController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/emergencyContactController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/emergencyContactController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/emergencyContactController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat _next ([22m[2m[0m[36mtests/integration/emergencyContactController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Object.<anonymous> ([22m[2m[0m[36mtests/integration/emergencyContactController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mEmergencyContactController Integration Test › sendConnectRequest › should send a connect request from testA to testB[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 76 |[39m             [36mawait[39m [33mEmergencyContactController[39m[33m.[39msendConnectRequest(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 77 |[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 78 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m    |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 79 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith([22m
[2m     [90m 80 |[39m                 expect[33m.[39mobjectContaining({[22m
[2m     [90m 81 |[39m                     message[33m:[39m [32m"Connect request sent successfully"[39m[33m,[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/emergencyContactController.test.js[39m[0m[2m:78:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/emergencyContactController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/emergencyContactController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/emergencyContactController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/emergencyContactController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/emergencyContactController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mEmergencyContactController Integration Test › acceptConnectRequest › should accept a connect request from testA to testB[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 145 |[39m             [36mawait[39m [33mEmergencyContactController[39m[33m.[39macceptConnectRequest(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 146 |[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 147 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 148 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith([22m
[2m     [90m 149 |[39m                 expect[33m.[39mobjectContaining({[22m
[2m     [90m 150 |[39m                     message[33m:[39m [32m"Connect request accepted successfully"[39m[33m,[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/emergencyContactController.test.js[39m[0m[2m:147:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/emergencyContactController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/emergencyContactController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/emergencyContactController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/emergencyContactController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/emergencyContactController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[0m[7m[1m[32m PASS [39m[22m[27m[0m [2mtests/unit/[22m[1mwalletModel.test.js[22m
  [1m● [22mConsole

    [2m[31mconsole.error[39m[22m
[31m      Error fetching balance: Database error[39m
[2m[22m
[2m    [0m [90m 16 |[39m             res[33m.[39mstatus([35m200[39m)[33m.[39mjson({ balance })[33m;[39m[22m
[2m     [90m 17 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 18 |[39m             console[33m.[39merror([32m"Error fetching balance:"[39m[33m,[39m error[33m.[39mmessage)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 19 |[39m             res[33m.[39mstatus([35m500[39m)[33m.[39mjson({ message[33m:[39m [32m"Error fetching balance"[39m[33m,[39m error[33m:[39m error[33m.[39mmessage })[33m;[39m[22m
[2m     [90m 20 |[39m         }[22m
[2m     [90m 21 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/walletController.js[2m:18:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error adding card: Card already exists for this user[39m
[2m[22m
[2m    [0m [90m 30 |[39m             res[33m.[39mstatus([35m200[39m)[33m.[39mjson({ message[33m:[39m [32m"Card added successfully"[39m[33m,[39m cardId[33m:[39m result[33m.[39minsertId })[33m;[39m[22m
[2m     [90m 31 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 32 |[39m             console[33m.[39merror([32m"Error adding card:"[39m[33m,[39m error[33m.[39mmessage)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 33 |[39m[22m
[2m     [90m 34 |[39m             [90m// Handle duplicate card error[39m[22m
[2m     [90m 35 |[39m             [36mif[39m (error[33m.[39mmessage [33m===[39m [32m"Card already exists for this user"[39m) {[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/walletController.js[2m:32:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error adding card: Database error[39m
[2m[22m
[2m    [0m [90m 30 |[39m             res[33m.[39mstatus([35m200[39m)[33m.[39mjson({ message[33m:[39m [32m"Card added successfully"[39m[33m,[39m cardId[33m:[39m result[33m.[39minsertId })[33m;[39m[22m
[2m     [90m 31 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 32 |[39m             console[33m.[39merror([32m"Error adding card:"[39m[33m,[39m error[33m.[39mmessage)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 33 |[39m[22m
[2m     [90m 34 |[39m             [90m// Handle duplicate card error[39m[22m
[2m     [90m 35 |[39m             [36mif[39m (error[33m.[39mmessage [33m===[39m [32m"Card already exists for this user"[39m) {[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/walletController.js[2m:32:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching cards: Database error[39m
[2m[22m
[2m    [0m [90m 49 |[39m             res[33m.[39mstatus([35m200[39m)[33m.[39mjson(cards)[33m;[39m[22m
[2m     [90m 50 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 51 |[39m             console[33m.[39merror([32m"Error fetching cards:"[39m[33m,[39m error[33m.[39mmessage)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 52 |[39m             res[33m.[39mstatus([35m500[39m)[33m.[39mjson({ message[33m:[39m [32m"Error fetching cards"[39m[33m,[39m error[33m:[39m error[33m.[39mmessage })[33m;[39m[22m
[2m     [90m 53 |[39m         }[22m
[2m     [90m 54 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/walletController.js[2m:51:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error removing card: Error: Database error[39m
[31m          at _callee11$ (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/walletModel.test.js:173:59)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/walletModel.test.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/walletModel.test.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/walletModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/walletModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/walletModel.test.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/walletModel.test.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at Object.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/walletModel.test.js:2:1)[39m
[31m          at Promise.then.completed (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:298:28)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at callAsyncCircusFn (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:231:10)[39m
[31m          at _callCircusTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:316:40)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m          at _runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:252:3)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:126:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at run (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:71:3)[39m
[31m          at runAndTransformResultsToJestFormat (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)[39m
[31m          at jestAdapter (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)[39m
[31m          at runTestInternal (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:367:16)[39m
[31m          at runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:444:34)[39m
[31m          at Object.worker (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/testWorker.js:106:12)[39m
[2m[22m
[2m    [0m [90m 193 |[39m             res[33m.[39mstatus([35m200[39m)[33m.[39mjson({ message[33m:[39m [32m"Card removed successfully"[39m })[33m;[39m[22m
[2m     [90m 194 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 195 |[39m             console[33m.[39merror([32m"Error removing card:"[39m[33m,[39m error)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 196 |[39m             res[33m.[39mstatus([35m500[39m)[33m.[39mjson({ message[33m:[39m [32m"Failed to remove card"[39m[33m,[39m error[33m:[39m error[33m.[39mmessage })[33m;[39m[22m
[2m     [90m 197 |[39m         }[22m
[2m     [90m 198 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/walletController.js[2m:195:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error adding card: Invalid card number[39m
[2m[22m
[2m    [0m [90m 30 |[39m             res[33m.[39mstatus([35m200[39m)[33m.[39mjson({ message[33m:[39m [32m"Card added successfully"[39m[33m,[39m cardId[33m:[39m result[33m.[39minsertId })[33m;[39m[22m
[2m     [90m 31 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 32 |[39m             console[33m.[39merror([32m"Error adding card:"[39m[33m,[39m error[33m.[39mmessage)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 33 |[39m[22m
[2m     [90m 34 |[39m             [90m// Handle duplicate card error[39m[22m
[2m     [90m 35 |[39m             [36mif[39m (error[33m.[39mmessage [33m===[39m [32m"Card already exists for this user"[39m) {[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/walletController.js[2m:32:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching balance: Database error[39m
[2m[22m
[2m    [0m [90m 16 |[39m             res[33m.[39mstatus([35m200[39m)[33m.[39mjson({ balance })[33m;[39m[22m
[2m     [90m 17 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 18 |[39m             console[33m.[39merror([32m"Error fetching balance:"[39m[33m,[39m error[33m.[39mmessage)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 19 |[39m             res[33m.[39mstatus([35m500[39m)[33m.[39mjson({ message[33m:[39m [32m"Error fetching balance"[39m[33m,[39m error[33m:[39m error[33m.[39mmessage })[33m;[39m[22m
[2m     [90m 20 |[39m         }[22m
[2m     [90m 21 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/walletController.js[2m:18:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error adding card: Cannot read properties of undefined (reading 'insertId')[39m
[2m[22m
[2m    [0m [90m 30 |[39m             res[33m.[39mstatus([35m200[39m)[33m.[39mjson({ message[33m:[39m [32m"Card added successfully"[39m[33m,[39m cardId[33m:[39m result[33m.[39minsertId })[33m;[39m[22m
[2m     [90m 31 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 32 |[39m             console[33m.[39merror([32m"Error adding card:"[39m[33m,[39m error[33m.[39mmessage)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 33 |[39m[22m
[2m     [90m 34 |[39m             [90m// Handle duplicate card error[39m[22m
[2m     [90m 35 |[39m             [36mif[39m (error[33m.[39mmessage [33m===[39m [32m"Card already exists for this user"[39m) {[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/walletController.js[2m:32:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error adding card: Cannot read properties of undefined (reading 'insertId')[39m
[2m[22m
[2m    [0m [90m 30 |[39m             res[33m.[39mstatus([35m200[39m)[33m.[39mjson({ message[33m:[39m [32m"Card added successfully"[39m[33m,[39m cardId[33m:[39m result[33m.[39minsertId })[33m;[39m[22m
[2m     [90m 31 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 32 |[39m             console[33m.[39merror([32m"Error adding card:"[39m[33m,[39m error[33m.[39mmessage)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 33 |[39m[22m
[2m     [90m 34 |[39m             [90m// Handle duplicate card error[39m[22m
[2m     [90m 35 |[39m             [36mif[39m (error[33m.[39mmessage [33m===[39m [32m"Card already exists for this user"[39m) {[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/walletController.js[2m:32:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error adding card: Card already exists for this user[39m
[2m[22m
[2m    [0m [90m 30 |[39m             res[33m.[39mstatus([35m200[39m)[33m.[39mjson({ message[33m:[39m [32m"Card added successfully"[39m[33m,[39m cardId[33m:[39m result[33m.[39minsertId })[33m;[39m[22m
[2m     [90m 31 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 32 |[39m             console[33m.[39merror([32m"Error adding card:"[39m[33m,[39m error[33m.[39mmessage)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 33 |[39m[22m
[2m     [90m 34 |[39m             [90m// Handle duplicate card error[39m[22m
[2m     [90m 35 |[39m             [36mif[39m (error[33m.[39mmessage [33m===[39m [32m"Card already exists for this user"[39m) {[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/walletController.js[2m:32:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error removing card: Error: Database error[39m
[31m          at _callee21$ (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/walletModel.test.js:346:54)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/walletModel.test.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/walletModel.test.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/walletModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/walletModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/walletModel.test.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/walletModel.test.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at Object.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/walletModel.test.js:2:1)[39m
[31m          at Promise.then.completed (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:298:28)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at callAsyncCircusFn (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:231:10)[39m
[31m          at _callCircusTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:316:40)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m          at _runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:252:3)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:126:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at run (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:71:3)[39m
[31m          at runAndTransformResultsToJestFormat (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)[39m
[31m          at jestAdapter (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)[39m
[31m          at runTestInternal (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:367:16)[39m
[31m          at runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:444:34)[39m
[31m          at Object.worker (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/testWorker.js:106:12)[39m
[2m[22m
[2m    [0m [90m 193 |[39m             res[33m.[39mstatus([35m200[39m)[33m.[39mjson({ message[33m:[39m [32m"Card removed successfully"[39m })[33m;[39m[22m
[2m     [90m 194 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 195 |[39m             console[33m.[39merror([32m"Error removing card:"[39m[33m,[39m error)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 196 |[39m             res[33m.[39mstatus([35m500[39m)[33m.[39mjson({ message[33m:[39m [32m"Failed to remove card"[39m[33m,[39m error[33m:[39m error[33m.[39mmessage })[33m;[39m[22m
[2m     [90m 197 |[39m         }[22m
[2m     [90m 198 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/walletController.js[2m:195:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching statistics: Database error[39m
[2m[22m
[2m    [0m [90m 126 |[39m             })[33m;[39m[22m
[2m     [90m 127 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 128 |[39m             console[33m.[39merror([32m"Error fetching statistics:"[39m[33m,[39m error[33m.[39mmessage)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 129 |[39m             res[33m.[39mstatus([35m500[39m)[33m.[39mjson({ message[33m:[39m [32m"Failed to fetch statistics"[39m })[33m;[39m[22m
[2m     [90m 130 |[39m         }[22m
[2m     [90m 131 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/walletController.js[2m:128:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m

    [2mconsole.log[22m
      100 50
[2m[22m
[2m      [2mat log ([22m[2mcontrollers/walletController.js[2m:158:21)[22m[2m[22m

    [2mconsole.log[22m
      100 150
[2m[22m
[2m      [2mat log ([22m[2mcontrollers/walletController.js[2m:158:21)[22m[2m[22m

    [2mconsole.log[22m
      100 50
[2m[22m
[2m      [2mat log ([22m[2mcontrollers/walletController.js[2m:158:21)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error processing donation: Error: Database error[39m
[31m          at _callee27$ (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/walletModel.test.js:452:69)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/walletModel.test.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/walletModel.test.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/walletModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/walletModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/walletModel.test.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/walletModel.test.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at Object.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/walletModel.test.js:2:1)[39m
[31m          at Promise.then.completed (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:298:28)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at callAsyncCircusFn (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:231:10)[39m
[31m          at _callCircusTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:316:40)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m          at _runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:252:3)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:126:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at run (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:71:3)[39m
[31m          at runAndTransformResultsToJestFormat (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)[39m
[31m          at jestAdapter (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)[39m
[31m          at runTestInternal (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:367:16)[39m
[31m          at runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:444:34)[39m
[31m          at Object.worker (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/testWorker.js:106:12)[39m
[2m[22m
[2m    [0m [90m 174 |[39m             res[33m.[39mstatus([35m200[39m)[33m.[39mjson({ message[33m:[39m [32m"Donation successful"[39m })[33m;[39m[22m
[2m     [90m 175 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 176 |[39m             console[33m.[39merror([32m"Error processing donation:"[39m[33m,[39m error)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 177 |[39m             res[33m.[39mstatus([35m500[39m)[33m.[39mjson({ message[33m:[39m [32m"Failed to process donation"[39m })[33m;[39m[22m
[2m     [90m 178 |[39m         }[22m
[2m     [90m 179 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/walletController.js[2m:176:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/walletController.js[2m:2:1)[22m[2m[22m

[0m[7m[1m[32m PASS [39m[22m[27m[0m [2mtests/unit/[22m[1muserModel.test.js[22m
  [1m● [22mConsole

    [2mconsole.log[22m
      getUserByUsername: No user found with username: nonExistentUser
[2m[22m
[2m      [2mat log ([22m[2mmodels/userModel.js[2m:40:25)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error executing query Error: Database Error[39m
[31m          at _callee3$ (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/userModel.test.js:53:54)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/userModel.test.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/userModel.test.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/userModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/userModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/userModel.test.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/userModel.test.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at Object.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/userModel.test.js:2:1)[39m
[31m          at Promise.then.completed (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:298:28)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at callAsyncCircusFn (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:231:10)[39m
[31m          at _callCircusTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:316:40)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m          at _runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:252:3)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:126:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at run (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:71:3)[39m
[31m          at runAndTransformResultsToJestFormat (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)[39m
[31m          at jestAdapter (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)[39m
[31m          at runTestInternal (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:367:16)[39m
[31m          at runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:444:34)[39m
[31m          at Object.worker (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/testWorker.js:106:12)[39m
[2m[22m
[2m    [0m [90m 51 |[39m             }[33m;[39m[22m
[2m     [90m 52 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 53 |[39m             console[33m.[39merror([32m"Error executing query"[39m[33m,[39m err[33m.[39mstack)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 54 |[39m             [36mthrow[39m err[33m;[39m[22m
[2m     [90m 55 |[39m         }[22m
[2m     [90m 56 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/userModel.js[2m:53:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error executing query: Database Error[39m
[2m[22m
[2m    [0m [90m 304 |[39m             [36mreturn[39m { id[33m:[39m userId[33m,[39m username[33m:[39m [36mthis[39m[33m.[39musername }[33m;[39m[22m
[2m     [90m 305 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 306 |[39m             console[33m.[39merror([32m"Error executing query:"[39m[33m,[39m err[33m.[39mmessage)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 307 |[39m             [36mthrow[39m err[33m;[39m[22m
[2m     [90m 308 |[39m         }[22m
[2m     [90m 309 |[39m     }[0m[22m
[2m[22m
[2m      [2mat UserModel.error ([22m[2mmodels/userModel.js[2m:306:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m

    [2mconsole.log[22m
      User validated: { user_password: 'hashedPassword' }
[2m[22m
[2m      [2mat log ([22m[2mmodels/userModel.js[2m:333:21)[22m[2m[22m

    [2mconsole.log[22m
      Invalid password for user: testUser
[2m[22m
[2m      [2mat log ([22m[2mmodels/userModel.js[2m:330:25)[22m[2m[22m

    [2mconsole.log[22m
      validatePassword: No user found with username: nonExistentUser
[2m[22m
[2m      [2mat log ([22m[2mmodels/userModel.js[2m:319:25)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error executing query Error: Database Error[39m
[31m          at _callee10$ (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/userModel.test.js:122:54)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/userModel.test.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/userModel.test.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/userModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/userModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/userModel.test.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/userModel.test.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at Object.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/userModel.test.js:2:1)[39m
[31m          at Promise.then.completed (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:298:28)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at callAsyncCircusFn (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:231:10)[39m
[31m          at _callCircusTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:316:40)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m          at _runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:252:3)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:126:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at run (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:71:3)[39m
[31m          at runAndTransformResultsToJestFormat (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)[39m
[31m          at jestAdapter (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)[39m
[31m          at runTestInternal (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:367:16)[39m
[31m          at runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:444:34)[39m
[31m          at Object.worker (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/testWorker.js:106:12)[39m
[2m[22m
[2m    [0m [90m 334 |[39m             [36mreturn[39m user[33m;[39m[22m
[2m     [90m 335 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 336 |[39m             console[33m.[39merror([32m"Error executing query"[39m[33m,[39m err[33m.[39mstack)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 337 |[39m             [36mthrow[39m err[33m;[39m[22m
[2m     [90m 338 |[39m         }[22m
[2m     [90m 339 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/userModel.js[2m:336:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error executing query Error: Database Error[39m
[31m          at _callee12$ (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/userModel.test.js:139:54)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/userModel.test.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/userModel.test.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/userModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/userModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/userModel.test.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/userModel.test.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at Object.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/userModel.test.js:2:1)[39m
[31m          at Promise.then.completed (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:298:28)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at callAsyncCircusFn (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:231:10)[39m
[31m          at _callCircusTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:316:40)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m          at _runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:252:3)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:126:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at run (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:71:3)[39m
[31m          at runAndTransformResultsToJestFormat (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)[39m
[31m          at jestAdapter (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)[39m
[31m          at runTestInternal (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:367:16)[39m
[31m          at runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:444:34)[39m
[31m          at Object.worker (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/testWorker.js:106:12)[39m
[2m[22m
[2m    [0m [90m 350 |[39m             [36mreturn[39m result[33m;[39m[22m
[2m     [90m 351 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 352 |[39m             console[33m.[39merror([32m"Error executing query"[39m[33m,[39m err[33m.[39mstack)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 353 |[39m             [36mthrow[39m err[33m;[39m[22m
[2m     [90m 354 |[39m         }[22m
[2m     [90m 355 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/userModel.js[2m:352:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error executing query Error: Database Error[39m
[31m          at _callee14$ (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/userModel.test.js:158:54)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/userModel.test.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/userModel.test.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/userModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/userModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/userModel.test.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/userModel.test.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at Object.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/userModel.test.js:2:1)[39m
[31m          at Promise.then.completed (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:298:28)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at callAsyncCircusFn (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:231:10)[39m
[31m          at _callCircusTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:316:40)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m          at _runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:252:3)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:126:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at run (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:71:3)[39m
[31m          at runAndTransformResultsToJestFormat (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)[39m
[31m          at jestAdapter (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)[39m
[31m          at runTestInternal (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:367:16)[39m
[31m          at runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:444:34)[39m
[31m          at Object.worker (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/testWorker.js:106:12)[39m
[2m[22m
[2m    [0m [90m 368 |[39m             [36mreturn[39m result[33m;[39m[22m
[2m     [90m 369 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 370 |[39m             console[33m.[39merror([32m"Error executing query"[39m[33m,[39m err[33m.[39mstack)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 371 |[39m             [36mthrow[39m err[33m;[39m[22m
[2m     [90m 372 |[39m         }[22m
[2m     [90m 373 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/userModel.js[2m:370:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching all users Error: Database Error[39m
[31m          at _callee16$ (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/userModel.test.js:176:54)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/userModel.test.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/userModel.test.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/userModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/userModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/userModel.test.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/userModel.test.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at Object.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/userModel.test.js:2:1)[39m
[31m          at Promise.then.completed (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:298:28)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at callAsyncCircusFn (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:231:10)[39m
[31m          at _callCircusTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:316:40)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m          at _runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:252:3)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:126:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at run (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:71:3)[39m
[31m          at runAndTransformResultsToJestFormat (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)[39m
[31m          at jestAdapter (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)[39m
[31m          at runTestInternal (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:367:16)[39m
[31m          at runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:444:34)[39m
[31m          at Object.worker (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/testWorker.js:106:12)[39m
[2m[22m
[2m    [0m [90m 386 |[39m             [36mreturn[39m rows[33m;[39m [90m// Return the array of users[39m[22m
[2m     [90m 387 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 388 |[39m             console[33m.[39merror([32m"Error fetching all users"[39m[33m,[39m err[33m.[39mstack)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 389 |[39m             [36mthrow[39m err[33m;[39m[22m
[2m     [90m 390 |[39m         }[22m
[2m     [90m 391 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/userModel.js[2m:388:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error updating citizen status Error: Database Error[39m
[31m          at _callee18$ (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/userModel.test.js:195:54)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/userModel.test.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/userModel.test.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/userModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/userModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/userModel.test.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/userModel.test.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at Object.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/userModel.test.js:2:1)[39m
[31m          at Promise.then.completed (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:298:28)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at callAsyncCircusFn (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:231:10)[39m
[31m          at _callCircusTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:316:40)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m          at _runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:252:3)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:126:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at run (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:71:3)[39m
[31m          at runAndTransformResultsToJestFormat (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)[39m
[31m          at jestAdapter (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)[39m
[31m          at runTestInternal (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:367:16)[39m
[31m          at runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:444:34)[39m
[31m          at Object.worker (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/testWorker.js:106:12)[39m
[2m[22m
[2m    [0m [90m 423 |[39m             [36mreturn[39m result[33m;[39m[22m
[2m     [90m 424 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 425 |[39m             console[33m.[39merror([32m"Error updating citizen status"[39m[33m,[39m err[33m.[39mstack)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 426 |[39m             [36mthrow[39m err[33m;[39m[22m
[2m     [90m 427 |[39m         }[22m
[2m     [90m 428 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/userModel.js[2m:425:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m

[0m[7m[1m[32m PASS [39m[22m[27m[0m [2mtests/unit/[22m[1mmapResourceModel.test.js[22m
  [1m● [22mConsole

    [2m[31mconsole.error[39m[22m
[31m      Error fetching resources: Error: Database Error[39m
[31m          at _callee2$ (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/mapResourceModel.test.js:31:54)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/mapResourceModel.test.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/mapResourceModel.test.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/mapResourceModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/mapResourceModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/mapResourceModel.test.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/mapResourceModel.test.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at Object.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/mapResourceModel.test.js:2:1)[39m
[31m          at Promise.then.completed (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:298:28)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at callAsyncCircusFn (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:231:10)[39m
[31m          at _callCircusTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:316:40)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m          at _runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:252:3)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:126:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at run (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:71:3)[39m
[31m          at runAndTransformResultsToJestFormat (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)[39m
[31m          at jestAdapter (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)[39m
[31m          at runTestInternal (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:367:16)[39m
[31m          at runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:444:34)[39m
[31m          at Object.worker (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/testWorker.js:106:12)[39m
[2m[22m
[2m    [0m [90m 10 |[39m             [36mreturn[39m rows[33m;[39m[22m
[2m     [90m 11 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 12 |[39m             console[33m.[39merror([32m'Error fetching resources:'[39m[33m,[39m error)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 13 |[39m             [36mthrow[39m error[33m;[39m[22m
[2m     [90m 14 |[39m         }[22m
[2m     [90m 15 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/mapResourceModel.js[2m:12:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/mapResourceModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/mapResourceModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/mapResourceModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/mapResourceModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/mapResourceModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error adding resource: Error: Database Error[39m
[31m          at _callee4$ (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/mapResourceModel.test.js:70:54)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/mapResourceModel.test.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/mapResourceModel.test.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/mapResourceModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/mapResourceModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/mapResourceModel.test.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/mapResourceModel.test.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at Object.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/mapResourceModel.test.js:2:1)[39m
[31m          at Promise.then.completed (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:298:28)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at callAsyncCircusFn (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:231:10)[39m
[31m          at _callCircusTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:316:40)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m          at _runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:252:3)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:126:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at run (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:71:3)[39m
[31m          at runAndTransformResultsToJestFormat (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)[39m
[31m          at jestAdapter (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)[39m
[31m          at runTestInternal (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:367:16)[39m
[31m          at runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:444:34)[39m
[31m          at Object.worker (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/testWorker.js:106:12)[39m
[2m[22m
[2m    [0m [90m 26 |[39m             [36mreturn[39m result[33m;[39m[22m
[2m     [90m 27 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 28 |[39m             console[33m.[39merror([32m'Error adding resource:'[39m[33m,[39m error)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 29 |[39m             [36mthrow[39m error[33m;[39m[22m
[2m     [90m 30 |[39m         }[22m
[2m     [90m 31 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/mapResourceModel.js[2m:28:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/mapResourceModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/mapResourceModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/mapResourceModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/mapResourceModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/mapResourceModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error adding resource: TypeError: Invalid attempt to destructure non-iterable instance.[39m
[31m      In order to be iterable, non-array objects must have a [Symbol.iterator]() method.[39m
[31m          at _nonIterableRest (/Users/shangchienliu/Desktop/f24-fse-sb2/models/mapResourceModel.js:2:1)[39m
[31m          at _nonIterableRest (/Users/shangchienliu/Desktop/f24-fse-sb2/models/mapResourceModel.js:2:1)[39m
[31m          at _slicedToArray (/Users/shangchienliu/Desktop/f24-fse-sb2/models/mapResourceModel.js:25:104)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/mapResourceModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/mapResourceModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/mapResourceModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/mapResourceModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/mapResourceModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[2m[22m
[2m    [0m [90m 26 |[39m             [36mreturn[39m result[33m;[39m[22m
[2m     [90m 27 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 28 |[39m             console[33m.[39merror([32m'Error adding resource:'[39m[33m,[39m error)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 29 |[39m             [36mthrow[39m error[33m;[39m[22m
[2m     [90m 30 |[39m         }[22m
[2m     [90m 31 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/mapResourceModel.js[2m:28:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/mapResourceModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/mapResourceModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mmodels/mapResourceModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/mapResourceModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/mapResourceModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error adding resource: TypeError: Invalid attempt to destructure non-iterable instance.[39m
[31m      In order to be iterable, non-array objects must have a [Symbol.iterator]() method.[39m
[31m          at _nonIterableRest (/Users/shangchienliu/Desktop/f24-fse-sb2/models/mapResourceModel.js:2:1)[39m
[31m          at _nonIterableRest (/Users/shangchienliu/Desktop/f24-fse-sb2/models/mapResourceModel.js:2:1)[39m
[31m          at _slicedToArray (/Users/shangchienliu/Desktop/f24-fse-sb2/models/mapResourceModel.js:25:104)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/mapResourceModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/mapResourceModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/mapResourceModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/mapResourceModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/mapResourceModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[2m[22m
[2m    [0m [90m 26 |[39m             [36mreturn[39m result[33m;[39m[22m
[2m     [90m 27 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 28 |[39m             console[33m.[39merror([32m'Error adding resource:'[39m[33m,[39m error)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 29 |[39m             [36mthrow[39m error[33m;[39m[22m
[2m     [90m 30 |[39m         }[22m
[2m     [90m 31 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/mapResourceModel.js[2m:28:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/mapResourceModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/mapResourceModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mmodels/mapResourceModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/mapResourceModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/mapResourceModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error updating resource location: Error: Database Error[39m
[31m          at _callee8$ (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/mapResourceModel.test.js:115:54)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/mapResourceModel.test.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/mapResourceModel.test.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/mapResourceModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/mapResourceModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/mapResourceModel.test.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/mapResourceModel.test.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at Object.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/mapResourceModel.test.js:2:1)[39m
[31m          at Promise.then.completed (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:298:28)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at callAsyncCircusFn (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:231:10)[39m
[31m          at _callCircusTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:316:40)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m          at _runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:252:3)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:126:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at run (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:71:3)[39m
[31m          at runAndTransformResultsToJestFormat (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)[39m
[31m          at jestAdapter (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)[39m
[31m          at runTestInternal (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:367:16)[39m
[31m          at runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:444:34)[39m
[31m          at Object.worker (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/testWorker.js:106:12)[39m
[2m[22m
[2m    [0m [90m 43 |[39m             [36mreturn[39m result[33m;[39m[22m
[2m     [90m 44 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 45 |[39m             console[33m.[39merror([32m'Error updating resource location:'[39m[33m,[39m error)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 46 |[39m             [36mthrow[39m error[33m;[39m[22m
[2m     [90m 47 |[39m         }[22m
[2m     [90m 48 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/mapResourceModel.js[2m:45:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/mapResourceModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/mapResourceModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/mapResourceModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/mapResourceModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/mapResourceModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error updating resource location: TypeError: Invalid attempt to destructure non-iterable instance.[39m
[31m      In order to be iterable, non-array objects must have a [Symbol.iterator]() method.[39m
[31m          at _nonIterableRest (/Users/shangchienliu/Desktop/f24-fse-sb2/models/mapResourceModel.js:2:1)[39m
[31m          at _nonIterableRest (/Users/shangchienliu/Desktop/f24-fse-sb2/models/mapResourceModel.js:2:1)[39m
[31m          at _slicedToArray (/Users/shangchienliu/Desktop/f24-fse-sb2/models/mapResourceModel.js:42:88)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/mapResourceModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/mapResourceModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/mapResourceModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/mapResourceModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/mapResourceModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[2m[22m
[2m    [0m [90m 43 |[39m             [36mreturn[39m result[33m;[39m[22m
[2m     [90m 44 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 45 |[39m             console[33m.[39merror([32m'Error updating resource location:'[39m[33m,[39m error)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 46 |[39m             [36mthrow[39m error[33m;[39m[22m
[2m     [90m 47 |[39m         }[22m
[2m     [90m 48 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/mapResourceModel.js[2m:45:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/mapResourceModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/mapResourceModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mmodels/mapResourceModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/mapResourceModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/mapResourceModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error updating resource location: TypeError: Invalid attempt to destructure non-iterable instance.[39m
[31m      In order to be iterable, non-array objects must have a [Symbol.iterator]() method.[39m
[31m          at _nonIterableRest (/Users/shangchienliu/Desktop/f24-fse-sb2/models/mapResourceModel.js:2:1)[39m
[31m          at _nonIterableRest (/Users/shangchienliu/Desktop/f24-fse-sb2/models/mapResourceModel.js:2:1)[39m
[31m          at _slicedToArray (/Users/shangchienliu/Desktop/f24-fse-sb2/models/mapResourceModel.js:42:88)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/mapResourceModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/mapResourceModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/mapResourceModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/mapResourceModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/mapResourceModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[2m[22m
[2m    [0m [90m 43 |[39m             [36mreturn[39m result[33m;[39m[22m
[2m     [90m 44 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 45 |[39m             console[33m.[39merror([32m'Error updating resource location:'[39m[33m,[39m error)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 46 |[39m             [36mthrow[39m error[33m;[39m[22m
[2m     [90m 47 |[39m         }[22m
[2m     [90m 48 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/mapResourceModel.js[2m:45:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/mapResourceModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/mapResourceModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mmodels/mapResourceModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/mapResourceModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/mapResourceModel.js[2m:2:1)[22m[2m[22m

[0m[7m[1m[32m PASS [39m[22m[27m[0m [2mtests/unit/[22m[1memergencyContactModel.test.js[22m
  [1m● [22mConsole

    [2mconsole.log[22m
      Added Emergency Contacts: [ { id: 2, username: 'user1' }, { id: 3, username: 'user2' } ]
[2m[22m
[2m      [2mat log ([22m[2mmodels/emergencyContactModel.js[2m:26:21)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error executing query Error: Database Error[39m
[31m          at _callee2$ (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/emergencyContactModel.test.js:62:17)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/emergencyContactModel.test.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/emergencyContactModel.test.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/emergencyContactModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/emergencyContactModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/emergencyContactModel.test.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/emergencyContactModel.test.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at Object.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/emergencyContactModel.test.js:2:1)[39m
[31m          at Promise.then.completed (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:298:28)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at callAsyncCircusFn (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:231:10)[39m
[31m          at _callCircusTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:316:40)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m          at _runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:252:3)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:126:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at run (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:71:3)[39m
[31m          at runAndTransformResultsToJestFormat (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)[39m
[31m          at jestAdapter (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)[39m
[31m          at runTestInternal (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:367:16)[39m
[31m          at runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:444:34)[39m
[31m          at Object.worker (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/testWorker.js:106:12)[39m
[2m[22m
[2m    [0m [90m 27 |[39m             [36mreturn[39m addedContacts[33m;[39m[22m
[2m     [90m 28 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 29 |[39m             console[33m.[39merror([32m"Error executing query"[39m[33m,[39m err[33m.[39mstack)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 30 |[39m             [36mthrow[39m err[33m;[39m[22m
[2m     [90m 31 |[39m         }[22m
[2m     [90m 32 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/emergencyContactModel.js[2m:29:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/emergencyContactModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/emergencyContactModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/emergencyContactModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/emergencyContactModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/emergencyContactModel.js[2m:2:1)[22m[2m[22m

    [2mconsole.log[22m
      Incoming Pending Emergency Contacts: [ { id: 1, username: 'User1' }, { id: 2, username: 'User2' } ]
[2m[22m
[2m      [2mat log ([22m[2mmodels/emergencyContactModel.js[2m:120:21)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error executing query Error: Database Error[39m
[31m          at _callee4$ (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/emergencyContactModel.test.js:112:17)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/emergencyContactModel.test.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/emergencyContactModel.test.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/emergencyContactModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/emergencyContactModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/emergencyContactModel.test.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/emergencyContactModel.test.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at Object.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/emergencyContactModel.test.js:2:1)[39m
[31m          at Promise.then.completed (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:298:28)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at callAsyncCircusFn (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:231:10)[39m
[31m          at _callCircusTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:316:40)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m          at _runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:252:3)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:126:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at run (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:71:3)[39m
[31m          at runAndTransformResultsToJestFormat (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)[39m
[31m          at jestAdapter (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)[39m
[31m          at runTestInternal (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:367:16)[39m
[31m          at runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:444:34)[39m
[31m          at Object.worker (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/testWorker.js:106:12)[39m
[2m[22m
[2m    [0m [90m 27 |[39m             [36mreturn[39m addedContacts[33m;[39m[22m
[2m     [90m 28 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 29 |[39m             console[33m.[39merror([32m"Error executing query"[39m[33m,[39m err[33m.[39mstack)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 30 |[39m             [36mthrow[39m err[33m;[39m[22m
[2m     [90m 31 |[39m         }[22m
[2m     [90m 32 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/emergencyContactModel.js[2m:29:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/emergencyContactModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/emergencyContactModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/emergencyContactModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/emergencyContactModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/emergencyContactModel.js[2m:2:1)[22m[2m[22m

    [2mconsole.log[22m
      Added Emergency Contacts: [ { id: 1, username: 'user1' } ]
[2m[22m
[2m      [2mat log ([22m[2mmodels/emergencyContactModel.js[2m:26:21)[22m[2m[22m

    [2mconsole.log[22m
      Incoming Pending Emergency Contacts: [ { id: 2, username: 'user2' } ]
[2m[22m
[2m      [2mat log ([22m[2mmodels/emergencyContactModel.js[2m:120:21)[22m[2m[22m

    [2mconsole.log[22m
      Outgoing Pending Emergency Contacts: [ { id: 3, username: 'user3' } ]
[2m[22m
[2m      [2mat log ([22m[2mmodels/emergencyContactModel.js[2m:153:21)[22m[2m[22m

    [2mconsole.log[22m
      incomingPendingContacts [ { id: 2, username: 'user2' } ]
[2m[22m
[2m      [2mat log ([22m[2mmodels/emergencyContactModel.js[2m:72:21)[22m[2m[22m

    [2mconsole.log[22m
      outgoingPendingContacts [ { id: 3, username: 'user3' } ]
[2m[22m
[2m      [2mat log ([22m[2mmodels/emergencyContactModel.js[2m:73:21)[22m[2m[22m

    [2mconsole.log[22m
      Unadded Users: []
[2m[22m
[2m      [2mat log ([22m[2mmodels/emergencyContactModel.js[2m:89:21)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error executing query Error: Database Error[39m
[31m          at _callee6$ (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/emergencyContactModel.test.js:173:17)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/emergencyContactModel.test.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/emergencyContactModel.test.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/emergencyContactModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/emergencyContactModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/emergencyContactModel.test.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/emergencyContactModel.test.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at Object.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/emergencyContactModel.test.js:2:1)[39m
[31m          at Promise.then.completed (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:298:28)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at callAsyncCircusFn (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:231:10)[39m
[31m          at _callCircusTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:316:40)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m          at _runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:252:3)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:126:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at run (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:71:3)[39m
[31m          at runAndTransformResultsToJestFormat (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)[39m
[31m          at jestAdapter (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)[39m
[31m          at runTestInternal (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:367:16)[39m
[31m          at runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:444:34)[39m
[31m          at Object.worker (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/testWorker.js:106:12)[39m
[2m[22m
[2m    [0m [90m 91 |[39m             [36mreturn[39m unaddedUsers[33m;[39m[22m
[2m     [90m 92 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 93 |[39m             console[33m.[39merror([32m"Error executing query"[39m[33m,[39m err[33m.[39mstack)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 94 |[39m             [36mthrow[39m err[33m;[39m[22m
[2m     [90m 95 |[39m         }[22m
[2m     [90m 96 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/emergencyContactModel.js[2m:93:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/emergencyContactModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/emergencyContactModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/emergencyContactModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/emergencyContactModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/emergencyContactModel.js[2m:2:1)[22m[2m[22m

    [2mconsole.log[22m
      Owner ID: 1
[2m[22m
[2m      [2mat log ([22m[2mmodels/emergencyContactModel.js[2m:188:21)[22m[2m[22m

    [2mconsole.log[22m
      Contact ID: 2
[2m[22m
[2m      [2mat log ([22m[2mmodels/emergencyContactModel.js[2m:208:21)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error executing query Error: User with username testUser not found[39m
[31m          at _callee5$ (/Users/shangchienliu/Desktop/f24-fse-sb2/models/emergencyContactModel.js:183:23)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/emergencyContactModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/emergencyContactModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/emergencyContactModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/emergencyContactModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/emergencyContactModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[2m[22m
[2m    [0m [90m 218 |[39m             [36mreturn[39m results[33m;[39m[22m
[2m     [90m 219 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 220 |[39m             console[33m.[39merror([32m"Error executing query"[39m[33m,[39m err[33m.[39mstack)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 221 |[39m             [36mthrow[39m err[33m;[39m[22m
[2m     [90m 222 |[39m         }[22m
[2m     [90m 223 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/emergencyContactModel.js[2m:220:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/emergencyContactModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/emergencyContactModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mmodels/emergencyContactModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/emergencyContactModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/emergencyContactModel.js[2m:2:1)[22m[2m[22m

    [2mconsole.log[22m
      Owner ID: 1
[2m[22m
[2m      [2mat log ([22m[2mmodels/emergencyContactModel.js[2m:188:21)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error executing query Error: User with username user1 not found[39m
[31m          at _callee5$ (/Users/shangchienliu/Desktop/f24-fse-sb2/models/emergencyContactModel.js:203:23)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/emergencyContactModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/emergencyContactModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/emergencyContactModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/emergencyContactModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/emergencyContactModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[2m[22m
[2m    [0m [90m 218 |[39m             [36mreturn[39m results[33m;[39m[22m
[2m     [90m 219 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 220 |[39m             console[33m.[39merror([32m"Error executing query"[39m[33m,[39m err[33m.[39mstack)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 221 |[39m             [36mthrow[39m err[33m;[39m[22m
[2m     [90m 222 |[39m         }[22m
[2m     [90m 223 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/emergencyContactModel.js[2m:220:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/emergencyContactModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/emergencyContactModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mmodels/emergencyContactModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/emergencyContactModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/emergencyContactModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error executing query Error: Database Error[39m
[31m          at _callee10$ (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/emergencyContactModel.test.js:280:17)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/emergencyContactModel.test.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/emergencyContactModel.test.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/emergencyContactModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/emergencyContactModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/emergencyContactModel.test.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/emergencyContactModel.test.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at Object.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/emergencyContactModel.test.js:2:1)[39m
[31m          at Promise.then.completed (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:298:28)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at callAsyncCircusFn (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:231:10)[39m
[31m          at _callCircusTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:316:40)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m          at _runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:252:3)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:126:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at run (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:71:3)[39m
[31m          at runAndTransformResultsToJestFormat (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)[39m
[31m          at jestAdapter (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)[39m
[31m          at runTestInternal (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:367:16)[39m
[31m          at runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:444:34)[39m
[31m          at Object.worker (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/testWorker.js:106:12)[39m
[2m[22m
[2m    [0m [90m 218 |[39m             [36mreturn[39m results[33m;[39m[22m
[2m     [90m 219 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 220 |[39m             console[33m.[39merror([32m"Error executing query"[39m[33m,[39m err[33m.[39mstack)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 221 |[39m             [36mthrow[39m err[33m;[39m[22m
[2m     [90m 222 |[39m         }[22m
[2m     [90m 223 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/emergencyContactModel.js[2m:220:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/emergencyContactModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/emergencyContactModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/emergencyContactModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/emergencyContactModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/emergencyContactModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error executing query Error: Database Error[39m
[31m          at _callee12$ (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/emergencyContactModel.test.js:318:17)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/emergencyContactModel.test.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/emergencyContactModel.test.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/emergencyContactModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/emergencyContactModel.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/emergencyContactModel.test.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/emergencyContactModel.test.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at Object.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/emergencyContactModel.test.js:2:1)[39m
[31m          at Promise.then.completed (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:298:28)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at callAsyncCircusFn (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:231:10)[39m
[31m          at _callCircusTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:316:40)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m          at _runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:252:3)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:126:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at run (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:71:3)[39m
[31m          at runAndTransformResultsToJestFormat (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)[39m
[31m          at jestAdapter (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)[39m
[31m          at runTestInternal (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:367:16)[39m
[31m          at runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:444:34)[39m
[31m          at Object.worker (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/testWorker.js:106:12)[39m
[2m[22m
[2m    [0m [90m 323 |[39m             [36mreturn[39m resources[33m;[39m[22m
[2m     [90m 324 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 325 |[39m             console[33m.[39merror([32m"Error executing query"[39m[33m,[39m err[33m.[39mstack)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 326 |[39m             [36mthrow[39m err[33m;[39m[22m
[2m     [90m 327 |[39m         }[22m
[2m     [90m 328 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/emergencyContactModel.js[2m:325:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/emergencyContactModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/emergencyContactModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/emergencyContactModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/emergencyContactModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/emergencyContactModel.js[2m:2:1)[22m[2m[22m

[0m[7m[1m[32m PASS [39m[22m[27m[0m [2mtests/unit/[22m[1mdbConfig.test.js[22m
[0m[7m[1m[32m PASS [39m[22m[27m[0m [2mtests/unit/[22m[1mauthMiddleware.test.js[22m
  [1m● [22mConsole

    [2mconsole.log[22m
      Token verified successfully, proceeding to next.
[2m[22m
[2m      [2mat log ([22m[2mmiddlewares/authMiddleware.js[2m:43:17)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Token is missing in auth middleware[39m
[2m[22m
[2m    [0m [90m 24 |[39m     [90m// If token is still not found, return an error[39m[22m
[2m     [90m 25 |[39m     [36mif[39m ([33m![39mtoken) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 26 |[39m         console[33m.[39merror([32m"Token is missing in auth middleware"[39m)[33m;[39m[22m
[2m     [90m    |[39m                 [31m[1m^[22m[2m[39m[22m
[2m     [90m 27 |[39m         [36mreturn[39m res[22m
[2m     [90m 28 |[39m             [33m.[39mstatus([35m401[39m)[22m
[2m     [90m 29 |[39m             [33m.[39mrender([32m"error"[39m[33m,[39m { message[33m:[39m [32m"Access denied, token missing!"[39m })[33m;[39m[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmiddlewares/authMiddleware.js[2m:26:17)[22m[2m[22m
[2m      [2mat Object.<anonymous> ([22m[2m[0m[36mtests/unit/authMiddleware.test.js[39m[0m[2m:39:23)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Token is invalid or expired: Error: Invalid token[39m
[31m          at Object.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/authMiddleware.test.js:49:22)[39m
[31m          at /Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-mock/build/index.js:397:39[39m
[31m          at Object.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-mock/build/index.js:404:13)[39m
[31m          at Object.mockConstructor [as verify] (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-mock/build/index.js:148:19)[39m
[31m          at verify (/Users/shangchienliu/Desktop/f24-fse-sb2/middlewares/authMiddleware.js:33:9)[39m
[31m          at Object.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/authMiddleware.test.js:52:23)[39m
[31m          at Promise.then.completed (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:298:28)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at callAsyncCircusFn (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:231:10)[39m
[31m          at _callCircusTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:316:40)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m          at _runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:252:3)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:126:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at run (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:71:3)[39m
[31m          at runAndTransformResultsToJestFormat (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)[39m
[31m          at jestAdapter (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)[39m
[31m          at runTestInternal (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:367:16)[39m
[31m          at runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:444:34)[39m
[31m          at Object.worker (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/testWorker.js:106:12)[39m
[2m[22m
[2m    [0m [90m 33 |[39m     jwt[33m.[39mverify(token[33m,[39m [33mJWT_SECRET[39m[33m,[39m (err[33m,[39m user) [33m=>[39m {[22m
[2m     [90m 34 |[39m         [36mif[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 35 |[39m             console[33m.[39merror([32m"Token is invalid or expired:"[39m[33m,[39m err)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 36 |[39m             [36mreturn[39m res[22m
[2m     [90m 37 |[39m                 [33m.[39mstatus([35m403[39m)[22m
[2m     [90m 38 |[39m                 [33m.[39mrender([32m"error"[39m[33m,[39m { message[33m:[39m [32m"Invalid or expired token!"[39m })[33m;[39m[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmiddlewares/authMiddleware.js[2m:35:21)[22m[2m[22m
[2m      [2mat Object.callback ([22m[2m[0m[36mtests/unit/authMiddleware.test.js[39m[0m[2m:49:13)[22m[2m[22m
[2m      [2mat verify ([22m[2mmiddlewares/authMiddleware.js[2m:33:9)[22m[2m[22m
[2m      [2mat Object.<anonymous> ([22m[2m[0m[36mtests/unit/authMiddleware.test.js[39m[0m[2m:52:23)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Token is invalid or expired: Error: TokenExpiredError[39m
[31m          at Object.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/authMiddleware.test.js:63:22)[39m
[31m          at /Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-mock/build/index.js:397:39[39m
[31m          at Object.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-mock/build/index.js:404:13)[39m
[31m          at Object.mockConstructor [as verify] (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-mock/build/index.js:148:19)[39m
[31m          at verify (/Users/shangchienliu/Desktop/f24-fse-sb2/middlewares/authMiddleware.js:33:9)[39m
[31m          at Object.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/unit/authMiddleware.test.js:66:23)[39m
[31m          at Promise.then.completed (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:298:28)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at callAsyncCircusFn (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:231:10)[39m
[31m          at _callCircusTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:316:40)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m          at _runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:252:3)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:126:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at run (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:71:3)[39m
[31m          at runAndTransformResultsToJestFormat (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)[39m
[31m          at jestAdapter (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)[39m
[31m          at runTestInternal (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:367:16)[39m
[31m          at runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:444:34)[39m
[31m          at Object.worker (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/testWorker.js:106:12)[39m
[2m[22m
[2m    [0m [90m 33 |[39m     jwt[33m.[39mverify(token[33m,[39m [33mJWT_SECRET[39m[33m,[39m (err[33m,[39m user) [33m=>[39m {[22m
[2m     [90m 34 |[39m         [36mif[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 35 |[39m             console[33m.[39merror([32m"Token is invalid or expired:"[39m[33m,[39m err)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 36 |[39m             [36mreturn[39m res[22m
[2m     [90m 37 |[39m                 [33m.[39mstatus([35m403[39m)[22m
[2m     [90m 38 |[39m                 [33m.[39mrender([32m"error"[39m[33m,[39m { message[33m:[39m [32m"Invalid or expired token!"[39m })[33m;[39m[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmiddlewares/authMiddleware.js[2m:35:21)[22m[2m[22m
[2m      [2mat Object.callback ([22m[2m[0m[36mtests/unit/authMiddleware.test.js[39m[0m[2m:63:13)[22m[2m[22m
[2m      [2mat verify ([22m[2mmiddlewares/authMiddleware.js[2m:33:9)[22m[2m[22m
[2m      [2mat Object.<anonymous> ([22m[2m[0m[36mtests/unit/authMiddleware.test.js[39m[0m[2m:66:23)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Token is missing in auth middleware[39m
[2m[22m
[2m    [0m [90m 24 |[39m     [90m// If token is still not found, return an error[39m[22m
[2m     [90m 25 |[39m     [36mif[39m ([33m![39mtoken) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 26 |[39m         console[33m.[39merror([32m"Token is missing in auth middleware"[39m)[33m;[39m[22m
[2m     [90m    |[39m                 [31m[1m^[22m[2m[39m[22m
[2m     [90m 27 |[39m         [36mreturn[39m res[22m
[2m     [90m 28 |[39m             [33m.[39mstatus([35m401[39m)[22m
[2m     [90m 29 |[39m             [33m.[39mrender([32m"error"[39m[33m,[39m { message[33m:[39m [32m"Access denied, token missing!"[39m })[33m;[39m[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmiddlewares/authMiddleware.js[2m:26:17)[22m[2m[22m
[2m      [2mat Object.<anonymous> ([22m[2m[0m[36mtests/unit/authMiddleware.test.js[39m[0m[2m:77:23)[22m[2m[22m

[0m[7m[1m[32m PASS [39m[22m[27m[0m [2mtests/unit/[22m[1mresourceManagement.test.js[22m
[0m[7m[1m[32m PASS [39m[22m[27m[0m [2mtests/unit/[22m[1mvalidation.test.js[22m
[0m[7m[1m[32m PASS [39m[22m[27m[0m [2mtests/unit/[22m[1msearchRules.test.js[22m
[0m[7m[1m[32m PASS [39m[22m[27m[0m [2mtests/unit/[22m[1mstopwords.test.js[22m
[0m[7m[1m[31m FAIL [39m[22m[27m[0m [2mtests/integration/[22m[1mmessageController.test.js[22m ([0m[1m[41m7.466 s[49m[22m[0m)
  [1m● [22mConsole

    [2mconsole.log[22m
      SSH connection established.
[2m[22m
[2m      [2mat Client.log ([22m[2mconfigurations/mysqlDatabase.js[2m:180:25)[22m[2m[22m

    [2mconsole.log[22m
      Connected to database: sb2-test
[2m[22m
[2m      [2mat log ([22m[2mconfigurations/dbConfig.js[2m:62:17)[22m[2m[22m

    [2mconsole.log[22m
      Connected to database in setDatabaseconnection: sb2
[2m[22m
[2m      [2mat log ([22m[2mconfigurations/dbConfig.js[2m:31:17)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error executing query Error: Unknown column 'account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:37:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[2m[22m
[2m    [0m [90m 51 |[39m             }[33m;[39m[22m
[2m     [90m 52 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 53 |[39m             console[33m.[39merror([32m"Error executing query"[39m[33m,[39m err[33m.[39mstack)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 54 |[39m             [36mthrow[39m err[33m;[39m[22m
[2m     [90m 55 |[39m         }[22m
[2m     [90m 56 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/userModel.js[2m:53:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error sending private message: Unknown column 'account_status' in 'where clause'[39m
[2m[22m
[2m    [0m [90m 155 |[39m             })[33m;[39m[22m
[2m     [90m 156 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 157 |[39m             console[33m.[39merror([32m"Error sending private message:"[39m[33m,[39m error[33m.[39mmessage)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 158 |[39m             res[33m.[39mstatus([35m500[39m)[33m.[39mjson({[22m
[2m     [90m 159 |[39m                 message[33m:[39m [32m"Error sending private message"[39m[33m,[39m[22m
[2m     [90m 160 |[39m                 error[33m:[39m error[33m.[39mmessage[33m,[39m[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/messageController.js[2m:157:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error executing query Error: Unknown column 'account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:37:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[2m[22m
[2m    [0m [90m 51 |[39m             }[33m;[39m[22m
[2m     [90m 52 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 53 |[39m             console[33m.[39merror([32m"Error executing query"[39m[33m,[39m err[33m.[39mstack)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 54 |[39m             [36mthrow[39m err[33m;[39m[22m
[2m     [90m 55 |[39m         }[22m
[2m     [90m 56 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/userModel.js[2m:53:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error sending private message: Unknown column 'account_status' in 'where clause'[39m
[2m[22m
[2m    [0m [90m 155 |[39m             })[33m;[39m[22m
[2m     [90m 156 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 157 |[39m             console[33m.[39merror([32m"Error sending private message:"[39m[33m,[39m error[33m.[39mmessage)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 158 |[39m             res[33m.[39mstatus([35m500[39m)[33m.[39mjson({[22m
[2m     [90m 159 |[39m                 message[33m:[39m [32m"Error sending private message"[39m[33m,[39m[22m
[2m     [90m 160 |[39m                 error[33m:[39m error[33m.[39mmessage[33m,[39m[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/messageController.js[2m:157:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error executing query Error: Unknown column 'account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:37:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[2m[22m
[2m    [0m [90m 51 |[39m             }[33m;[39m[22m
[2m     [90m 52 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 53 |[39m             console[33m.[39merror([32m"Error executing query"[39m[33m,[39m err[33m.[39mstack)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 54 |[39m             [36mthrow[39m err[33m;[39m[22m
[2m     [90m 55 |[39m         }[22m
[2m     [90m 56 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/userModel.js[2m:53:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching private messages: Unknown column 'account_status' in 'where clause'[39m
[2m[22m
[2m    [0m [90m 194 |[39m             res[33m.[39mstatus([35m200[39m)[33m.[39mjson(messages)[33m;[39m[22m
[2m     [90m 195 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 196 |[39m             console[33m.[39merror([32m"Error fetching private messages:"[39m[33m,[39m error[33m.[39mmessage)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 197 |[39m             res[33m.[39mstatus([35m500[39m)[33m.[39mjson({[22m
[2m     [90m 198 |[39m                 message[33m:[39m [32m"Error fetching private messages"[39m[33m,[39m[22m
[2m     [90m 199 |[39m                 error[33m:[39m error[33m.[39mmessage[33m,[39m[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/messageController.js[2m:196:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error executing query Error: Unknown column 'account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:37:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[2m[22m
[2m    [0m [90m 51 |[39m             }[33m;[39m[22m
[2m     [90m 52 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 53 |[39m             console[33m.[39merror([32m"Error executing query"[39m[33m,[39m err[33m.[39mstack)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 54 |[39m             [36mthrow[39m err[33m;[39m[22m
[2m     [90m 55 |[39m         }[22m
[2m     [90m 56 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/userModel.js[2m:53:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching private messages: Unknown column 'account_status' in 'where clause'[39m
[2m[22m
[2m    [0m [90m 194 |[39m             res[33m.[39mstatus([35m200[39m)[33m.[39mjson(messages)[33m;[39m[22m
[2m     [90m 195 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 196 |[39m             console[33m.[39merror([32m"Error fetching private messages:"[39m[33m,[39m error[33m.[39mmessage)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 197 |[39m             res[33m.[39mstatus([35m500[39m)[33m.[39mjson({[22m
[2m     [90m 198 |[39m                 message[33m:[39m [32m"Error fetching private messages"[39m[33m,[39m[22m
[2m     [90m 199 |[39m                 error[33m:[39m error[33m.[39mmessage[33m,[39m[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/messageController.js[2m:196:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error executing query Error: Unknown column 'account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:37:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[2m[22m
[2m    [0m [90m 51 |[39m             }[33m;[39m[22m
[2m     [90m 52 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 53 |[39m             console[33m.[39merror([32m"Error executing query"[39m[33m,[39m err[33m.[39mstack)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 54 |[39m             [36mthrow[39m err[33m;[39m[22m
[2m     [90m 55 |[39m         }[22m
[2m     [90m 56 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/userModel.js[2m:53:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching private messages: Unknown column 'account_status' in 'where clause'[39m
[2m[22m
[2m    [0m [90m 194 |[39m             res[33m.[39mstatus([35m200[39m)[33m.[39mjson(messages)[33m;[39m[22m
[2m     [90m 195 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 196 |[39m             console[33m.[39merror([32m"Error fetching private messages:"[39m[33m,[39m error[33m.[39mmessage)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 197 |[39m             res[33m.[39mstatus([35m500[39m)[33m.[39mjson({[22m
[2m     [90m 198 |[39m                 message[33m:[39m [32m"Error fetching private messages"[39m[33m,[39m[22m
[2m     [90m 199 |[39m                 error[33m:[39m error[33m.[39mmessage[33m,[39m[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/messageController.js[2m:196:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m

    [2mconsole.log[22m
      Controller: recipient: testA sender: testB
[2m[22m
[2m      [2mat log ([22m[2mcontrollers/messageController.js[2m:226:17)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error executing query Error: Unknown column 'account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:37:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[2m[22m
[2m    [0m [90m 51 |[39m             }[33m;[39m[22m
[2m     [90m 52 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 53 |[39m             console[33m.[39merror([32m"Error executing query"[39m[33m,[39m err[33m.[39mstack)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 54 |[39m             [36mthrow[39m err[33m;[39m[22m
[2m     [90m 55 |[39m         }[22m
[2m     [90m 56 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/userModel.js[2m:53:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching unread messages: Unknown column 'account_status' in 'where clause'[39m
[2m[22m
[2m    [0m [90m 252 |[39m             res[33m.[39mstatus([35m200[39m)[33m.[39mjson(unreadMessages)[33m;[39m[22m
[2m     [90m 253 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 254 |[39m             console[33m.[39merror([32m"Error fetching unread messages:"[39m[33m,[39m error[33m.[39mmessage)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 255 |[39m             res[33m.[39mstatus([35m500[39m)[33m.[39mjson({[22m
[2m     [90m 256 |[39m                 message[33m:[39m [32m"Error fetching unread messages"[39m[33m,[39m[22m
[2m     [90m 257 |[39m                 error[33m:[39m error[33m.[39mmessage[33m,[39m[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/messageController.js[2m:254:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m

    [2mconsole.log[22m
      Controller: recipient: testA sender: testB
[2m[22m
[2m      [2mat log ([22m[2mcontrollers/messageController.js[2m:226:17)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error executing query Error: Unknown column 'account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:37:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[2m[22m
[2m    [0m [90m 51 |[39m             }[33m;[39m[22m
[2m     [90m 52 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 53 |[39m             console[33m.[39merror([32m"Error executing query"[39m[33m,[39m err[33m.[39mstack)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 54 |[39m             [36mthrow[39m err[33m;[39m[22m
[2m     [90m 55 |[39m         }[22m
[2m     [90m 56 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/userModel.js[2m:53:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching unread messages: Unknown column 'account_status' in 'where clause'[39m
[2m[22m
[2m    [0m [90m 252 |[39m             res[33m.[39mstatus([35m200[39m)[33m.[39mjson(unreadMessages)[33m;[39m[22m
[2m     [90m 253 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 254 |[39m             console[33m.[39merror([32m"Error fetching unread messages:"[39m[33m,[39m error[33m.[39mmessage)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 255 |[39m             res[33m.[39mstatus([35m500[39m)[33m.[39mjson({[22m
[2m     [90m 256 |[39m                 message[33m:[39m [32m"Error fetching unread messages"[39m[33m,[39m[22m
[2m     [90m 257 |[39m                 error[33m:[39m error[33m.[39mmessage[33m,[39m[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/messageController.js[2m:254:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m

    [2mconsole.log[22m
      Controller: recipient: nonExistentUser sender: testB
[2m[22m
[2m      [2mat log ([22m[2mcontrollers/messageController.js[2m:226:17)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error executing query Error: Unknown column 'account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:37:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[2m[22m
[2m    [0m [90m 51 |[39m             }[33m;[39m[22m
[2m     [90m 52 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 53 |[39m             console[33m.[39merror([32m"Error executing query"[39m[33m,[39m err[33m.[39mstack)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 54 |[39m             [36mthrow[39m err[33m;[39m[22m
[2m     [90m 55 |[39m         }[22m
[2m     [90m 56 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/userModel.js[2m:53:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching unread messages: Unknown column 'account_status' in 'where clause'[39m
[2m[22m
[2m    [0m [90m 252 |[39m             res[33m.[39mstatus([35m200[39m)[33m.[39mjson(unreadMessages)[33m;[39m[22m
[2m     [90m 253 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 254 |[39m             console[33m.[39merror([32m"Error fetching unread messages:"[39m[33m,[39m error[33m.[39mmessage)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 255 |[39m             res[33m.[39mstatus([35m500[39m)[33m.[39mjson({[22m
[2m     [90m 256 |[39m                 message[33m:[39m [32m"Error fetching unread messages"[39m[33m,[39m[22m
[2m     [90m 257 |[39m                 error[33m:[39m error[33m.[39mmessage[33m,[39m[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/messageController.js[2m:254:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error executing query Error: Unknown column 'account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:37:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[2m[22m
[2m    [0m [90m 51 |[39m             }[33m;[39m[22m
[2m     [90m 52 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 53 |[39m             console[33m.[39merror([32m"Error executing query"[39m[33m,[39m err[33m.[39mstack)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 54 |[39m             [36mthrow[39m err[33m;[39m[22m
[2m     [90m 55 |[39m         }[22m
[2m     [90m 56 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/userModel.js[2m:53:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error marking messages as read: Unknown column 'account_status' in 'where clause'[39m
[2m[22m
[2m    [0m [90m 290 |[39m             })[33m;[39m[22m
[2m     [90m 291 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 292 |[39m             console[33m.[39merror([32m"Error marking messages as read:"[39m[33m,[39m error[33m.[39mmessage)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 293 |[39m             res[33m.[39mstatus([35m500[39m)[33m.[39mjson({[22m
[2m     [90m 294 |[39m                 message[33m:[39m [32m"Error marking messages as read"[39m[33m,[39m[22m
[2m     [90m 295 |[39m                 error[33m:[39m error[33m.[39mmessage[33m,[39m[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/messageController.js[2m:292:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error executing query Error: Unknown column 'account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:37:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[2m[22m
[2m    [0m [90m 51 |[39m             }[33m;[39m[22m
[2m     [90m 52 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 53 |[39m             console[33m.[39merror([32m"Error executing query"[39m[33m,[39m err[33m.[39mstack)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 54 |[39m             [36mthrow[39m err[33m;[39m[22m
[2m     [90m 55 |[39m         }[22m
[2m     [90m 56 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/userModel.js[2m:53:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error marking messages as read: Unknown column 'account_status' in 'where clause'[39m
[2m[22m
[2m    [0m [90m 290 |[39m             })[33m;[39m[22m
[2m     [90m 291 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 292 |[39m             console[33m.[39merror([32m"Error marking messages as read:"[39m[33m,[39m error[33m.[39mmessage)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 293 |[39m             res[33m.[39mstatus([35m500[39m)[33m.[39mjson({[22m
[2m     [90m 294 |[39m                 message[33m:[39m [32m"Error marking messages as read"[39m[33m,[39m[22m
[2m     [90m 295 |[39m                 error[33m:[39m error[33m.[39mmessage[33m,[39m[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/messageController.js[2m:292:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/messageController.js[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mMessageController Integration Test › sendPrivateMessage › should send multiple private messages from testA to testB[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 68 |[39m[22m
[2m     [90m 69 |[39m                 [90m// Verify the response[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 70 |[39m                 expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m    |[39m                                    [31m[1m^[22m[2m[39m[22m
[2m     [90m 71 |[39m                 expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39mobjectContaining({[22m
[2m     [90m 72 |[39m                     message[33m:[39m [32m'Private message sent successfully'[39m[33m,[39m[22m
[2m     [90m 73 |[39m                     result[33m:[39m expect[33m.[39many([33mObject[39m)[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:70:36)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mMessageController Integration Test › Negative Test Cases › should fail when sending a message to a non-existent recipient[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m404[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 109 |[39m[22m
[2m     [90m 110 |[39m             [90m// Verify the response[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 111 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m404[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 112 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39mobjectContaining({[22m
[2m     [90m 113 |[39m                 error[33m:[39m [32m'Sender or recipient not found.'[39m[22m
[2m     [90m 114 |[39m             }))[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:111:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mMessageController Integration Test › getPrivateMessages › should retrieve private messages between testA and testB[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 201 |[39m[22m
[2m     [90m 202 |[39m             [90m// Verify the response[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 203 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 204 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39many([33mArray[39m))[33m;[39m[22m
[2m     [90m 205 |[39m[22m
[2m     [90m 206 |[39m             [90m// Verify that the messages include the ones we sent earlier[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:203:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mMessageController Integration Test › Negative Test Cases › should return an empty array when there are no messages between users[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 238 |[39m[22m
[2m     [90m 239 |[39m             [90m// Verify the response[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 240 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 241 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith([])[33m;[39m[22m
[2m     [90m 242 |[39m         })[33m;[39m[22m
[2m     [90m 243 |[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:240:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mMessageController Integration Test › Negative Test Cases › should fail when recipient does not exist[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m404[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 258 |[39m[22m
[2m     [90m 259 |[39m             [90m// Verify the response[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 260 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m404[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 261 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39mobjectContaining({[22m
[2m     [90m 262 |[39m                 error[33m:[39m [32m'Sender or recipient not found.'[39m[22m
[2m     [90m 263 |[39m             }))[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:260:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mMessageController Integration Test › getUnreadMessages › should retrieve unread messages from testA to testB[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 290 |[39m[22m
[2m     [90m 291 |[39m             [90m// Verify the response[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 292 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 293 |[39m             [36mconst[39m unreadMessages [33m=[39m res[33m.[39mjson[33m.[39mmock[33m.[39mcalls[[35m0[39m][[35m0[39m][33m;[39m[22m
[2m     [90m 294 |[39m             expect([33mArray[39m[33m.[39misArray(unreadMessages))[33m.[39mtoBe([36mtrue[39m)[33m;[39m[22m
[2m     [90m 295 |[39m             expect(unreadMessages[33m.[39mlength)[33m.[39mtoBeGreaterThan([35m0[39m)[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:292:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mMessageController Integration Test › Negative Test Cases › should return an empty array when there are no unread messages[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 330 |[39m[22m
[2m     [90m 331 |[39m             [90m// Verify the response[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 332 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 333 |[39m             [36mconst[39m unreadMessages [33m=[39m res[33m.[39mjson[33m.[39mmock[33m.[39mcalls[[35m0[39m][[35m0[39m][33m;[39m[22m
[2m     [90m 334 |[39m             expect([33mArray[39m[33m.[39misArray(unreadMessages))[33m.[39mtoBe([36mtrue[39m)[33m;[39m[22m
[2m     [90m 335 |[39m             expect(unreadMessages[33m.[39mlength)[33m.[39mtoBe([35m0[39m)[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:332:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mMessageController Integration Test › Negative Test Cases › should fail when recipient does not exist[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m404[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 351 |[39m[22m
[2m     [90m 352 |[39m             [90m// Verify the response[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 353 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m404[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 354 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39mobjectContaining({[22m
[2m     [90m 355 |[39m                 error[33m:[39m [32m'Sender or recipient not found.'[39m[22m
[2m     [90m 356 |[39m             }))[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:353:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mMessageController Integration Test › markMessagesAsRead › should mark messages as read between testA and testB[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 383 |[39m[22m
[2m     [90m 384 |[39m             [90m// Verify the response[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 385 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 386 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39mobjectContaining({[22m
[2m     [90m 387 |[39m                 message[33m:[39m [32m'Messages marked as read'[39m[33m,[39m[22m
[2m     [90m 388 |[39m                 result[33m:[39m expect[33m.[39many([33mObject[39m)[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:385:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mMessageController Integration Test › Negative Test Cases › should fail when recipient does not exist[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m404[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 415 |[39m[22m
[2m     [90m 416 |[39m             [90m// Verify the response[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 417 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m404[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 418 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39mobjectContaining({[22m
[2m     [90m 419 |[39m                 error[33m:[39m [32m'Recipient or user not found'[39m[22m
[2m     [90m 420 |[39m             }))[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:417:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[0m[7m[1m[31m FAIL [39m[22m[27m[0m [2mtests/integration/[22m[1mresourceController.test.js[22m ([0m[1m[41m7.573 s[49m[22m[0m)
  [1m● [22mConsole

    [2mconsole.log[22m
      SSH connection established.
[2m[22m
[2m      [2mat Client.log ([22m[2mconfigurations/mysqlDatabase.js[2m:180:25)[22m[2m[22m

    [2mconsole.log[22m
      Connected to database: sb2-test
[2m[22m
[2m      [2mat log ([22m[2mconfigurations/dbConfig.js[2m:62:17)[22m[2m[22m

    [2mconsole.log[22m
      Connected to database in setDatabaseconnection: sb2
[2m[22m
[2m      [2mat log ([22m[2mconfigurations/dbConfig.js[2m:31:17)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error executing query Error: Unknown column 'u.account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:25:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[2m[22m
[2m    [0m [90m 32 |[39m             [36mreturn[39m rows[[35m0[39m][33m;[39m[22m
[2m     [90m 33 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 34 |[39m             console[33m.[39merror([32m"Error executing query"[39m[33m,[39m err[33m.[39mstack)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 35 |[39m             [36mthrow[39m err[33m;[39m[22m
[2m     [90m 36 |[39m         }[22m
[2m     [90m 37 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/resourceModel.js[2m:34:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/resourceModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/resourceModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/resourceModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/resourceModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/resourceModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching user resources: Error: Unknown column 'u.account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:25:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5) {[39m
[31m        code: 'ER_BAD_FIELD_ERROR',[39m
[31m        errno: 1054,[39m
[31m        sql: '\n' +[39m
[31m          '            SELECT rm.*\n' +[39m
[31m          '            FROM resource_management rm\n' +[39m
[31m          '            JOIN user u ON rm.user_id = u.id\n' +[39m
[31m          '            WHERE u.user_name = ?\n' +[39m
[31m          "            AND u.account_status = 'active';\n" +[39m
[31m          '            ',[39m
[31m        sqlState: '42S22',[39m
[31m        sqlMessage: "Unknown column 'u.account_status' in 'where clause'"[39m
[31m      }[39m
[2m[22m
[2m    [0m [90m 26 |[39m             [36mreturn[39m res[33m.[39mstatus([35m200[39m)[33m.[39mjson(resources)[33m;[39m[22m
[2m     [90m 27 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 28 |[39m             console[33m.[39merror([32m"Error fetching user resources:"[39m[33m,[39m err)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 29 |[39m             [36mreturn[39m res[33m.[39mstatus([35m500[39m)[33m.[39mjson({ message[33m:[39m [32m"Internal Server Error"[39m })[33m;[39m[22m
[2m     [90m 30 |[39m         }[22m
[2m     [90m 31 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/resourceController.js[2m:28:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/resourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/resourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/resourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/resourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/resourceController.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error executing query Error: Unknown column 'u.account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:25:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[2m[22m
[2m    [0m [90m 32 |[39m             [36mreturn[39m rows[[35m0[39m][33m;[39m[22m
[2m     [90m 33 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 34 |[39m             console[33m.[39merror([32m"Error executing query"[39m[33m,[39m err[33m.[39mstack)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 35 |[39m             [36mthrow[39m err[33m;[39m[22m
[2m     [90m 36 |[39m         }[22m
[2m     [90m 37 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/resourceModel.js[2m:34:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/resourceModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/resourceModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/resourceModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/resourceModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/resourceModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching user resources: Error: Unknown column 'u.account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:25:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5) {[39m
[31m        code: 'ER_BAD_FIELD_ERROR',[39m
[31m        errno: 1054,[39m
[31m        sql: '\n' +[39m
[31m          '            SELECT rm.*\n' +[39m
[31m          '            FROM resource_management rm\n' +[39m
[31m          '            JOIN user u ON rm.user_id = u.id\n' +[39m
[31m          '            WHERE u.user_name = ?\n' +[39m
[31m          "            AND u.account_status = 'active';\n" +[39m
[31m          '            ',[39m
[31m        sqlState: '42S22',[39m
[31m        sqlMessage: "Unknown column 'u.account_status' in 'where clause'"[39m
[31m      }[39m
[2m[22m
[2m    [0m [90m 26 |[39m             [36mreturn[39m res[33m.[39mstatus([35m200[39m)[33m.[39mjson(resources)[33m;[39m[22m
[2m     [90m 27 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 28 |[39m             console[33m.[39merror([32m"Error fetching user resources:"[39m[33m,[39m err)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 29 |[39m             [36mreturn[39m res[33m.[39mstatus([35m500[39m)[33m.[39mjson({ message[33m:[39m [32m"Internal Server Error"[39m })[33m;[39m[22m
[2m     [90m 30 |[39m         }[22m
[2m     [90m 31 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/resourceController.js[2m:28:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/resourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/resourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/resourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/resourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/resourceController.js[2m:2:1)[22m[2m[22m

    [2mconsole.log[22m
      No resource profile found for username: nonexistentuser
[2m[22m
[2m      [2mat log ([22m[2mmodels/resourceModel.js[2m:115:25)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error executing query Error: Unknown column 'u.account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:25:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[2m[22m
[2m    [0m [90m 32 |[39m             [36mreturn[39m rows[[35m0[39m][33m;[39m[22m
[2m     [90m 33 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 34 |[39m             console[33m.[39merror([32m"Error executing query"[39m[33m,[39m err[33m.[39mstack)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 35 |[39m             [36mthrow[39m err[33m;[39m[22m
[2m     [90m 36 |[39m         }[22m
[2m     [90m 37 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/resourceModel.js[2m:34:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/resourceModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/resourceModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/resourceModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/resourceModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/resourceModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error creating resource request: Error: Unknown column 'u.account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:25:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5) {[39m
[31m        code: 'ER_BAD_FIELD_ERROR',[39m
[31m        errno: 1054,[39m
[31m        sql: '\n' +[39m
[31m          '            SELECT rm.*\n' +[39m
[31m          '            FROM resource_management rm\n' +[39m
[31m          '            JOIN user u ON rm.user_id = u.id\n' +[39m
[31m          '            WHERE u.user_name = ?\n' +[39m
[31m          "            AND u.account_status = 'active';\n" +[39m
[31m          '            ',[39m
[31m        sqlState: '42S22',[39m
[31m        sqlMessage: "Unknown column 'u.account_status' in 'where clause'"[39m
[31m      }[39m
[2m[22m
[2m    [0m [90m 116 |[39m             })[33m;[39m[22m
[2m     [90m 117 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 118 |[39m             console[33m.[39merror([32m"Error creating resource request:"[39m[33m,[39m err)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 119 |[39m             [36mreturn[39m res[33m.[39mstatus([35m500[39m)[33m.[39mjson({ message[33m:[39m [32m"Internal Server Error"[39m })[33m;[39m[22m
[2m     [90m 120 |[39m         }[22m
[2m     [90m 121 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/resourceController.js[2m:118:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/resourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/resourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/resourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/resourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/resourceController.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error executing query Error: Unknown column 'u.account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:25:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[2m[22m
[2m    [0m [90m 32 |[39m             [36mreturn[39m rows[[35m0[39m][33m;[39m[22m
[2m     [90m 33 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 34 |[39m             console[33m.[39merror([32m"Error executing query"[39m[33m,[39m err[33m.[39mstack)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 35 |[39m             [36mthrow[39m err[33m;[39m[22m
[2m     [90m 36 |[39m         }[22m
[2m     [90m 37 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/resourceModel.js[2m:34:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/resourceModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/resourceModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/resourceModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/resourceModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/resourceModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error creating resource request: Error: Unknown column 'u.account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:25:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5) {[39m
[31m        code: 'ER_BAD_FIELD_ERROR',[39m
[31m        errno: 1054,[39m
[31m        sql: '\n' +[39m
[31m          '            SELECT rm.*\n' +[39m
[31m          '            FROM resource_management rm\n' +[39m
[31m          '            JOIN user u ON rm.user_id = u.id\n' +[39m
[31m          '            WHERE u.user_name = ?\n' +[39m
[31m          "            AND u.account_status = 'active';\n" +[39m
[31m          '            ',[39m
[31m        sqlState: '42S22',[39m
[31m        sqlMessage: "Unknown column 'u.account_status' in 'where clause'"[39m
[31m      }[39m
[2m[22m
[2m    [0m [90m 116 |[39m             })[33m;[39m[22m
[2m     [90m 117 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 118 |[39m             console[33m.[39merror([32m"Error creating resource request:"[39m[33m,[39m err)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 119 |[39m             [36mreturn[39m res[33m.[39mstatus([35m500[39m)[33m.[39mjson({ message[33m:[39m [32m"Internal Server Error"[39m })[33m;[39m[22m
[2m     [90m 120 |[39m         }[22m
[2m     [90m 121 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/resourceController.js[2m:118:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/resourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/resourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/resourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/resourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/resourceController.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error executing query Error: Unknown column 'u.account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:25:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[2m[22m
[2m    [0m [90m 32 |[39m             [36mreturn[39m rows[[35m0[39m][33m;[39m[22m
[2m     [90m 33 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 34 |[39m             console[33m.[39merror([32m"Error executing query"[39m[33m,[39m err[33m.[39mstack)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 35 |[39m             [36mthrow[39m err[33m;[39m[22m
[2m     [90m 36 |[39m         }[22m
[2m     [90m 37 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/resourceModel.js[2m:34:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/resourceModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/resourceModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/resourceModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/resourceModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/resourceModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error creating resource request: Error: Unknown column 'u.account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:25:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5) {[39m
[31m        code: 'ER_BAD_FIELD_ERROR',[39m
[31m        errno: 1054,[39m
[31m        sql: '\n' +[39m
[31m          '            SELECT rm.*\n' +[39m
[31m          '            FROM resource_management rm\n' +[39m
[31m          '            JOIN user u ON rm.user_id = u.id\n' +[39m
[31m          '            WHERE u.user_name = ?\n' +[39m
[31m          "            AND u.account_status = 'active';\n" +[39m
[31m          '            ',[39m
[31m        sqlState: '42S22',[39m
[31m        sqlMessage: "Unknown column 'u.account_status' in 'where clause'"[39m
[31m      }[39m
[2m[22m
[2m    [0m [90m 116 |[39m             })[33m;[39m[22m
[2m     [90m 117 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 118 |[39m             console[33m.[39merror([32m"Error creating resource request:"[39m[33m,[39m err)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 119 |[39m             [36mreturn[39m res[33m.[39mstatus([35m500[39m)[33m.[39mjson({ message[33m:[39m [32m"Internal Server Error"[39m })[33m;[39m[22m
[2m     [90m 120 |[39m         }[22m
[2m     [90m 121 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/resourceController.js[2m:118:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/resourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/resourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/resourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/resourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/resourceController.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error retrieving requests by requester username Error: Unknown column 'u_requester.account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceRequestModel.js:90:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceRequestModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceRequestModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceRequestModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceRequestModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceRequestModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[2m[22m
[2m    [0m [90m 91 |[39m             [36mreturn[39m rows[33m;[39m[22m
[2m     [90m 92 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 93 |[39m             console[33m.[39merror([32m"Error retrieving requests by requester username"[39m[33m,[39m err[33m.[39mstack)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 94 |[39m             [36mthrow[39m err[33m;[39m[22m
[2m     [90m 95 |[39m         }[22m
[2m     [90m 96 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/resourceRequestModel.js[2m:93:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/resourceRequestModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/resourceRequestModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/resourceRequestModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/resourceRequestModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/resourceRequestModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error retrieving sent requests: Error: Unknown column 'u_requester.account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceRequestModel.js:90:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceRequestModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceRequestModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceRequestModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceRequestModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceRequestModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5) {[39m
[31m        code: 'ER_BAD_FIELD_ERROR',[39m
[31m        errno: 1054,[39m
[31m        sql: '\n' +[39m
[31m          '                SELECT rr.*\n' +[39m
[31m          '                FROM resource_requests rr\n' +[39m
[31m          '                JOIN user u_requester ON rr.requester_id = u_requester.id\n' +[39m
[31m          '                JOIN user u_requested ON rr.requested_from_id = u_requested.id\n' +[39m
[31m          '                WHERE u_requester.user_name = ?\n' +[39m
[31m          "                AND u_requester.account_status = 'active'\n" +[39m
[31m          "                AND u_requested.account_status = 'active';\n" +[39m
[31m          '            ',[39m
[31m        sqlState: '42S22',[39m
[31m        sqlMessage: "Unknown column 'u_requester.account_status' in 'where clause'"[39m
[31m      }[39m
[2m[22m
[2m    [0m [90m 141 |[39m             [36mreturn[39m res[33m.[39mstatus([35m200[39m)[33m.[39mjson(sentRequests)[33m;[39m[22m
[2m     [90m 142 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 143 |[39m             console[33m.[39merror([32m"Error retrieving sent requests:"[39m[33m,[39m err)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 144 |[39m             [36mreturn[39m res[33m.[39mstatus([35m500[39m)[33m.[39mjson({ message[33m:[39m [32m"Internal Server Error"[39m })[33m;[39m[22m
[2m     [90m 145 |[39m         }[22m
[2m     [90m 146 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/resourceController.js[2m:143:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/resourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/resourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/resourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/resourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/resourceController.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error retrieving requests by requester username Error: Unknown column 'u_requester.account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceRequestModel.js:90:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceRequestModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceRequestModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceRequestModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceRequestModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceRequestModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[2m[22m
[2m    [0m [90m 91 |[39m             [36mreturn[39m rows[33m;[39m[22m
[2m     [90m 92 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 93 |[39m             console[33m.[39merror([32m"Error retrieving requests by requester username"[39m[33m,[39m err[33m.[39mstack)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 94 |[39m             [36mthrow[39m err[33m;[39m[22m
[2m     [90m 95 |[39m         }[22m
[2m     [90m 96 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/resourceRequestModel.js[2m:93:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/resourceRequestModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/resourceRequestModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/resourceRequestModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/resourceRequestModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/resourceRequestModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error retrieving sent requests: Error: Unknown column 'u_requester.account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceRequestModel.js:90:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceRequestModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceRequestModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceRequestModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceRequestModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceRequestModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5) {[39m
[31m        code: 'ER_BAD_FIELD_ERROR',[39m
[31m        errno: 1054,[39m
[31m        sql: '\n' +[39m
[31m          '                SELECT rr.*\n' +[39m
[31m          '                FROM resource_requests rr\n' +[39m
[31m          '                JOIN user u_requester ON rr.requester_id = u_requester.id\n' +[39m
[31m          '                JOIN user u_requested ON rr.requested_from_id = u_requested.id\n' +[39m
[31m          '                WHERE u_requester.user_name = ?\n' +[39m
[31m          "                AND u_requester.account_status = 'active'\n" +[39m
[31m          "                AND u_requested.account_status = 'active';\n" +[39m
[31m          '            ',[39m
[31m        sqlState: '42S22',[39m
[31m        sqlMessage: "Unknown column 'u_requester.account_status' in 'where clause'"[39m
[31m      }[39m
[2m[22m
[2m    [0m [90m 141 |[39m             [36mreturn[39m res[33m.[39mstatus([35m200[39m)[33m.[39mjson(sentRequests)[33m;[39m[22m
[2m     [90m 142 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 143 |[39m             console[33m.[39merror([32m"Error retrieving sent requests:"[39m[33m,[39m err)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 144 |[39m             [36mreturn[39m res[33m.[39mstatus([35m500[39m)[33m.[39mjson({ message[33m:[39m [32m"Internal Server Error"[39m })[33m;[39m[22m
[2m     [90m 145 |[39m         }[22m
[2m     [90m 146 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/resourceController.js[2m:143:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/resourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/resourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/resourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/resourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/resourceController.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error retrieving resource request Error: Unknown column 'u_requester.account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceRequestModel.js:133:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceRequestModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceRequestModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceRequestModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceRequestModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceRequestModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[2m[22m
[2m    [0m [90m 140 |[39m             [36mreturn[39m rows[[35m0[39m][33m;[39m[22m
[2m     [90m 141 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 142 |[39m             console[33m.[39merror([32m"Error retrieving resource request"[39m[33m,[39m err[33m.[39mstack)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 143 |[39m             [36mthrow[39m err[33m;[39m[22m
[2m     [90m 144 |[39m         }[22m
[2m     [90m 145 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/resourceRequestModel.js[2m:142:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/resourceRequestModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/resourceRequestModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/resourceRequestModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/resourceRequestModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/resourceRequestModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error approving request: Error: Unknown column 'u_requester.account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceRequestModel.js:133:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceRequestModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceRequestModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceRequestModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceRequestModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceRequestModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5) {[39m
[31m        code: 'ER_BAD_FIELD_ERROR',[39m
[31m        errno: 1054,[39m
[31m        sql: '\n' +[39m
[31m          '            SELECT rr.*\n' +[39m
[31m          '            FROM resource_requests rr\n' +[39m
[31m          '            JOIN user u_requester ON rr.requester_id = u_requester.id\n' +[39m
[31m          '            JOIN user u_requested ON rr.requested_from_id = u_requested.id\n' +[39m
[31m          '            WHERE rr.request_id = ?\n' +[39m
[31m          "            AND u_requester.account_status = 'active'\n" +[39m
[31m          "            AND u_requested.account_status = 'active';\n" +[39m
[31m          '            ',[39m
[31m        sqlState: '42S22',[39m
[31m        sqlMessage: "Unknown column 'u_requester.account_status' in 'where clause'"[39m
[31m      }[39m
[2m[22m
[2m    [0m [90m 263 |[39m             res[33m.[39mstatus([35m200[39m)[33m.[39mjson({ message[33m:[39m [32m"Request approved and resources updated"[39m })[33m;[39m[22m
[2m     [90m 264 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 265 |[39m             console[33m.[39merror([32m"Error approving request:"[39m[33m,[39m err)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 266 |[39m             res[33m.[39mstatus([35m500[39m)[33m.[39mjson({ message[33m:[39m [32m"Internal Server Error"[39m })[33m;[39m[22m
[2m     [90m 267 |[39m         }[22m
[2m     [90m 268 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/resourceController.js[2m:265:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/resourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/resourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/resourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/resourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/resourceController.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error retrieving resource request Error: Unknown column 'u_requester.account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceRequestModel.js:133:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceRequestModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceRequestModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceRequestModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceRequestModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceRequestModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[2m[22m
[2m    [0m [90m 140 |[39m             [36mreturn[39m rows[[35m0[39m][33m;[39m[22m
[2m     [90m 141 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 142 |[39m             console[33m.[39merror([32m"Error retrieving resource request"[39m[33m,[39m err[33m.[39mstack)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 143 |[39m             [36mthrow[39m err[33m;[39m[22m
[2m     [90m 144 |[39m         }[22m
[2m     [90m 145 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/resourceRequestModel.js[2m:142:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/resourceRequestModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/resourceRequestModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/resourceRequestModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/resourceRequestModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/resourceRequestModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error approving request: Error: Unknown column 'u_requester.account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceRequestModel.js:133:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceRequestModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceRequestModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceRequestModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceRequestModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/resourceRequestModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5) {[39m
[31m        code: 'ER_BAD_FIELD_ERROR',[39m
[31m        errno: 1054,[39m
[31m        sql: '\n' +[39m
[31m          '            SELECT rr.*\n' +[39m
[31m          '            FROM resource_requests rr\n' +[39m
[31m          '            JOIN user u_requester ON rr.requester_id = u_requester.id\n' +[39m
[31m          '            JOIN user u_requested ON rr.requested_from_id = u_requested.id\n' +[39m
[31m          '            WHERE rr.request_id = ?\n' +[39m
[31m          "            AND u_requester.account_status = 'active'\n" +[39m
[31m          "            AND u_requested.account_status = 'active';\n" +[39m
[31m          '            ',[39m
[31m        sqlState: '42S22',[39m
[31m        sqlMessage: "Unknown column 'u_requester.account_status' in 'where clause'"[39m
[31m      }[39m
[2m[22m
[2m    [0m [90m 263 |[39m             res[33m.[39mstatus([35m200[39m)[33m.[39mjson({ message[33m:[39m [32m"Request approved and resources updated"[39m })[33m;[39m[22m
[2m     [90m 264 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 265 |[39m             console[33m.[39merror([32m"Error approving request:"[39m[33m,[39m err)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 266 |[39m             res[33m.[39mstatus([35m500[39m)[33m.[39mjson({ message[33m:[39m [32m"Internal Server Error"[39m })[33m;[39m[22m
[2m     [90m 267 |[39m         }[22m
[2m     [90m 268 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/resourceController.js[2m:265:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/resourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/resourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/resourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/resourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/resourceController.js[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mResourceController Integration Tests › getUserResources › should fetch the resources for a specific user[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 57 |[39m             [36mawait[39m [33mResourceController[39m[33m.[39mgetUserResources(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 58 |[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 59 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m    |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 60 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith({[22m
[2m     [90m 61 |[39m                 username[33m:[39m [32m'testUser1'[39m[33m,[39m[22m
[2m     [90m 62 |[39m                 water[33m:[39m [35m10[39m[33m,[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:59:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mResourceController Integration Tests › getUserResources › should return 404 if the user is not found[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m404[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 75 |[39m             [36mawait[39m [33mResourceController[39m[33m.[39mgetUserResources(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 76 |[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 77 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m404[39m)[33m;[39m[22m
[2m     [90m    |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 78 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39mobjectContaining({[22m
[2m     [90m 79 |[39m                 error[33m:[39m [32m'User resources not found'[39m[33m,[39m[22m
[2m     [90m 80 |[39m             }))[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:77:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mResourceController Integration Tests › createResourceRequest › should create a new resource request from user1 to user2[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m201[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 163 |[39m             [36mawait[39m [33mResourceController[39m[33m.[39mcreateResourceRequest(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 164 |[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 165 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m201[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 166 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39mobjectContaining({[22m
[2m     [90m 167 |[39m                 message[33m:[39m [32m'Resource request created successfully'[39m[33m,[39m[22m
[2m     [90m 168 |[39m                 request[33m:[39m expect[33m.[39many([33mObject[39m)[33m,[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:165:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mResourceController Integration Tests › createResourceRequest › should return 404 if requested user does not exist[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m404[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 194 |[39m             [36mawait[39m [33mResourceController[39m[33m.[39mcreateResourceRequest(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 195 |[39m         [22m
[2m    [31m[1m>[22m[2m[39m[90m 196 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m404[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 197 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith({[22m
[2m     [90m 198 |[39m                 error[33m:[39m [32m'Requested user not found or has no resources available.'[39m[33m,[39m[22m
[2m     [90m 199 |[39m             })[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:196:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mResourceController Integration Tests › createResourceRequest › should return 400 if the requested quantity exceeds available amount of user2[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m400[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 239 |[39m             [36mawait[39m [33mResourceController[39m[33m.[39mcreateResourceRequest(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 240 |[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 241 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m400[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 242 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith({[22m
[2m     [90m 243 |[39m                 error[33m:[39m [32m'Requested quantity exceeds available amount.'[39m[33m,[39m[22m
[2m     [90m 244 |[39m             })[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:241:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mResourceController Integration Tests › getAllSentRequests › should fetch all requests sent by a user[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 266 |[39m             [36mawait[39m [33mResourceController[39m[33m.[39mgetAllSentRequests(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 267 |[39m     [22m
[2m    [31m[1m>[22m[2m[39m[90m 268 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 269 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39marrayContaining([[22m
[2m     [90m 270 |[39m                 expect[33m.[39mobjectContaining({[22m
[2m     [90m 271 |[39m                     requester_username[33m:[39m [32m'testUser1'[39m[33m,[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:268:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mResourceController Integration Tests › getAllSentRequests › should return 404 if no sent requests found for this user[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m404[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 300 |[39m             [36mawait[39m [33mResourceController[39m[33m.[39mgetAllSentRequests(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 301 |[39m     [22m
[2m    [31m[1m>[22m[2m[39m[90m 302 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m404[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 303 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith({[22m
[2m     [90m 304 |[39m                 message[33m:[39m [32m'No sent requests found for this user'[39m[33m,[39m[22m
[2m     [90m 305 |[39m             })[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:302:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mResourceController Integration Tests › approveRequest › should approve a request and update resources for both users[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 332 |[39m             [36mawait[39m [33mResourceController[39m[33m.[39mapproveRequest(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 333 |[39m     [22m
[2m    [31m[1m>[22m[2m[39m[90m 334 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 335 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith({[22m
[2m     [90m 336 |[39m                 message[33m:[39m [32m'Request approved and resources updated'[39m[33m,[39m[22m
[2m     [90m 337 |[39m             })[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:334:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mResourceController Integration Tests › approveRequest › should return 404 if the request does not exist[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m404[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 364 |[39m             [36mawait[39m [33mResourceController[39m[33m.[39mapproveRequest(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 365 |[39m     [22m
[2m    [31m[1m>[22m[2m[39m[90m 366 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m404[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 367 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith({[22m
[2m     [90m 368 |[39m                 error[33m:[39m [32m'Request not found'[39m[33m,[39m[22m
[2m     [90m 369 |[39m             })[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:366:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[0m[7m[1m[31m FAIL [39m[22m[27m[0m [2mtests/integration/[22m[1mESNController.test.js[22m
  [1m● [22mConsole

    [2mconsole.log[22m
      SSH connection established.
[2m[22m
[2m      [2mat Client.log ([22m[2mconfigurations/mysqlDatabase.js[2m:180:25)[22m[2m[22m

    [2mconsole.log[22m
      Connected to database: sb2-test
[2m[22m
[2m      [2mat log ([22m[2mconfigurations/dbConfig.js[2m:62:17)[22m[2m[22m

    [2mconsole.log[22m
      Connected to database in setDatabaseconnection: sb2
[2m[22m
[2m      [2mat log ([22m[2mconfigurations/dbConfig.js[2m:31:17)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error executing query Error: Unknown column 'account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:37:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[2m[22m
[2m    [0m [90m 51 |[39m             }[33m;[39m[22m
[2m     [90m 52 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 53 |[39m             console[33m.[39merror([32m"Error executing query"[39m[33m,[39m err[33m.[39mstack)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 54 |[39m             [36mthrow[39m err[33m;[39m[22m
[2m     [90m 55 |[39m         }[22m
[2m     [90m 56 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/userModel.js[2m:53:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching user status: Error: Unknown column 'account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:37:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5) {[39m
[31m        code: 'ER_BAD_FIELD_ERROR',[39m
[31m        errno: 1054,[39m
[31m        sql: '\n' +[39m
[31m          '            SELECT *\n' +[39m
[31m          '                FROM user\n' +[39m
[31m          '                WHERE user_name = ?\n' +[39m
[31m          "                AND account_status = 'active';\n" +[39m
[31m          '            ',[39m
[31m        sqlState: '42S22',[39m
[31m        sqlMessage: "Unknown column 'account_status' in 'where clause'"[39m
[31m      }[39m
[2m[22m
[2m    [0m [90m 50 |[39m             })[33m;[39m[22m
[2m     [90m 51 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 52 |[39m             console[33m.[39merror([32m"Error fetching user status:"[39m[33m,[39m err)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 53 |[39m             [36mreturn[39m res[33m.[39mstatus([35m500[39m)[33m.[39mjson({ message[33m:[39m [32m"Internal Server Error"[39m })[33m;[39m[22m
[2m     [90m 54 |[39m         }[22m
[2m     [90m 55 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/ESNController.js[2m:52:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/ESNController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/ESNController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/ESNController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/ESNController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/ESNController.js[2m:2:1)[22m[2m[22m

    [2mconsole.log[22m
      Updating status for test to Emergency
[2m[22m
[2m      [2mat log ([22m[2mcontrollers/ESNController.js[2m:60:21)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error executing query Error: Unknown column 'account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:37:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[2m[22m
[2m    [0m [90m 51 |[39m             }[33m;[39m[22m
[2m     [90m 52 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 53 |[39m             console[33m.[39merror([32m"Error executing query"[39m[33m,[39m err[33m.[39mstack)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 54 |[39m             [36mthrow[39m err[33m;[39m[22m
[2m     [90m 55 |[39m         }[22m
[2m     [90m 56 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/userModel.js[2m:53:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error updating citizen status: Error: Unknown column 'account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:37:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5) {[39m
[31m        code: 'ER_BAD_FIELD_ERROR',[39m
[31m        errno: 1054,[39m
[31m        sql: '\n' +[39m
[31m          '            SELECT *\n' +[39m
[31m          '                FROM user\n' +[39m
[31m          '                WHERE user_name = ?\n' +[39m
[31m          "                AND account_status = 'active';\n" +[39m
[31m          '            ',[39m
[31m        sqlState: '42S22',[39m
[31m        sqlMessage: "Unknown column 'account_status' in 'where clause'"[39m
[31m      }[39m
[2m[22m
[2m    [0m [90m 82 |[39m             [36mreturn[39m res[33m.[39mstatus([35m200[39m)[33m.[39mjson({ message[33m:[39m [32m"Citizen status updated successfully"[39m })[33m;[39m[22m
[2m     [90m 83 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 84 |[39m             console[33m.[39merror([32m"Error updating citizen status:"[39m[33m,[39m err)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 85 |[39m             [36mreturn[39m res[33m.[39mstatus([35m500[39m)[33m.[39mjson({ message[33m:[39m [32m"Internal Server Error"[39m })[33m;[39m[22m
[2m     [90m 86 |[39m         }[22m
[2m     [90m 87 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/ESNController.js[2m:84:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/ESNController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/ESNController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/ESNController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/ESNController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/ESNController.js[2m:2:1)[22m[2m[22m

    [2mconsole.log[22m
      Updating status for nonexistentuser to Emergency
[2m[22m
[2m      [2mat log ([22m[2mcontrollers/ESNController.js[2m:60:21)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error executing query Error: Unknown column 'account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:37:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[2m[22m
[2m    [0m [90m 51 |[39m             }[33m;[39m[22m
[2m     [90m 52 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 53 |[39m             console[33m.[39merror([32m"Error executing query"[39m[33m,[39m err[33m.[39mstack)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 54 |[39m             [36mthrow[39m err[33m;[39m[22m
[2m     [90m 55 |[39m         }[22m
[2m     [90m 56 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/userModel.js[2m:53:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error updating citizen status: Error: Unknown column 'account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:37:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5) {[39m
[31m        code: 'ER_BAD_FIELD_ERROR',[39m
[31m        errno: 1054,[39m
[31m        sql: '\n' +[39m
[31m          '            SELECT *\n' +[39m
[31m          '                FROM user\n' +[39m
[31m          '                WHERE user_name = ?\n' +[39m
[31m          "                AND account_status = 'active';\n" +[39m
[31m          '            ',[39m
[31m        sqlState: '42S22',[39m
[31m        sqlMessage: "Unknown column 'account_status' in 'where clause'"[39m
[31m      }[39m
[2m[22m
[2m    [0m [90m 82 |[39m             [36mreturn[39m res[33m.[39mstatus([35m200[39m)[33m.[39mjson({ message[33m:[39m [32m"Citizen status updated successfully"[39m })[33m;[39m[22m
[2m     [90m 83 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 84 |[39m             console[33m.[39merror([32m"Error updating citizen status:"[39m[33m,[39m err)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 85 |[39m             [36mreturn[39m res[33m.[39mstatus([35m500[39m)[33m.[39mjson({ message[33m:[39m [32m"Internal Server Error"[39m })[33m;[39m[22m
[2m     [90m 86 |[39m         }[22m
[2m     [90m 87 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/ESNController.js[2m:84:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/ESNController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/ESNController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/ESNController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/ESNController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/ESNController.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching all users Error: Unknown column 'account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:385:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[2m[22m
[2m    [0m [90m 386 |[39m             [36mreturn[39m rows[33m;[39m [90m// Return the array of users[39m[22m
[2m     [90m 387 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 388 |[39m             console[33m.[39merror([32m"Error fetching all users"[39m[33m,[39m err[33m.[39mstack)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 389 |[39m             [36mthrow[39m err[33m;[39m[22m
[2m     [90m 390 |[39m         }[22m
[2m     [90m 391 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/userModel.js[2m:388:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error in getting all users: Error: Unknown column 'account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:385:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5) {[39m
[31m        code: 'ER_BAD_FIELD_ERROR',[39m
[31m        errno: 1054,[39m
[31m        sql: '\n' +[39m
[31m          '                SELECT user_name AS username,\n' +[39m
[31m          '                    status AS citizenStatus,\n' +[39m
[31m          '                    online_status AS onLineStatus\n' +[39m
[31m          '                FROM user\n' +[39m
[31m          "                WHERE account_status = 'active';\n" +[39m
[31m          '            ',[39m
[31m        sqlState: '42S22',[39m
[31m        sqlMessage: "Unknown column 'account_status' in 'where clause'"[39m
[31m      }[39m
[2m[22m
[2m    [0m [90m  9 |[39m             io[33m.[39memit([32m"allUsers"[39m[33m,[39m users)[33m;[39m [22m
[2m     [90m 10 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 11 |[39m             console[33m.[39merror([32m"Error in getting all users:"[39m[33m,[39m err)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 12 |[39m             res[33m.[39mstatus([35m500[39m)[33m.[39mjson({ message[33m:[39m [32m"Internal Server Error"[39m })[33m;[39m[22m
[2m     [90m 13 |[39m         }[22m
[2m     [90m 14 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/ESNController.js[2m:11:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/ESNController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/ESNController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/ESNController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/ESNController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/ESNController.js[2m:2:1)[22m[2m[22m

    [2mconsole.log[22m
      User logged out
[2m[22m
[2m      [2mat log ([22m[2mcontrollers/ESNController.js[2m:25:21)[22m[2m[22m

[1m[31m  [1m● [22m[1mIntegration Test › getUserCitizenStatus › should return the citizen status and username of the test user[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 36 |[39m[22m
[2m     [90m 37 |[39m             [90m// Verify the response[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 38 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m    |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 39 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith({[22m
[2m     [90m 40 |[39m                 username[33m:[39m [32m'test'[39m[33m,[39m[22m
[2m     [90m 41 |[39m                 citizenStatus[33m:[39m [32m'Undefined'[39m[33m,[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/ESNController.test.js[39m[0m[2m:38:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/ESNController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/ESNController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/ESNController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/ESNController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/ESNController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mIntegration Test › updateUserCitizenStatus › should update the citizen status of the test user and verify it[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 78 |[39m[22m
[2m     [90m 79 |[39m             [90m// Verify the update response[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 80 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m    |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 81 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith({ message[33m:[39m [32m'Citizen status updated successfully'[39m })[33m;[39m[22m
[2m     [90m 82 |[39m[22m
[2m     [90m 83 |[39m             [90m// Now, verify the update by querying the database directly[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/ESNController.test.js[39m[0m[2m:80:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/ESNController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/ESNController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/ESNController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/ESNController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/ESNController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mIntegration Test › updateUserCitizenStatus › should return 404 when trying to update a user that does not exist[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m404[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 100 |[39m[22m
[2m     [90m 101 |[39m             [90m// Verify the response[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 102 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m404[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 103 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith({[22m
[2m     [90m 104 |[39m                 error[33m:[39m [32m'User not found'[39m[33m,[39m[22m
[2m     [90m 105 |[39m             })[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/ESNController.test.js[39m[0m[2m:102:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/ESNController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/ESNController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/ESNController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/ESNController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/ESNController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mIntegration Test › getAllUsers › should return a list of all users[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 117 |[39m             [36mawait[39m [33mESNController[39m[33m.[39mgetAllUsers(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 118 |[39m     [22m
[2m    [31m[1m>[22m[2m[39m[90m 119 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 120 |[39m     [22m
[2m     [90m 121 |[39m             [90m// Expected users array with multiple entries for verification[39m[22m
[2m     [90m 122 |[39m             [36mconst[39m expectedUsers [33m=[39m [[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/ESNController.test.js[39m[0m[2m:119:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/ESNController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/ESNController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/ESNController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/ESNController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/ESNController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[0m[7m[1m[31m FAIL [39m[22m[27m[0m [2mtests/integration/[22m[1msearchController.test.js[22m
  [1m● [22mConsole

    [2mconsole.log[22m
      SSH connection established.
[2m[22m
[2m      [2mat Client.log ([22m[2mconfigurations/mysqlDatabase.js[2m:180:25)[22m[2m[22m

    [2mconsole.log[22m
      Connected to database: sb2-test
[2m[22m
[2m      [2mat log ([22m[2mconfigurations/dbConfig.js[2m:62:17)[22m[2m[22m

    [2mconsole.log[22m
      UserSearch processSearch called with: [ 'test-content' ]
[2m[22m
[2m      [2mat userSearch.log ([22m[2mservice/searchControllerService/userSearch.js[2m:31:17)[22m[2m[22m

    [2mconsole.log[22m
      Connected to database in setDatabaseconnection: sb2
[2m[22m
[2m      [2mat log ([22m[2mconfigurations/dbConfig.js[2m:31:17)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching announcements: Error: Unknown column 'u.account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:71:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5) {[39m
[31m        code: 'ER_BAD_FIELD_ERROR',[39m
[31m        errno: 1054,[39m
[31m        sql: '\n' +[39m
[31m          '                SELECT a.id,\n' +[39m
[31m          '                    a.announcement_content,\n' +[39m
[31m          '                    a.announcement_sent_time,\n' +[39m
[31m          '                    u.user_name AS announcement_sender,\n' +[39m
[31m          '                    a.announcement_sender_status\n' +[39m
[31m          '                FROM announcements a\n' +[39m
[31m          '                JOIN user u ON a.sender_id = u.id\n' +[39m
[31m          '                WHERE announcement_content LIKE ?\n' +[39m
[31m          "                AND u.account_status = 'active'\n" +[39m
[31m          '                ORDER BY a.announcement_sent_time DESC;\n' +[39m
[31m          '            ',[39m
[31m        sqlState: '42S22',[39m
[31m        sqlMessage: "Unknown column 'u.account_status' in 'where clause'"[39m
[31m      }[39m
[2m[22m
[2m    [0m [90m 73 |[39m             [36mreturn[39m rows[33m;[39m[22m
[2m     [90m 74 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 75 |[39m             console[33m.[39merror([32m'Error fetching announcements:'[39m[33m,[39m error)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 76 |[39m             [36mthrow[39m error[33m;[39m[22m
[2m     [90m 77 |[39m         }[22m
[2m     [90m 78 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/messageModel.js[2m:75:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error executing query Error: Unknown column 'u.account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:71:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[2m[22m
[2m    [0m [90m 19 |[39m             [36mreturn[39m announcements[33m.[39mslice(offset[33m,[39m offset [33m+[39m limit)[33m;[39m[22m
[2m     [90m 20 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 21 |[39m             console[33m.[39merror([32m"Error executing query"[39m[33m,[39m err[33m.[39mstack)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 22 |[39m             [36mthrow[39m err[33m;[39m[22m
[2m     [90m 23 |[39m         }[22m
[2m     [90m 24 |[39m     }    [0m[22m
[2m[22m
[2m      [2mat error ([22m[2mservice/searchControllerService/announcementSearchStrategy.js[2m:21:21)[22m[2m[22m
[2m      [2mat call ([22m[2mservice/searchControllerService/announcementSearchStrategy.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mservice/searchControllerService/announcementSearchStrategy.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mservice/searchControllerService/announcementSearchStrategy.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mservice/searchControllerService/announcementSearchStrategy.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mservice/searchControllerService/announcementSearchStrategy.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error in userSearch: Error: Unknown column 'u.account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:71:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5) {[39m
[31m        code: 'ER_BAD_FIELD_ERROR',[39m
[31m        errno: 1054,[39m
[31m        sql: '\n' +[39m
[31m          '                SELECT a.id,\n' +[39m
[31m          '                    a.announcement_content,\n' +[39m
[31m          '                    a.announcement_sent_time,\n' +[39m
[31m          '                    u.user_name AS announcement_sender,\n' +[39m
[31m          '                    a.announcement_sender_status\n' +[39m
[31m          '                FROM announcements a\n' +[39m
[31m          '                JOIN user u ON a.sender_id = u.id\n' +[39m
[31m          '                WHERE announcement_content LIKE ?\n' +[39m
[31m          "                AND u.account_status = 'active'\n" +[39m
[31m          '                ORDER BY a.announcement_sent_time DESC;\n' +[39m
[31m          '            ',[39m
[31m        sqlState: '42S22',[39m
[31m        sqlMessage: "Unknown column 'u.account_status' in 'where clause'"[39m
[31m      }[39m
[2m[22m
[2m    [0m [90m 47 |[39m         }[22m
[2m     [90m 48 |[39m         [36mcatch[39m(error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 49 |[39m             console[33m.[39merror([32m'Error in userSearch:'[39m[33m,[39m error)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 50 |[39m             [36mthrow[39m error[33m;[39m[22m
[2m     [90m 51 |[39m         }[22m
[2m     [90m 52 |[39m     }[0m[22m
[2m[22m
[2m      [2mat userSearch.error ([22m[2mservice/searchControllerService/userSearch.js[2m:49:21)[22m[2m[22m
[2m      [2mat call ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m

    [2mconsole.log[22m
      UserSearch processSearch called with: null
[2m[22m
[2m      [2mat userSearch.log ([22m[2mservice/searchControllerService/userSearch.js[2m:31:17)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error executing query Error: Invalid word list[39m
[31m          at _callee$ (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/announcementSearchStrategy.js:12:23)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/announcementSearchStrategy.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/announcementSearchStrategy.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/announcementSearchStrategy.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/announcementSearchStrategy.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/announcementSearchStrategy.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/announcementSearchStrategy.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at announcementSearchStrategy.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/announcementSearchStrategy.js:2:1)[39m
[31m          at announcementSearchStrategy.apply [as processSearch] (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/announcementSearchStrategy.js:4:24)[39m
[31m          at userSearch.processSearch (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:35:50)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at userSearch.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:2:1)[39m
[31m          at userSearch.apply [as processSearch] (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:29:24)[39m
[31m          at processSearch (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:15:37)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at Function.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:2:1)[39m
[31m          at Function.apply [as postAmmouncementSearch] (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:9:40)[39m
[31m          at postAmmouncementSearch (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:138:34)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at Object.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:2:1)[39m
[31m          at Promise.then.completed (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:298:28)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at callAsyncCircusFn (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:231:10)[39m
[31m          at _callCircusTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:316:40)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m          at _runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:252:3)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:126:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at run (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:71:3)[39m
[31m          at runAndTransformResultsToJestFormat (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)[39m
[31m          at jestAdapter (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)[39m
[31m          at runTestInternal (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:367:16)[39m
[31m          at runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:444:34)[39m
[31m          at Object.worker (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/testWorker.js:106:12)[39m
[2m[22m
[2m    [0m [90m 19 |[39m             [36mreturn[39m announcements[33m.[39mslice(offset[33m,[39m offset [33m+[39m limit)[33m;[39m[22m
[2m     [90m 20 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 21 |[39m             console[33m.[39merror([32m"Error executing query"[39m[33m,[39m err[33m.[39mstack)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 22 |[39m             [36mthrow[39m err[33m;[39m[22m
[2m     [90m 23 |[39m         }[22m
[2m     [90m 24 |[39m     }    [0m[22m
[2m[22m
[2m      [2mat error ([22m[2mservice/searchControllerService/announcementSearchStrategy.js[2m:21:21)[22m[2m[22m
[2m      [2mat call ([22m[2mservice/searchControllerService/announcementSearchStrategy.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mservice/searchControllerService/announcementSearchStrategy.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mservice/searchControllerService/announcementSearchStrategy.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mservice/searchControllerService/announcementSearchStrategy.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mservice/searchControllerService/announcementSearchStrategy.js[2m:2:1)[22m[2m[22m
[2m      [2mat _next ([22m[2mservice/searchControllerService/announcementSearchStrategy.js[2m:2:1)[22m[2m[22m
[2m      [2mat announcementSearchStrategy.<anonymous> ([22m[2mservice/searchControllerService/announcementSearchStrategy.js[2m:2:1)[22m[2m[22m
[2m      [2mat announcementSearchStrategy.apply [as processSearch] ([22m[2mservice/searchControllerService/announcementSearchStrategy.js[2m:4:24)[22m[2m[22m
[2m      [2mat userSearch.processSearch ([22m[2mservice/searchControllerService/userSearch.js[2m:35:50)[22m[2m[22m
[2m      [2mat call ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m
[2m      [2mat _next ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m
[2m      [2mat userSearch.<anonymous> ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m
[2m      [2mat userSearch.apply [as processSearch] ([22m[2mservice/searchControllerService/userSearch.js[2m:29:24)[22m[2m[22m
[2m      [2mat processSearch ([22m[2mcontrollers/searchController.js[2m:15:37)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/searchController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/searchController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mcontrollers/searchController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/searchController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/searchController.js[2m:2:1)[22m[2m[22m
[2m      [2mat _next ([22m[2mcontrollers/searchController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Function.<anonymous> ([22m[2mcontrollers/searchController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Function.apply [as postAmmouncementSearch] ([22m[2mcontrollers/searchController.js[2m:9:40)[22m[2m[22m
[2m      [2mat postAmmouncementSearch ([22m[2m[0m[36mtests/integration/searchController.test.js[39m[0m[2m:138:34)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/searchController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/searchController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/searchController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/searchController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/searchController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat _next ([22m[2m[0m[36mtests/integration/searchController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Object.<anonymous> ([22m[2m[0m[36mtests/integration/searchController.test.js[39m[0m[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error in userSearch: Error: Invalid word list[39m
[31m          at _callee$ (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/announcementSearchStrategy.js:12:23)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/announcementSearchStrategy.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/announcementSearchStrategy.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/announcementSearchStrategy.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/announcementSearchStrategy.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/announcementSearchStrategy.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/announcementSearchStrategy.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at announcementSearchStrategy.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/announcementSearchStrategy.js:2:1)[39m
[31m          at announcementSearchStrategy.apply [as processSearch] (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/announcementSearchStrategy.js:4:24)[39m
[31m          at userSearch.processSearch (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:35:50)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at userSearch.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:2:1)[39m
[31m          at userSearch.apply [as processSearch] (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:29:24)[39m
[31m          at processSearch (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:15:37)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at Function.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:2:1)[39m
[31m          at Function.apply [as postAmmouncementSearch] (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:9:40)[39m
[31m          at postAmmouncementSearch (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:138:34)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at Object.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:2:1)[39m
[31m          at Promise.then.completed (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:298:28)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at callAsyncCircusFn (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:231:10)[39m
[31m          at _callCircusTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:316:40)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m          at _runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:252:3)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:126:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at run (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:71:3)[39m
[31m          at runAndTransformResultsToJestFormat (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)[39m
[31m          at jestAdapter (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)[39m
[31m          at runTestInternal (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:367:16)[39m
[31m          at runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:444:34)[39m
[31m          at Object.worker (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/testWorker.js:106:12)[39m
[2m[22m
[2m    [0m [90m 47 |[39m         }[22m
[2m     [90m 48 |[39m         [36mcatch[39m(error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 49 |[39m             console[33m.[39merror([32m'Error in userSearch:'[39m[33m,[39m error)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 50 |[39m             [36mthrow[39m error[33m;[39m[22m
[2m     [90m 51 |[39m         }[22m
[2m     [90m 52 |[39m     }[0m[22m
[2m[22m
[2m      [2mat userSearch.error ([22m[2mservice/searchControllerService/userSearch.js[2m:49:21)[22m[2m[22m
[2m      [2mat call ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m

    [2mconsole.log[22m
      UserSearch processSearch called with: [ 'hello' ]
[2m[22m
[2m      [2mat userSearch.log ([22m[2mservice/searchControllerService/userSearch.js[2m:31:17)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching private messages by words: Error: Unknown column 'u_sender.account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:266:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5) {[39m
[31m        code: 'ER_BAD_FIELD_ERROR',[39m
[31m        errno: 1054,[39m
[31m        sql: '\n' +[39m
[31m          '                SELECT pm.*\n' +[39m
[31m          '                FROM privateMessage pm\n' +[39m
[31m          '                JOIN user u_sender ON pm.sender_id = u_sender.id\n' +[39m
[31m          '                JOIN user u_receiver ON pm.receiver_id = u_receiver.id\n' +[39m
[31m          '                WHERE (\n' +[39m
[31m          '                (message_sender = ? AND message_receiver = ?) \n' +[39m
[31m          '                OR (message_sender = ? AND message_receiver = ?)\n' +[39m
[31m          '            )\n' +[39m
[31m          '                AND (message_text LIKE ?)\n' +[39m
[31m          "                AND u_sender.account_status = 'active'\n" +[39m
[31m          "                AND u_receiver.account_status = 'active'\n" +[39m
[31m          '                ORDER BY pm.message_sent_time DESC;\n' +[39m
[31m          '            ',[39m
[31m        sqlState: '42S22',[39m
[31m        sqlMessage: "Unknown column 'u_sender.account_status' in 'where clause'"[39m
[31m      }[39m
[2m[22m
[2m    [0m [90m 268 |[39m             [36mreturn[39m rows[33m;[39m[22m
[2m     [90m 269 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 270 |[39m             console[33m.[39merror([32m'Error fetching private messages by words:'[39m[33m,[39m error)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 271 |[39m             [36mthrow[39m error[33m;[39m[22m
[2m     [90m 272 |[39m         }[22m
[2m     [90m 273 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/messageModel.js[2m:270:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error in userSearch: Error: Unknown column 'u_sender.account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:266:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5) {[39m
[31m        code: 'ER_BAD_FIELD_ERROR',[39m
[31m        errno: 1054,[39m
[31m        sql: '\n' +[39m
[31m          '                SELECT pm.*\n' +[39m
[31m          '                FROM privateMessage pm\n' +[39m
[31m          '                JOIN user u_sender ON pm.sender_id = u_sender.id\n' +[39m
[31m          '                JOIN user u_receiver ON pm.receiver_id = u_receiver.id\n' +[39m
[31m          '                WHERE (\n' +[39m
[31m          '                (message_sender = ? AND message_receiver = ?) \n' +[39m
[31m          '                OR (message_sender = ? AND message_receiver = ?)\n' +[39m
[31m          '            )\n' +[39m
[31m          '                AND (message_text LIKE ?)\n' +[39m
[31m          "                AND u_sender.account_status = 'active'\n" +[39m
[31m          "                AND u_receiver.account_status = 'active'\n" +[39m
[31m          '                ORDER BY pm.message_sent_time DESC;\n' +[39m
[31m          '            ',[39m
[31m        sqlState: '42S22',[39m
[31m        sqlMessage: "Unknown column 'u_sender.account_status' in 'where clause'"[39m
[31m      }[39m
[2m[22m
[2m    [0m [90m 47 |[39m         }[22m
[2m     [90m 48 |[39m         [36mcatch[39m(error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 49 |[39m             console[33m.[39merror([32m'Error in userSearch:'[39m[33m,[39m error)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 50 |[39m             [36mthrow[39m error[33m;[39m[22m
[2m     [90m 51 |[39m         }[22m
[2m     [90m 52 |[39m     }[0m[22m
[2m[22m
[2m      [2mat userSearch.error ([22m[2mservice/searchControllerService/userSearch.js[2m:49:21)[22m[2m[22m
[2m      [2mat call ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m

    [2mconsole.log[22m
      UserSearch processSearch called with: null
[2m[22m
[2m      [2mat userSearch.log ([22m[2mservice/searchControllerService/userSearch.js[2m:31:17)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error in userSearch: Error: Invalid word list[39m
[31m          at _callee$ (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/privateMessageSearchStrategy.js:18:19)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/privateMessageSearchStrategy.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/privateMessageSearchStrategy.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/privateMessageSearchStrategy.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/privateMessageSearchStrategy.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/privateMessageSearchStrategy.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/privateMessageSearchStrategy.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at privateMessageSearchStrategy.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/privateMessageSearchStrategy.js:2:1)[39m
[31m          at privateMessageSearchStrategy.apply [as processSearch] (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/privateMessageSearchStrategy.js:5:24)[39m
[31m          at userSearch.processSearch (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:37:50)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at userSearch.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:2:1)[39m
[31m          at userSearch.apply [as processSearch] (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:29:24)[39m
[31m          at processSearch (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:42:47)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at Function.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:2:1)[39m
[31m          at Function.apply [as postPrivateMessageSearch] (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:29:42)[39m
[31m          at postPrivateMessageSearch (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:181:34)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at Object.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:2:1)[39m
[31m          at Promise.then.completed (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:298:28)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at callAsyncCircusFn (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:231:10)[39m
[31m          at _callCircusTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:316:40)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m          at _runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:252:3)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:126:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at run (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:71:3)[39m
[31m          at runAndTransformResultsToJestFormat (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)[39m
[31m          at jestAdapter (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)[39m
[31m          at runTestInternal (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:367:16)[39m
[31m          at runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:444:34)[39m
[31m          at Object.worker (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/testWorker.js:106:12)[39m
[2m[22m
[2m    [0m [90m 47 |[39m         }[22m
[2m     [90m 48 |[39m         [36mcatch[39m(error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 49 |[39m             console[33m.[39merror([32m'Error in userSearch:'[39m[33m,[39m error)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 50 |[39m             [36mthrow[39m error[33m;[39m[22m
[2m     [90m 51 |[39m         }[22m
[2m     [90m 52 |[39m     }[0m[22m
[2m[22m
[2m      [2mat userSearch.error ([22m[2mservice/searchControllerService/userSearch.js[2m:49:21)[22m[2m[22m
[2m      [2mat call ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m

    [2mconsole.log[22m
      UserSearch processSearch called with: [ 'Public message' ]
[2m[22m
[2m      [2mat userSearch.log ([22m[2mservice/searchControllerService/userSearch.js[2m:31:17)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching announcements: Error: Unknown column 'u.account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:103:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5) {[39m
[31m        code: 'ER_BAD_FIELD_ERROR',[39m
[31m        errno: 1054,[39m
[31m        sql: '\n' +[39m
[31m          '                SELECT m.id,\n' +[39m
[31m          '                    m.message_text,\n' +[39m
[31m          '                    m.message_sent_time,\n' +[39m
[31m          '                    u.user_name AS message_sender,\n' +[39m
[31m          '                    m.message_sender_status\n' +[39m
[31m          '                FROM message m\n' +[39m
[31m          '                JOIN user u ON m.sender_id = u.id\n' +[39m
[31m          '                WHERE message_text LIKE ?\n' +[39m
[31m          "                AND u.account_status = 'active'\n" +[39m
[31m          '                ORDER BY m.message_sent_time DESC;\n' +[39m
[31m          '            ',[39m
[31m        sqlState: '42S22',[39m
[31m        sqlMessage: "Unknown column 'u.account_status' in 'where clause'"[39m
[31m      }[39m
[2m[22m
[2m    [0m [90m 105 |[39m             [36mreturn[39m rows[33m;[39m[22m
[2m     [90m 106 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 107 |[39m             console[33m.[39merror([32m'Error fetching announcements:'[39m[33m,[39m error)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 108 |[39m             [36mthrow[39m error[33m;[39m[22m
[2m     [90m 109 |[39m         }[22m
[2m     [90m 110 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/messageModel.js[2m:107:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error in userSearch: Error: Unknown column 'u.account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:103:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/messageModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5) {[39m
[31m        code: 'ER_BAD_FIELD_ERROR',[39m
[31m        errno: 1054,[39m
[31m        sql: '\n' +[39m
[31m          '                SELECT m.id,\n' +[39m
[31m          '                    m.message_text,\n' +[39m
[31m          '                    m.message_sent_time,\n' +[39m
[31m          '                    u.user_name AS message_sender,\n' +[39m
[31m          '                    m.message_sender_status\n' +[39m
[31m          '                FROM message m\n' +[39m
[31m          '                JOIN user u ON m.sender_id = u.id\n' +[39m
[31m          '                WHERE message_text LIKE ?\n' +[39m
[31m          "                AND u.account_status = 'active'\n" +[39m
[31m          '                ORDER BY m.message_sent_time DESC;\n' +[39m
[31m          '            ',[39m
[31m        sqlState: '42S22',[39m
[31m        sqlMessage: "Unknown column 'u.account_status' in 'where clause'"[39m
[31m      }[39m
[2m[22m
[2m    [0m [90m 47 |[39m         }[22m
[2m     [90m 48 |[39m         [36mcatch[39m(error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 49 |[39m             console[33m.[39merror([32m'Error in userSearch:'[39m[33m,[39m error)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 50 |[39m             [36mthrow[39m error[33m;[39m[22m
[2m     [90m 51 |[39m         }[22m
[2m     [90m 52 |[39m     }[0m[22m
[2m[22m
[2m      [2mat userSearch.error ([22m[2mservice/searchControllerService/userSearch.js[2m:49:21)[22m[2m[22m
[2m      [2mat call ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m

    [2mconsole.log[22m
      UserSearch processSearch called with: null
[2m[22m
[2m      [2mat userSearch.log ([22m[2mservice/searchControllerService/userSearch.js[2m:31:17)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error in userSearch: Error: Invalid word list[39m
[31m          at _callee$ (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/publicMessageSearchStrategy.js:12:19)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/publicMessageSearchStrategy.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/publicMessageSearchStrategy.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/publicMessageSearchStrategy.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/publicMessageSearchStrategy.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/publicMessageSearchStrategy.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/publicMessageSearchStrategy.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at publicMessageSearchStrategy.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/publicMessageSearchStrategy.js:2:1)[39m
[31m          at publicMessageSearchStrategy.apply [as processSearch] (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/publicMessageSearchStrategy.js:4:24)[39m
[31m          at userSearch.processSearch (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:39:50)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at userSearch.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:2:1)[39m
[31m          at userSearch.apply [as processSearch] (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:29:24)[39m
[31m          at processSearch (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:74:37)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at Function.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:2:1)[39m
[31m          at Function.apply [as postPublicMessageSearch] (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:68:41)[39m
[31m          at postPublicMessageSearch (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:228:34)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at Object.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:2:1)[39m
[31m          at Promise.then.completed (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:298:28)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at callAsyncCircusFn (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:231:10)[39m
[31m          at _callCircusTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:316:40)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m          at _runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:252:3)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:126:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at run (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:71:3)[39m
[31m          at runAndTransformResultsToJestFormat (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)[39m
[31m          at jestAdapter (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)[39m
[31m          at runTestInternal (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:367:16)[39m
[31m          at runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:444:34)[39m
[31m          at Object.worker (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/testWorker.js:106:12)[39m
[2m[22m
[2m    [0m [90m 47 |[39m         }[22m
[2m     [90m 48 |[39m         [36mcatch[39m(error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 49 |[39m             console[33m.[39merror([32m'Error in userSearch:'[39m[33m,[39m error)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 50 |[39m             [36mthrow[39m error[33m;[39m[22m
[2m     [90m 51 |[39m         }[22m
[2m     [90m 52 |[39m     }[0m[22m
[2m[22m
[2m      [2mat userSearch.error ([22m[2mservice/searchControllerService/userSearch.js[2m:49:21)[22m[2m[22m
[2m      [2mat call ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m

    [2mconsole.log[22m
      UserSearch processSearch called with: Help
[2m[22m
[2m      [2mat userSearch.log ([22m[2mservice/searchControllerService/userSearch.js[2m:31:17)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error executing search query Error: Unknown column 'account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:140:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[2m[22m
[2m    [0m [90m 153 |[39m             }))[33m;[39m[22m
[2m     [90m 154 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 155 |[39m             console[33m.[39merror([32m"Error executing search query"[39m[33m,[39m err[33m.[39mstack)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 156 |[39m             [36mthrow[39m err[33m;[39m[22m
[2m     [90m 157 |[39m         }[22m
[2m     [90m 158 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/userModel.js[2m:155:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error in userSearch: Error: Unknown column 'account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:140:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5) {[39m
[31m        code: 'ER_BAD_FIELD_ERROR',[39m
[31m        errno: 1054,[39m
[31m        sql: '\n' +[39m
[31m          '            SELECT id,\n' +[39m
[31m          '                user_name AS username,\n' +[39m
[31m          '                status AS citizenStatus,\n' +[39m
[31m          '                online_status AS onlineStatus\n' +[39m
[31m          '            FROM user\n' +[39m
[31m          '            WHERE status = ?\n' +[39m
[31m          "            AND account_status = 'active';\n" +[39m
[31m          '            ',[39m
[31m        sqlState: '42S22',[39m
[31m        sqlMessage: "Unknown column 'account_status' in 'where clause'"[39m
[31m      }[39m
[2m[22m
[2m    [0m [90m 47 |[39m         }[22m
[2m     [90m 48 |[39m         [36mcatch[39m(error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 49 |[39m             console[33m.[39merror([32m'Error in userSearch:'[39m[33m,[39m error)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 50 |[39m             [36mthrow[39m error[33m;[39m[22m
[2m     [90m 51 |[39m         }[22m
[2m     [90m 52 |[39m     }[0m[22m
[2m[22m
[2m      [2mat userSearch.error ([22m[2mservice/searchControllerService/userSearch.js[2m:49:21)[22m[2m[22m
[2m      [2mat call ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error in postStatusSearch: Error: Unknown column 'account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:140:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5) {[39m
[31m        code: 'ER_BAD_FIELD_ERROR',[39m
[31m        errno: 1054,[39m
[31m        sql: '\n' +[39m
[31m          '            SELECT id,\n' +[39m
[31m          '                user_name AS username,\n' +[39m
[31m          '                status AS citizenStatus,\n' +[39m
[31m          '                online_status AS onlineStatus\n' +[39m
[31m          '            FROM user\n' +[39m
[31m          '            WHERE status = ?\n' +[39m
[31m          "            AND account_status = 'active';\n" +[39m
[31m          '            ',[39m
[31m        sqlState: '42S22',[39m
[31m        sqlMessage: "Unknown column 'account_status' in 'where clause'"[39m
[31m      }[39m
[2m[22m
[2m    [0m [90m 100 |[39m             [36mreturn[39m [36mawait[39m search[33m.[39mprocessSearch()[33m;[39m[22m
[2m     [90m 101 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 102 |[39m             console[33m.[39merror([32m"Error in postStatusSearch:"[39m[33m,[39m error)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 103 |[39m             [36mthrow[39m error[33m;[39m[22m
[2m     [90m 104 |[39m         }[22m
[2m     [90m 105 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/searchController.js[2m:102:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/searchController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/searchController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/searchController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/searchController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/searchController.js[2m:2:1)[22m[2m[22m

    [2mconsole.log[22m
      UserSearch processSearch called with: null
[2m[22m
[2m      [2mat userSearch.log ([22m[2mservice/searchControllerService/userSearch.js[2m:31:17)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error in userSearch: Error: Invalid userStatus input[39m
[31m          at _callee$ (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/statusSearchStrategy.js:8:19)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/statusSearchStrategy.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/statusSearchStrategy.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/statusSearchStrategy.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/statusSearchStrategy.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/statusSearchStrategy.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/statusSearchStrategy.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at statusSearchStrategy.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/statusSearchStrategy.js:2:1)[39m
[31m          at statusSearchStrategy.apply [as processSearch] (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/statusSearchStrategy.js:6:24)[39m
[31m          at userSearch.processSearch (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:43:50)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at userSearch.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:2:1)[39m
[31m          at userSearch.apply [as processSearch] (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:29:24)[39m
[31m          at processSearch (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:100:33)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at Function.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:2:1)[39m
[31m          at Function.apply [as postStatusSearch] (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:95:34)[39m
[31m          at postStatusSearch (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:270:34)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at Object.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:2:1)[39m
[31m          at Promise.then.completed (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:298:28)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at callAsyncCircusFn (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:231:10)[39m
[31m          at _callCircusTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:316:40)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m          at _runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:252:3)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:126:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at run (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:71:3)[39m
[31m          at runAndTransformResultsToJestFormat (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)[39m
[31m          at jestAdapter (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)[39m
[31m          at runTestInternal (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:367:16)[39m
[31m          at runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:444:34)[39m
[31m          at Object.worker (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/testWorker.js:106:12)[39m
[2m[22m
[2m    [0m [90m 47 |[39m         }[22m
[2m     [90m 48 |[39m         [36mcatch[39m(error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 49 |[39m             console[33m.[39merror([32m'Error in userSearch:'[39m[33m,[39m error)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 50 |[39m             [36mthrow[39m error[33m;[39m[22m
[2m     [90m 51 |[39m         }[22m
[2m     [90m 52 |[39m     }[0m[22m
[2m[22m
[2m      [2mat userSearch.error ([22m[2mservice/searchControllerService/userSearch.js[2m:49:21)[22m[2m[22m
[2m      [2mat call ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error in postStatusSearch: Error: Invalid userStatus input[39m
[31m          at _callee$ (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/statusSearchStrategy.js:8:19)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/statusSearchStrategy.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/statusSearchStrategy.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/statusSearchStrategy.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/statusSearchStrategy.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/statusSearchStrategy.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/statusSearchStrategy.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at statusSearchStrategy.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/statusSearchStrategy.js:2:1)[39m
[31m          at statusSearchStrategy.apply [as processSearch] (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/statusSearchStrategy.js:6:24)[39m
[31m          at userSearch.processSearch (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:43:50)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at userSearch.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:2:1)[39m
[31m          at userSearch.apply [as processSearch] (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:29:24)[39m
[31m          at processSearch (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:100:33)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at Function.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:2:1)[39m
[31m          at Function.apply [as postStatusSearch] (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:95:34)[39m
[31m          at postStatusSearch (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:270:34)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at Object.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:2:1)[39m
[31m          at Promise.then.completed (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:298:28)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at callAsyncCircusFn (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:231:10)[39m
[31m          at _callCircusTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:316:40)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m          at _runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:252:3)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:126:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at run (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:71:3)[39m
[31m          at runAndTransformResultsToJestFormat (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)[39m
[31m          at jestAdapter (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)[39m
[31m          at runTestInternal (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:367:16)[39m
[31m          at runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:444:34)[39m
[31m          at Object.worker (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/testWorker.js:106:12)[39m
[2m[22m
[2m    [0m [90m 100 |[39m             [36mreturn[39m [36mawait[39m search[33m.[39mprocessSearch()[33m;[39m[22m
[2m     [90m 101 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 102 |[39m             console[33m.[39merror([32m"Error in postStatusSearch:"[39m[33m,[39m error)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 103 |[39m             [36mthrow[39m error[33m;[39m[22m
[2m     [90m 104 |[39m         }[22m
[2m     [90m 105 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/searchController.js[2m:102:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/searchController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/searchController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/searchController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/searchController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/searchController.js[2m:2:1)[22m[2m[22m

    [2mconsole.log[22m
      UserSearch processSearch called with: User
[2m[22m
[2m      [2mat userSearch.log ([22m[2mservice/searchControllerService/userSearch.js[2m:31:17)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error executing search query Error: Unknown column 'account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:244:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[2m[22m
[2m    [0m [90m 259 |[39m             }))[33m;[39m[22m
[2m     [90m 260 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 261 |[39m             console[33m.[39merror([32m"Error executing search query"[39m[33m,[39m err[33m.[39mstack)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 262 |[39m             [36mthrow[39m err[33m;[39m[22m
[2m     [90m 263 |[39m         }[22m
[2m     [90m 264 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/userModel.js[2m:261:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error in userSearch: Error: Unknown column 'account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:244:45)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/userModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5) {[39m
[31m        code: 'ER_BAD_FIELD_ERROR',[39m
[31m        errno: 1054,[39m
[31m        sql: '\n' +[39m
[31m          '                SELECT id,\n' +[39m
[31m          '                    user_name AS username,\n' +[39m
[31m          '                    status AS citizenStatus,\n' +[39m
[31m          '                    online_status AS onlineStatus\n' +[39m
[31m          '                FROM user\n' +[39m
[31m          '                WHERE user_name LIKE ?\n' +[39m
[31m          "                AND account_status = 'active';\n" +[39m
[31m          '                ',[39m
[31m        sqlState: '42S22',[39m
[31m        sqlMessage: "Unknown column 'account_status' in 'where clause'"[39m
[31m      }[39m
[2m[22m
[2m    [0m [90m 47 |[39m         }[22m
[2m     [90m 48 |[39m         [36mcatch[39m(error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 49 |[39m             console[33m.[39merror([32m'Error in userSearch:'[39m[33m,[39m error)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 50 |[39m             [36mthrow[39m error[33m;[39m[22m
[2m     [90m 51 |[39m         }[22m
[2m     [90m 52 |[39m     }[0m[22m
[2m[22m
[2m      [2mat userSearch.error ([22m[2mservice/searchControllerService/userSearch.js[2m:49:21)[22m[2m[22m
[2m      [2mat call ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m

    [2mconsole.log[22m
      UserSearch processSearch called with: null
[2m[22m
[2m      [2mat userSearch.log ([22m[2mservice/searchControllerService/userSearch.js[2m:31:17)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error in userSearch: Error: Invalid userName input[39m
[31m          at _callee$ (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/usernameSearchstrategy.js:7:19)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/usernameSearchstrategy.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/usernameSearchstrategy.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/usernameSearchstrategy.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/usernameSearchstrategy.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/usernameSearchstrategy.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/usernameSearchstrategy.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at usernameSearchStrategy.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/usernameSearchstrategy.js:2:1)[39m
[31m          at usernameSearchStrategy.apply [as processSearch] (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/usernameSearchstrategy.js:5:24)[39m
[31m          at userSearch.processSearch (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:41:50)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at userSearch.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:2:1)[39m
[31m          at userSearch.apply [as processSearch] (/Users/shangchienliu/Desktop/f24-fse-sb2/service/searchControllerService/userSearch.js:29:24)[39m
[31m          at processSearch (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:92:29)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at Function.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:2:1)[39m
[31m          at Function.apply [as postUsernameSearch] (/Users/shangchienliu/Desktop/f24-fse-sb2/controllers/searchController.js:88:36)[39m
[31m          at postUsernameSearch (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:302:34)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:2:1)[39m
[31m          at _next (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:2:1)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at Object.<anonymous> (/Users/shangchienliu/Desktop/f24-fse-sb2/tests/integration/searchController.test.js:2:1)[39m
[31m          at Promise.then.completed (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:298:28)[39m
[31m          at new Promise (<anonymous>)[39m
[31m          at callAsyncCircusFn (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/utils.js:231:10)[39m
[31m          at _callCircusTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:316:40)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[31m          at _runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:252:3)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:126:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at _runTestsForDescribeBlock (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:121:9)[39m
[31m          at run (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/run.js:71:3)[39m
[31m          at runAndTransformResultsToJestFormat (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)[39m
[31m          at jestAdapter (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)[39m
[31m          at runTestInternal (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:367:16)[39m
[31m          at runTest (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/runTest.js:444:34)[39m
[31m          at Object.worker (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/jest-runner/build/testWorker.js:106:12)[39m
[2m[22m
[2m    [0m [90m 47 |[39m         }[22m
[2m     [90m 48 |[39m         [36mcatch[39m(error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 49 |[39m             console[33m.[39merror([32m'Error in userSearch:'[39m[33m,[39m error)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 50 |[39m             [36mthrow[39m error[33m;[39m[22m
[2m     [90m 51 |[39m         }[22m
[2m     [90m 52 |[39m     }[0m[22m
[2m[22m
[2m      [2mat userSearch.error ([22m[2mservice/searchControllerService/userSearch.js[2m:49:21)[22m[2m[22m
[2m      [2mat call ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mservice/searchControllerService/userSearch.js[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1msearchController Integration Tests › postAmmouncementSearch › should return formatted announcement search results with wordList, limit, and offset (Positive Case)[39m[22m

    Unknown column 'u.account_status' in 'where clause'
[2m[22m
[2m    [0m [90m 69 |[39m     [22m
[2m     [90m 70 |[39m             [90m// Execute the query with the patterns as input[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 71 |[39m             [36mconst[39m [rows] [33m=[39m [36mawait[39m connection[33m.[39mexecute(query[33m,[39m searchPatterns)[33m;[39m[22m
[2m     [90m    |[39m                                             [31m[1m^[22m[2m[39m[22m
[2m     [90m 72 |[39m             console[33m.[39mlog([32m'Fetched announcements from database:'[39m[33m,[39m rows)[33m;[39m[22m
[2m     [90m 73 |[39m             [36mreturn[39m rows[33m;[39m[22m
[2m     [90m 74 |[39m         } [36mcatch[39m (error) {[0m[22m
[2m[22m
[2m      [2mat PromiseConnection.execute ([22m[2mnode_modules/mysql2/promise.js[2m:112:22)[22m[2m[22m
[2m      [2mat execute ([22m[2mmodels/messageModel.js[2m:71:45)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1msearchController Integration Tests › postPrivateMessageSearch › should return formatted private message search results (Positive Case)[39m[22m

    Unknown column 'u_sender.account_status' in 'where clause'
[2m[22m
[2m    [0m [90m 264 |[39m     [22m
[2m     [90m 265 |[39m             [90m// Execute the query[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 266 |[39m             [36mconst[39m [rows] [33m=[39m [36mawait[39m connection[33m.[39mexecute(query[33m,[39m queryParams)[33m;[39m[22m
[2m     [90m     |[39m                                             [31m[1m^[22m[2m[39m[22m
[2m     [90m 267 |[39m     [22m
[2m     [90m 268 |[39m             [36mreturn[39m rows[33m;[39m[22m
[2m     [90m 269 |[39m         } [36mcatch[39m (error) {[0m[22m
[2m[22m
[2m      [2mat PromiseConnection.execute ([22m[2mnode_modules/mysql2/promise.js[2m:112:22)[22m[2m[22m
[2m      [2mat execute ([22m[2mmodels/messageModel.js[2m:266:45)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1msearchController Integration Tests › postPublicMessageSearch › should return formatted public message search results (Positive Case)[39m[22m

    Unknown column 'u.account_status' in 'where clause'
[2m[22m
[2m    [0m [90m 101 |[39m     [22m
[2m     [90m 102 |[39m             [90m// Execute the query with the patterns as input[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 103 |[39m             [36mconst[39m [rows] [33m=[39m [36mawait[39m connection[33m.[39mexecute(query[33m,[39m searchPatterns)[33m;[39m[22m
[2m     [90m     |[39m                                             [31m[1m^[22m[2m[39m[22m
[2m     [90m 104 |[39m             console[33m.[39mlog([32m'Fetched announcements from database:'[39m[33m,[39m rows)[33m;[39m[22m
[2m     [90m 105 |[39m             [36mreturn[39m rows[33m;[39m[22m
[2m     [90m 106 |[39m         } [36mcatch[39m (error) {[0m[22m
[2m[22m
[2m      [2mat PromiseConnection.execute ([22m[2mnode_modules/mysql2/promise.js[2m:112:22)[22m[2m[22m
[2m      [2mat execute ([22m[2mmodels/messageModel.js[2m:103:45)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1msearchController Integration Tests › postStatusSearch › should return user status search results (Positive Case)[39m[22m

    Unknown column 'account_status' in 'where clause'
[2m[22m
[2m    [0m [90m 138 |[39m[22m
[2m     [90m 139 |[39m             [90m// Execute query with the provided citizen status[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 140 |[39m             [36mconst[39m [rows] [33m=[39m [36mawait[39m connection[33m.[39mexecute(query[33m,[39m [citizenStatus])[33m;[39m[22m
[2m     [90m     |[39m                                             [31m[1m^[22m[2m[39m[22m
[2m     [90m 141 |[39m[22m
[2m     [90m 142 |[39m             [36mif[39m (rows[33m.[39mlength [33m===[39m [35m0[39m) {[22m
[2m     [90m 143 |[39m                 console[33m.[39mlog([32m`No users found with status: ${citizenStatus}`[39m)[33m;[39m[0m[22m
[2m[22m
[2m      [2mat PromiseConnection.execute ([22m[2mnode_modules/mysql2/promise.js[2m:112:22)[22m[2m[22m
[2m      [2mat execute ([22m[2mmodels/userModel.js[2m:140:45)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1msearchController Integration Tests › postUsernameSearch › should return username search results (Positive Case)[39m[22m

    Unknown column 'account_status' in 'where clause'
[2m[22m
[2m    [0m [90m 242 |[39m[22m
[2m     [90m 243 |[39m             [90m// Add wildcards to search for partial matches[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 244 |[39m             [36mconst[39m [rows] [33m=[39m [36mawait[39m connection[33m.[39mexecute(query[33m,[39m [[22m
[2m     [90m     |[39m                                             [31m[1m^[22m[2m[39m[22m
[2m     [90m 245 |[39m                 [32m`%${partialUsername}%`[39m[33m,[39m[22m
[2m     [90m 246 |[39m             ])[33m;[39m[22m
[2m     [90m 247 |[39m[0m[22m
[2m[22m
[2m      [2mat PromiseConnection.execute ([22m[2mnode_modules/mysql2/promise.js[2m:112:22)[22m[2m[22m
[2m      [2mat execute ([22m[2mmodels/userModel.js[2m:244:45)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m

[0m[7m[1m[31m FAIL [39m[22m[27m[0m [2mtests/integration/[22m[1mincidentPostMessageController.test.js[22m ([0m[1m[41m10.204 s[49m[22m[0m)
  [1m● [22mConsole

    [2mconsole.log[22m
      SSH connection established.
[2m[22m
[2m      [2mat Client.log ([22m[2mconfigurations/mysqlDatabase.js[2m:180:25)[22m[2m[22m

    [2mconsole.log[22m
      Connected to database: sb2-test
[2m[22m
[2m      [2mat log ([22m[2mconfigurations/dbConfig.js[2m:62:17)[22m[2m[22m

    [2mconsole.log[22m
      Test database connection established PromiseConnection {
        _events: [Object: null prototype] {
          newListener: [Function (anonymous)],
          removeListener: [Function (anonymous)]
        },
        _eventsCount: 2,
        _maxListeners: undefined,
        connection: Connection {
          _events: [Object: null prototype] { error: [Function] },
          _eventsCount: 1,
          _maxListeners: undefined,
          config: ConnectionConfig {
            isServer: undefined,
            stream: [Channel],
            host: 'localhost',
            port: 3306,
            localAddress: undefined,
            socketPath: undefined,
            user: 'root',
            password: 'Pqtu9baKLwwHC&Pq',
            password2: undefined,
            password3: undefined,
            passwordSha1: undefined,
            database: 'sb2-test',
            connectTimeout: 10000,
            insecureAuth: false,
            infileStreamFactory: undefined,
            supportBigNumbers: false,
            bigNumberStrings: false,
            decimalNumbers: false,
            dateStrings: false,
            debug: undefined,
            trace: true,
            stringifyObjects: false,
            enableKeepAlive: true,
            keepAliveInitialDelay: undefined,
            timezone: 'local',
            queryFormat: undefined,
            pool: undefined,
            ssl: false,
            multipleStatements: true,
            rowsAsArray: false,
            namedPlaceholders: false,
            nestTables: undefined,
            typeCast: true,
            maxPacketSize: 0,
            charsetNumber: 224,
            compress: false,
            authPlugins: undefined,
            authSwitchHandler: undefined,
            clientFlags: 12317647,
            connectAttributes: [Object],
            maxPreparedStatements: 16000,
            jsonStrings: false
          },
          stream: <ref *1> Channel {
            _events: [Object],
            _readableState: [ReadableState],
            _writableState: [WritableState],
            allowHalfOpen: true,
            _maxListeners: undefined,
            server: false,
            type: 'direct-tcpip',
            subtype: undefined,
            incoming: [Object],
            outgoing: [Object],
            _callbacks: [],
            _client: [Client],
            _hasX11: false,
            _exit: [Object],
            stdout: [Circular *1],
            stdin: [Circular *1],
            stderr: [ClientStderr],
            _waitWindow: false,
            _waitChanDrain: false,
            _chunk: undefined,
            _chunkcb: undefined,
            _chunkErr: undefined,
            _chunkcbErr: undefined,
            _eventsCount: 6,
            [Symbol(shapeMode)]: true,
            [Symbol(kCapture)]: false
          },
          _internalId: 0,
          _commands: Denque {
            _capacity: undefined,
            _head: 0,
            _tail: 0,
            _capacityMask: 3,
            _list: [Array]
          },
          _command: undefined,
          _paused: false,
          _paused_packets: Denque {
            _capacity: undefined,
            _head: 0,
            _tail: 0,
            _capacityMask: 3,
            _list: [Array]
          },
          _statements: {
            set: [Function: set],
            get: [Function: get],
            peek: [Function: peek],
            has: [Function: has],
            keys: [GeneratorFunction: keys],
            values: [GeneratorFunction: values],
            entries: [GeneratorFunction: entries],
            forEach: [Function: forEach],
            delete: [Function: delete],
            evict: [Function: evict],
            clear: [Function: clear],
            resize: [Function: resize],
            max: [Getter],
            size: [Getter],
            available: [Getter]
          },
          serverCapabilityFlags: 3758096383,
          authorized: true,
          sequenceId: 6,
          compressedSequenceId: 0,
          threadId: 3187,
          _handshakePacket: Handshake {
            protocolVersion: 10,
            serverVersion: '8.0.39',
            capabilityFlags: 3758096383,
            connectionId: 3187,
            authPluginData1: <Buffer 1a 03 71 1f 4a 36 5d 22>,
            authPluginData2: <Buffer 37 54 0f 60 6c 69 60 7f 02 3b 38 50 00>,
            characterSet: 255,
            statusFlags: 2,
            autPluginName: 'caching_sha2_password'
          },
          _fatalError: null,
          _protocolError: null,
          _outOfOrderPackets: [],
          clientEncoding: 'utf8',
          packetParser: PacketParser {
            buffer: [],
            bufferLength: 0,
            packetHeaderLength: 4,
            headerLen: 0,
            length: 5,
            largePacketParts: [],
            firstPacketSequenceId: 0,
            onPacket: [Function (anonymous)],
            execute: [Function: executeStart],
            _flushLargePacket: [Function: _flushLargePacket4]
          },
          serverEncoding: 'utf8',
          connectTimeout: null,
          connectionId: 3187,
          _authPlugin: [Function (anonymous)],
          [Symbol(shapeMode)]: false,
          [Symbol(kCapture)]: false
        },
        Promise: [Function: Promise],
        [Symbol(shapeMode)]: false,
        [Symbol(kCapture)]: false
      }
[2m[22m
[2m      [2mat log ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:12:13)[22m[2m[22m

    [2mconsole.log[22m
      Inserted test data before each test
[2m[22m
[2m      [2mat log ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:50:13)[22m[2m[22m

    [2mconsole.log[22m
      Connected to database in setDatabaseconnection: sb2
[2m[22m
[2m      [2mat log ([22m[2mconfigurations/dbConfig.js[2m:31:17)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching incident posts with images: Error: Unknown column 'u.account_status' in 'where clause'[39m
[31m          at PromiseConnection.query (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:94:22)[39m
[31m          at query (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:205:40)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5) {[39m
[31m        code: 'ER_BAD_FIELD_ERROR',[39m
[31m        errno: 1054,[39m
[31m        sql: '\n' +[39m
[31m          '                SELECT \n' +[39m
[31m          '                    ip.id AS incidentId,\n' +[39m
[31m          '                    ip.title AS incidentTitle,\n' +[39m
[31m          '                    ip.details AS incidentDetails,\n' +[39m
[31m          '                    u.user_name AS username,\n' +[39m
[31m          '                    ip.sender_status AS userstatus,\n' +[39m
[31m          '                    ip.timestamp AS incidentTimestamp,\n' +[39m
[31m          '                    ip.resource_details AS resourceDetails,\n' +[39m
[31m          '                    img.image_name AS imageName,\n' +[39m
[31m          '                    img.type AS imageType\n' +[39m
[31m          '                FROM incidentPost ip\n' +[39m
[31m          '                LEFT JOIN image img ON ip.id = img.incidentPost_id\n' +[39m
[31m          '                JOIN user u ON ip.sender_id = u.id\n' +[39m
[31m          "                WHERE u.account_status = 'active'\n" +[39m
[31m          '                ORDER BY ip.timestamp DESC;\n' +[39m
[31m          '            ',[39m
[31m        sqlState: '42S22',[39m
[31m        sqlMessage: "Unknown column 'u.account_status' in 'where clause'"[39m
[31m      }[39m
[2m[22m
[2m    [0m [90m 253 |[39m             [36mreturn[39m [33mArray[39m[33m.[39m[36mfrom[39m(postMap[33m.[39mvalues())[33m;[39m[22m
[2m     [90m 254 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 255 |[39m             console[33m.[39merror([32m"Error fetching incident posts with images:"[39m[33m,[39m err)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 256 |[39m             [36mthrow[39m [36mnew[39m [33mError[39m([32m"Failed to retrieve incident posts"[39m)[33m;[39m[22m
[2m     [90m 257 |[39m         }[22m
[2m     [90m 258 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/incidentPostModel.js[2m:255:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching incident posts: Error: Failed to retrieve incident posts[39m
[31m          at _callee6$ (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:256:19)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at Generator._invoke [as throw] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[2m[22m
[2m    [0m [90m 14 |[39m       [36mreturn[39m res[33m.[39mstatus([35m200[39m)[33m.[39mjson({ message[33m:[39m [32m"Incident posts retrieved successfully"[39m[33m,[39m data[33m:[39m posts })[33m;[39m[22m
[2m     [90m 15 |[39m     } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 16 |[39m       console[33m.[39merror([32m"Error fetching incident posts:"[39m[33m,[39m err)[33m;[39m[22m
[2m     [90m    |[39m               [31m[1m^[22m[2m[39m[22m
[2m     [90m 17 |[39m       [36mreturn[39m res[33m.[39mstatus([35m500[39m)[33m.[39mjson({ message[33m:[39m [32m"An error occurred while fetching incident posts"[39m })[33m;[39m[22m
[2m     [90m 18 |[39m     }[22m
[2m     [90m 19 |[39m   }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/incidentPostMessageController.js[2m:16:15)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/incidentPostMessageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/incidentPostMessageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/incidentPostMessageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/incidentPostMessageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/incidentPostMessageController.js[2m:2:1)[22m[2m[22m

    [2mconsole.log[22m
      Removed test data after each test
[2m[22m
[2m      [2mat log ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:58:15)[22m[2m[22m

    [2mconsole.log[22m
      Inserted test data before each test
[2m[22m
[2m      [2mat log ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:50:13)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching incident posts with images: Error: Unknown column 'u.account_status' in 'where clause'[39m
[31m          at PromiseConnection.query (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:94:22)[39m
[31m          at query (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:205:40)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5) {[39m
[31m        code: 'ER_BAD_FIELD_ERROR',[39m
[31m        errno: 1054,[39m
[31m        sql: '\n' +[39m
[31m          '                SELECT \n' +[39m
[31m          '                    ip.id AS incidentId,\n' +[39m
[31m          '                    ip.title AS incidentTitle,\n' +[39m
[31m          '                    ip.details AS incidentDetails,\n' +[39m
[31m          '                    u.user_name AS username,\n' +[39m
[31m          '                    ip.sender_status AS userstatus,\n' +[39m
[31m          '                    ip.timestamp AS incidentTimestamp,\n' +[39m
[31m          '                    ip.resource_details AS resourceDetails,\n' +[39m
[31m          '                    img.image_name AS imageName,\n' +[39m
[31m          '                    img.type AS imageType\n' +[39m
[31m          '                FROM incidentPost ip\n' +[39m
[31m          '                LEFT JOIN image img ON ip.id = img.incidentPost_id\n' +[39m
[31m          '                JOIN user u ON ip.sender_id = u.id\n' +[39m
[31m          "                WHERE u.account_status = 'active'\n" +[39m
[31m          '                ORDER BY ip.timestamp DESC;\n' +[39m
[31m          '            ',[39m
[31m        sqlState: '42S22',[39m
[31m        sqlMessage: "Unknown column 'u.account_status' in 'where clause'"[39m
[31m      }[39m
[2m[22m
[2m    [0m [90m 253 |[39m             [36mreturn[39m [33mArray[39m[33m.[39m[36mfrom[39m(postMap[33m.[39mvalues())[33m;[39m[22m
[2m     [90m 254 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 255 |[39m             console[33m.[39merror([32m"Error fetching incident posts with images:"[39m[33m,[39m err)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 256 |[39m             [36mthrow[39m [36mnew[39m [33mError[39m([32m"Failed to retrieve incident posts"[39m)[33m;[39m[22m
[2m     [90m 257 |[39m         }[22m
[2m     [90m 258 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/incidentPostModel.js[2m:255:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching incident posts: Error: Failed to retrieve incident posts[39m
[31m          at _callee6$ (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:256:19)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at Generator._invoke [as throw] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[2m[22m
[2m    [0m [90m 14 |[39m       [36mreturn[39m res[33m.[39mstatus([35m200[39m)[33m.[39mjson({ message[33m:[39m [32m"Incident posts retrieved successfully"[39m[33m,[39m data[33m:[39m posts })[33m;[39m[22m
[2m     [90m 15 |[39m     } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 16 |[39m       console[33m.[39merror([32m"Error fetching incident posts:"[39m[33m,[39m err)[33m;[39m[22m
[2m     [90m    |[39m               [31m[1m^[22m[2m[39m[22m
[2m     [90m 17 |[39m       [36mreturn[39m res[33m.[39mstatus([35m500[39m)[33m.[39mjson({ message[33m:[39m [32m"An error occurred while fetching incident posts"[39m })[33m;[39m[22m
[2m     [90m 18 |[39m     }[22m
[2m     [90m 19 |[39m   }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/incidentPostMessageController.js[2m:16:15)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/incidentPostMessageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/incidentPostMessageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/incidentPostMessageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/incidentPostMessageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/incidentPostMessageController.js[2m:2:1)[22m[2m[22m

    [2mconsole.log[22m
      Removed test data after each test
[2m[22m
[2m      [2mat log ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:58:15)[22m[2m[22m

    [2mconsole.log[22m
      Inserted test data before each test
[2m[22m
[2m      [2mat log ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:50:13)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching incident post by ID: Error: Unknown column 'u.account_status' in 'where clause'[39m
[31m          at PromiseConnection.query (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:94:22)[39m
[31m          at query (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:266:41)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5) {[39m
[31m        code: 'ER_BAD_FIELD_ERROR',[39m
[31m        errno: 1054,[39m
[31m        sql: '\n' +[39m
[31m          '                    SELECT ip.id,\n' +[39m
[31m          '                        ip.title,\n' +[39m
[31m          '                        ip.details,\n' +[39m
[31m          '                        u.user_name AS sender_name,\n' +[39m
[31m          '                        u.status AS sender_status,\n' +[39m
[31m          '                        ip.timestamp,\n' +[39m
[31m          '                        ip.resource_details\n' +[39m
[31m          '                    FROM incidentPost ip\n' +[39m
[31m          '                    JOIN user u ON ip.sender_id = u.id\n' +[39m
[31m          '                    WHERE ip.id = 1104\n' +[39m
[31m          "                    AND u.account_status = 'active';\n" +[39m
[31m          '                ',[39m
[31m        sqlState: '42S22',[39m
[31m        sqlMessage: "Unknown column 'u.account_status' in 'where clause'"[39m
[31m      }[39m
[2m[22m
[2m    [0m [90m 288 |[39m             [36mreturn[39m post[33m;[39m[22m
[2m     [90m 289 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 290 |[39m             console[33m.[39merror([32m"Error fetching incident post by ID:"[39m[33m,[39m err)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 291 |[39m             [36mthrow[39m [36mnew[39m [33mError[39m([32m"Failed to retrieve the incident post"[39m)[33m;[39m[22m
[2m     [90m 292 |[39m         }[22m
[2m     [90m 293 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/incidentPostModel.js[2m:290:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching incident post by ID: Error: Failed to retrieve the incident post[39m
[31m          at _callee7$ (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:291:19)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at Generator._invoke [as throw] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[2m[22m
[2m    [0m [90m 34 |[39m       [36mreturn[39m res[33m.[39mstatus([35m200[39m)[33m.[39mjson({ message[33m:[39m [32m"Incident post retrieved successfully"[39m[33m,[39m data[33m:[39m post })[33m;[39m[22m
[2m     [90m 35 |[39m     } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 36 |[39m       console[33m.[39merror([32m"Error fetching incident post by ID:"[39m[33m,[39m err)[33m;[39m[22m
[2m     [90m    |[39m               [31m[1m^[22m[2m[39m[22m
[2m     [90m 37 |[39m       [36mreturn[39m res[33m.[39mstatus([35m500[39m)[33m.[39mjson({ message[33m:[39m [32m"An error occurred while fetching the incident post"[39m })[33m;[39m[22m
[2m     [90m 38 |[39m     }[22m
[2m     [90m 39 |[39m   }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/incidentPostMessageController.js[2m:36:15)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/incidentPostMessageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/incidentPostMessageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/incidentPostMessageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/incidentPostMessageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/incidentPostMessageController.js[2m:2:1)[22m[2m[22m

    [2mconsole.log[22m
      Removed test data after each test
[2m[22m
[2m      [2mat log ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:58:15)[22m[2m[22m

    [2mconsole.log[22m
      Inserted test data before each test
[2m[22m
[2m      [2mat log ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:50:13)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching incident post by ID: Error: Unknown column 'u.account_status' in 'where clause'[39m
[31m          at PromiseConnection.query (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:94:22)[39m
[31m          at query (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:266:41)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5) {[39m
[31m        code: 'ER_BAD_FIELD_ERROR',[39m
[31m        errno: 1054,[39m
[31m        sql: '\n' +[39m
[31m          '                    SELECT ip.id,\n' +[39m
[31m          '                        ip.title,\n' +[39m
[31m          '                        ip.details,\n' +[39m
[31m          '                        u.user_name AS sender_name,\n' +[39m
[31m          '                        u.status AS sender_status,\n' +[39m
[31m          '                        ip.timestamp,\n' +[39m
[31m          '                        ip.resource_details\n' +[39m
[31m          '                    FROM incidentPost ip\n' +[39m
[31m          '                    JOIN user u ON ip.sender_id = u.id\n' +[39m
[31m          '                    WHERE ip.id = 99999\n' +[39m
[31m          "                    AND u.account_status = 'active';\n" +[39m
[31m          '                ',[39m
[31m        sqlState: '42S22',[39m
[31m        sqlMessage: "Unknown column 'u.account_status' in 'where clause'"[39m
[31m      }[39m
[2m[22m
[2m    [0m [90m 288 |[39m             [36mreturn[39m post[33m;[39m[22m
[2m     [90m 289 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 290 |[39m             console[33m.[39merror([32m"Error fetching incident post by ID:"[39m[33m,[39m err)[33m;[39m[22m
[2m     [90m     |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 291 |[39m             [36mthrow[39m [36mnew[39m [33mError[39m([32m"Failed to retrieve the incident post"[39m)[33m;[39m[22m
[2m     [90m 292 |[39m         }[22m
[2m     [90m 293 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/incidentPostModel.js[2m:290:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching incident post by ID: Error: Failed to retrieve the incident post[39m
[31m          at _callee7$ (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:291:19)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at Generator._invoke [as throw] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[2m[22m
[2m    [0m [90m 34 |[39m       [36mreturn[39m res[33m.[39mstatus([35m200[39m)[33m.[39mjson({ message[33m:[39m [32m"Incident post retrieved successfully"[39m[33m,[39m data[33m:[39m post })[33m;[39m[22m
[2m     [90m 35 |[39m     } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 36 |[39m       console[33m.[39merror([32m"Error fetching incident post by ID:"[39m[33m,[39m err)[33m;[39m[22m
[2m     [90m    |[39m               [31m[1m^[22m[2m[39m[22m
[2m     [90m 37 |[39m       [36mreturn[39m res[33m.[39mstatus([35m500[39m)[33m.[39mjson({ message[33m:[39m [32m"An error occurred while fetching the incident post"[39m })[33m;[39m[22m
[2m     [90m 38 |[39m     }[22m
[2m     [90m 39 |[39m   }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/incidentPostMessageController.js[2m:36:15)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/incidentPostMessageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/incidentPostMessageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/incidentPostMessageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/incidentPostMessageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/incidentPostMessageController.js[2m:2:1)[22m[2m[22m

    [2mconsole.log[22m
      Removed test data after each test
[2m[22m
[2m      [2mat log ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:58:15)[22m[2m[22m

    [2mconsole.log[22m
      Inserted test data before each test
[2m[22m
[2m      [2mat log ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:50:13)[22m[2m[22m

    [2mconsole.log[22m
      Removed test data after each test
[2m[22m
[2m      [2mat log ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:58:15)[22m[2m[22m

    [2mconsole.log[22m
      Inserted test data before each test
[2m[22m
[2m      [2mat log ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:50:13)[22m[2m[22m

    [2mconsole.log[22m
      1107
[2m[22m
[2m      [2mat log ([22m[2mcontrollers/incidentPostMessageController.js[2m:47:17)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching incident post messages: Error: Unknown column 'u.account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostMessageModel.js:68:37)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostMessageModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostMessageModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostMessageModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostMessageModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostMessageModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5) {[39m
[31m        code: 'ER_BAD_FIELD_ERROR',[39m
[31m        errno: 1054,[39m
[31m        sql: '\n' +[39m
[31m          '                    SELECT im.id,\n' +[39m
[31m          '                        im.text,\n' +[39m
[31m          '                        im.sent_time,\n' +[39m
[31m          '                        u.user_name AS sender_name,\n' +[39m
[31m          '                        u.status AS sender_status,\n' +[39m
[31m          '                        im.incidentPost_id\n' +[39m
[31m          '                    FROM incidentMessage im\n' +[39m
[31m          '                    JOIN user u ON im.sender_id = u.id\n' +[39m
[31m          '                    WHERE im.incidentPost_id = ?\n' +[39m
[31m          "                    AND u.account_status = 'active';\n" +[39m
[31m          '                 ',[39m
[31m        sqlState: '42S22',[39m
[31m        sqlMessage: "Unknown column 'u.account_status' in 'where clause'"[39m
[31m      }[39m
[2m[22m
[2m    [0m [90m 87 |[39m                 [36mthrow[39m err[33m;[39m[22m
[2m     [90m 88 |[39m             }[22m
[2m    [31m[1m>[22m[2m[39m[90m 89 |[39m             console[33m.[39merror([32m"Error fetching incident post messages:"[39m[33m,[39m err)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 90 |[39m             [36mthrow[39m [36mnew[39m [33mError[39m([32m"An error occurred while fetching incident messages"[39m)[33m;[39m[22m
[2m     [90m 91 |[39m         }[22m
[2m     [90m 92 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/incidentPostMessageModel.js[2m:89:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/incidentPostMessageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/incidentPostMessageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/incidentPostMessageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostMessageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostMessageModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching incident responses: Error: An error occurred while fetching incident messages[39m
[31m          at _callee2$ (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostMessageModel.js:90:19)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostMessageModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostMessageModel.js:2:1)[39m
[31m          at Generator._invoke [as throw] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostMessageModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostMessageModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostMessageModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[2m[22m
[2m    [0m [90m 68 |[39m         })[33m;[39m[22m
[2m     [90m 69 |[39m     } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 70 |[39m         console[33m.[39merror([32m"Error fetching incident responses:"[39m[33m,[39m err)[33m;[39m[22m
[2m     [90m    |[39m                 [31m[1m^[22m[2m[39m[22m
[2m     [90m 71 |[39m         [36mreturn[39m res[33m.[39mstatus([35m500[39m)[33m.[39mjson({[22m
[2m     [90m 72 |[39m             message[33m:[39m [32m"An error occurred while fetching incident responses"[39m[33m,[39m[22m
[2m     [90m 73 |[39m         })[33m;[39m[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/incidentPostMessageController.js[2m:70:17)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/incidentPostMessageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/incidentPostMessageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/incidentPostMessageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/incidentPostMessageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/incidentPostMessageController.js[2m:2:1)[22m[2m[22m

    [2mconsole.log[22m
      Removed test data after each test
[2m[22m
[2m      [2mat log ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:58:15)[22m[2m[22m

    [2mconsole.log[22m
      Inserted test data before each test
[2m[22m
[2m      [2mat log ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:50:13)[22m[2m[22m

    [2mconsole.log[22m
      9999999
[2m[22m
[2m      [2mat log ([22m[2mcontrollers/incidentPostMessageController.js[2m:47:17)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching incident post messages: Error: Unknown column 'u.account_status' in 'where clause'[39m
[31m          at PromiseConnection.execute (/Users/shangchienliu/Desktop/f24-fse-sb2/node_modules/mysql2/promise.js:112:22)[39m
[31m          at execute (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostMessageModel.js:68:37)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostMessageModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostMessageModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostMessageModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostMessageModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostMessageModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5) {[39m
[31m        code: 'ER_BAD_FIELD_ERROR',[39m
[31m        errno: 1054,[39m
[31m        sql: '\n' +[39m
[31m          '                    SELECT im.id,\n' +[39m
[31m          '                        im.text,\n' +[39m
[31m          '                        im.sent_time,\n' +[39m
[31m          '                        u.user_name AS sender_name,\n' +[39m
[31m          '                        u.status AS sender_status,\n' +[39m
[31m          '                        im.incidentPost_id\n' +[39m
[31m          '                    FROM incidentMessage im\n' +[39m
[31m          '                    JOIN user u ON im.sender_id = u.id\n' +[39m
[31m          '                    WHERE im.incidentPost_id = ?\n' +[39m
[31m          "                    AND u.account_status = 'active';\n" +[39m
[31m          '                 ',[39m
[31m        sqlState: '42S22',[39m
[31m        sqlMessage: "Unknown column 'u.account_status' in 'where clause'"[39m
[31m      }[39m
[2m[22m
[2m    [0m [90m 87 |[39m                 [36mthrow[39m err[33m;[39m[22m
[2m     [90m 88 |[39m             }[22m
[2m    [31m[1m>[22m[2m[39m[90m 89 |[39m             console[33m.[39merror([32m"Error fetching incident post messages:"[39m[33m,[39m err)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 90 |[39m             [36mthrow[39m [36mnew[39m [33mError[39m([32m"An error occurred while fetching incident messages"[39m)[33m;[39m[22m
[2m     [90m 91 |[39m         }[22m
[2m     [90m 92 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/incidentPostMessageModel.js[2m:89:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/incidentPostMessageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/incidentPostMessageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mmodels/incidentPostMessageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostMessageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostMessageModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error fetching incident responses: Error: An error occurred while fetching incident messages[39m
[31m          at _callee2$ (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostMessageModel.js:90:19)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostMessageModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostMessageModel.js:2:1)[39m
[31m          at Generator._invoke [as throw] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostMessageModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostMessageModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostMessageModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[2m[22m
[2m    [0m [90m 68 |[39m         })[33m;[39m[22m
[2m     [90m 69 |[39m     } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 70 |[39m         console[33m.[39merror([32m"Error fetching incident responses:"[39m[33m,[39m err)[33m;[39m[22m
[2m     [90m    |[39m                 [31m[1m^[22m[2m[39m[22m
[2m     [90m 71 |[39m         [36mreturn[39m res[33m.[39mstatus([35m500[39m)[33m.[39mjson({[22m
[2m     [90m 72 |[39m             message[33m:[39m [32m"An error occurred while fetching incident responses"[39m[33m,[39m[22m
[2m     [90m 73 |[39m         })[33m;[39m[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/incidentPostMessageController.js[2m:70:17)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/incidentPostMessageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/incidentPostMessageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/incidentPostMessageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/incidentPostMessageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/incidentPostMessageController.js[2m:2:1)[22m[2m[22m

    [2mconsole.log[22m
      Removed test data after each test
[2m[22m
[2m      [2mat log ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:58:15)[22m[2m[22m

    [2mconsole.log[22m
      Inserted test data before each test
[2m[22m
[2m      [2mat log ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:50:13)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error creating incident message: User 'testuser' not found.[39m
[2m[22m
[2m    [0m [90m 58 |[39m             [36mreturn[39m rows[[35m0[39m][33m;[39m[22m
[2m     [90m 59 |[39m         } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 60 |[39m             console[33m.[39merror([32m"Error creating incident message:"[39m[33m,[39m err[33m.[39mmessage)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 61 |[39m             [36mthrow[39m [36mnew[39m [33mError[39m([32m"An error occurred while creating the incident message"[39m)[33m;[39m[22m
[2m     [90m 62 |[39m         }        [22m
[2m     [90m 63 |[39m     }[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mmodels/incidentPostMessageModel.js[2m:60:21)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/incidentPostMessageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/incidentPostMessageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mmodels/incidentPostMessageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostMessageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostMessageModel.js[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error creating incident response: Error: An error occurred while creating the incident message[39m
[31m          at _callee$ (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostMessageModel.js:61:19)[39m
[31m          at call (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostMessageModel.js:2:1)[39m
[31m          at Generator.tryCatch (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostMessageModel.js:2:1)[39m
[31m          at Generator._invoke [as next] (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostMessageModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostMessageModel.js:2:1)[39m
[31m          at asyncGeneratorStep (/Users/shangchienliu/Desktop/f24-fse-sb2/models/incidentPostMessageModel.js:2:1)[39m
[31m          at processTicksAndRejections (node:internal/process/task_queues:95:5)[39m
[2m[22m
[2m    [0m [90m 106 |[39m           })[33m;[39m[22m
[2m     [90m 107 |[39m       } [36mcatch[39m (err) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 108 |[39m           console[33m.[39merror([32m"Error creating incident response:"[39m[33m,[39m err)[33m;[39m[22m
[2m     [90m     |[39m                   [31m[1m^[22m[2m[39m[22m
[2m     [90m 109 |[39m[22m
[2m     [90m 110 |[39m           [90m// Return error response[39m[22m
[2m     [90m 111 |[39m           [36mreturn[39m res[33m.[39mstatus([35m500[39m)[33m.[39mjson({[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/incidentPostMessageController.js[2m:108:19)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/incidentPostMessageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/incidentPostMessageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as throw] ([22m[2mcontrollers/incidentPostMessageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/incidentPostMessageController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/incidentPostMessageController.js[2m:2:1)[22m[2m[22m

    [2mconsole.log[22m
      Removed test data after each test
[2m[22m
[2m      [2mat log ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:58:15)[22m[2m[22m

    [2mconsole.log[22m
      Inserted test data before each test
[2m[22m
[2m      [2mat log ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:50:13)[22m[2m[22m

    [2mconsole.log[22m
      Removed test data after each test
[2m[22m
[2m      [2mat log ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:58:15)[22m[2m[22m

    [2mconsole.log[22m
      Test database connection closed
[2m[22m
[2m      [2mat log ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:69:15)[22m[2m[22m

[1m[31m  [1m● [22m[1mIncidentPostMessageController Integration Tests › getIncidentPosts › should fetch all incident posts with associated images[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 77 |[39m       [36mawait[39m [33mIncidentPostMessageController[39m[33m.[39mgetIncidentPosts(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 78 |[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 79 |[39m       expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m    |[39m                          [31m[1m^[22m[2m[39m[22m
[2m     [90m 80 |[39m       expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39mobjectContaining({[22m
[2m     [90m 81 |[39m         message[33m:[39m [32m"Incident posts retrieved successfully"[39m[33m,[39m[22m
[2m     [90m 82 |[39m         data[33m:[39m expect[33m.[39many([33mArray[39m)[33m,[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:79:26)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mIncidentPostMessageController Integration Tests › getIncidentPosts › should return 404 if no incident posts exist[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m404[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 90 |[39m       [36mawait[39m [33mIncidentPostMessageController[39m[33m.[39mgetIncidentPosts(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 91 |[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 92 |[39m       expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m404[39m)[33m;[39m[22m
[2m     [90m    |[39m                          [31m[1m^[22m[2m[39m[22m
[2m     [90m 93 |[39m       expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39mobjectContaining({[22m
[2m     [90m 94 |[39m         message[33m:[39m [32m"No incident posts found"[39m[33m,[39m[22m
[2m     [90m 95 |[39m       }))[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:92:26)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mIncidentPostMessageController Integration Tests › getIncidentPostByID › should fetch a single incident post by its ID[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 103 |[39m       [36mawait[39m [33mIncidentPostMessageController[39m[33m.[39mgetIncidentPostByID(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 104 |[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 105 |[39m       expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m     |[39m                          [31m[1m^[22m[2m[39m[22m
[2m     [90m 106 |[39m       expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39mobjectContaining({[22m
[2m     [90m 107 |[39m         message[33m:[39m [32m"Incident post retrieved successfully"[39m[33m,[39m[22m
[2m     [90m 108 |[39m         data[33m:[39m expect[33m.[39mobjectContaining({[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:105:26)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mIncidentPostMessageController Integration Tests › getIncidentPostByID › should return 404 if the incident post does not exist[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m404[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 117 |[39m       [36mawait[39m [33mIncidentPostMessageController[39m[33m.[39mgetIncidentPostByID(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 118 |[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 119 |[39m       expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m404[39m)[33m;[39m[22m
[2m     [90m     |[39m                          [31m[1m^[22m[2m[39m[22m
[2m     [90m 120 |[39m       expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39mobjectContaining({[22m
[2m     [90m 121 |[39m         message[33m:[39m [32m"Incident post not found"[39m[33m,[39m[22m
[2m     [90m 122 |[39m       }))[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:119:26)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mIncidentPostMessageController Integration Tests › getIncidentCommentByincidentID › should fetch all responses for a specific incident post[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 141 |[39m       [36mawait[39m [33mIncidentPostMessageController[39m[33m.[39mgetIncidentCommentByincidentID(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 142 |[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 143 |[39m       expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m     |[39m                          [31m[1m^[22m[2m[39m[22m
[2m     [90m 144 |[39m       expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39mobjectContaining({[22m
[2m     [90m 145 |[39m         message[33m:[39m [32m"Incident responses retrieved successfully"[39m[33m,[39m[22m
[2m     [90m 146 |[39m         data[33m:[39m expect[33m.[39many([33mArray[39m)[33m,[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:143:26)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mIncidentPostMessageController Integration Tests › getIncidentCommentByincidentID › should return 404 if no responses exist for the incident post[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m404[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 156 |[39m       [36mawait[39m [33mIncidentPostMessageController[39m[33m.[39mgetIncidentCommentByincidentID(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 157 |[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 158 |[39m       expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m404[39m)[33m;[39m[22m
[2m     [90m     |[39m                          [31m[1m^[22m[2m[39m[22m
[2m     [90m 159 |[39m       expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39mobjectContaining({[22m
[2m     [90m 160 |[39m         message[33m:[39m [32m"No incident responses found"[39m[33m,[39m[22m
[2m     [90m 161 |[39m       }))[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:158:26)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mIncidentPostMessageController Integration Tests › newIncidentCommentByincidentID › should create a new response for an incident post[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m201[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 174 |[39m       [36mawait[39m [33mIncidentPostMessageController[39m[33m.[39mnewIncidentCommentByincidentID(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 175 |[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 176 |[39m       expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m201[39m)[33m;[39m[22m
[2m     [90m     |[39m                          [31m[1m^[22m[2m[39m[22m
[2m     [90m 177 |[39m       expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39mobjectContaining({[22m
[2m     [90m 178 |[39m         message[33m:[39m [32m"Incident response created successfully"[39m[33m,[39m[22m
[2m     [90m 179 |[39m         data[33m:[39m expect[33m.[39mobjectContaining({[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:176:26)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[0m[7m[1m[32m PASS [39m[22m[27m[0m [2mtests/integration/[22m[1mmapResourceController.test.js[22m
  [1m● [22mConsole

    [2mconsole.log[22m
      SSH connection established.
[2m[22m
[2m      [2mat Client.log ([22m[2mconfigurations/mysqlDatabase.js[2m:180:25)[22m[2m[22m

    [2mconsole.log[22m
      Connected to database: sb2-test
[2m[22m
[2m      [2mat log ([22m[2mconfigurations/dbConfig.js[2m:62:17)[22m[2m[22m

    [2mconsole.log[22m
      Connected to database in setDatabaseconnection: sb2
[2m[22m
[2m      [2mat log ([22m[2mconfigurations/dbConfig.js[2m:31:17)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error adding resource: All fields (title, description, latitude, longitude) are required.[39m
[2m[22m
[2m    [0m [90m 35 |[39m             })[33m;[39m[22m
[2m     [90m 36 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 37 |[39m             console[33m.[39merror([32m"Error adding resource:"[39m[33m,[39m error[33m.[39mmessage)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 38 |[39m             res[33m.[39mstatus([35m500[39m)[33m.[39mjson({[22m
[2m     [90m 39 |[39m                 message[33m:[39m [32m"Error adding resource"[39m[33m,[39m[22m
[2m     [90m 40 |[39m                 error[33m:[39m error[33m.[39mmessage[33m,[39m[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/mapResourceController.js[2m:37:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/mapResourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/mapResourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mcontrollers/mapResourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/mapResourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/mapResourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat _next ([22m[2mcontrollers/mapResourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Function.<anonymous> ([22m[2mcontrollers/mapResourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Function.apply [as addResource] ([22m[2mcontrollers/mapResourceController.js[2m:22:29)[22m[2m[22m
[2m      [2mat addResource ([22m[2m[0m[36mtests/integration/mapResourceController.test.js[39m[0m[2m:150:41)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/mapResourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/mapResourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/mapResourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/mapResourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/mapResourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat _next ([22m[2m[0m[36mtests/integration/mapResourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Object.<anonymous> ([22m[2m[0m[36mtests/integration/mapResourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error updating resource location: Latitude and Longitude are required.[39m
[2m[22m
[2m    [0m [90m 64 |[39m             })[33m;[39m[22m
[2m     [90m 65 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 66 |[39m             console[33m.[39merror([32m"Error updating resource location:"[39m[33m,[39m error[33m.[39mmessage)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 67 |[39m             res[33m.[39mstatus([35m500[39m)[33m.[39mjson({[22m
[2m     [90m 68 |[39m                 message[33m:[39m [32m"Error updating resource location"[39m[33m,[39m[22m
[2m     [90m 69 |[39m                 error[33m:[39m error[33m.[39mmessage[33m,[39m[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/mapResourceController.js[2m:66:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/mapResourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/mapResourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mcontrollers/mapResourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/mapResourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/mapResourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat _next ([22m[2mcontrollers/mapResourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Function.<anonymous> ([22m[2mcontrollers/mapResourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Function.apply [as updateResourceLocation] ([22m[2mcontrollers/mapResourceController.js[2m:46:40)[22m[2m[22m
[2m      [2mat updateResourceLocation ([22m[2m[0m[36mtests/integration/mapResourceController.test.js[39m[0m[2m:202:41)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/mapResourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/mapResourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/mapResourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/mapResourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/mapResourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat _next ([22m[2m[0m[36mtests/integration/mapResourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Object.<anonymous> ([22m[2m[0m[36mtests/integration/mapResourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m

    [2m[31mconsole.error[39m[22m
[31m      Error updating resource location: Resource not found.[39m
[2m[22m
[2m    [0m [90m 64 |[39m             })[33m;[39m[22m
[2m     [90m 65 |[39m         } [36mcatch[39m (error) {[22m
[2m    [31m[1m>[22m[2m[39m[90m 66 |[39m             console[33m.[39merror([32m"Error updating resource location:"[39m[33m,[39m error[33m.[39mmessage)[33m;[39m[22m
[2m     [90m    |[39m                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 67 |[39m             res[33m.[39mstatus([35m500[39m)[33m.[39mjson({[22m
[2m     [90m 68 |[39m                 message[33m:[39m [32m"Error updating resource location"[39m[33m,[39m[22m
[2m     [90m 69 |[39m                 error[33m:[39m error[33m.[39mmessage[33m,[39m[0m[22m
[2m[22m
[2m      [2mat error ([22m[2mcontrollers/mapResourceController.js[2m:66:21)[22m[2m[22m
[2m      [2mat call ([22m[2mcontrollers/mapResourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mcontrollers/mapResourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mcontrollers/mapResourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/mapResourceController.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mcontrollers/mapResourceController.js[2m:2:1)[22m[2m[22m

[33mA worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.[39m

[1mSummary of all failing tests[22m
[0m[7m[1m[31m FAIL [39m[22m[27m[0m [2mtests/integration/[22m[1mreviewController.test.js[22m ([0m[1m[41m5.117 s[49m[22m[0m)
[1m[31m  [1m● [22m[1mIntegration Tests for ReviewController › getReviews › should fetch all reviews for a given resource ID successfully (positive)[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 73 |[39m             [36mawait[39m [33mReviewController[39m[33m.[39mgetReviews(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 74 |[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 75 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m    |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 76 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith({[22m
[2m     [90m 77 |[39m                 message[33m:[39m [32m"Reviews fetched successfully"[39m[33m,[39m[22m
[2m     [90m 78 |[39m                 data[33m:[39m expect[33m.[39marrayContaining([[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:75:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mIntegration Tests for ReviewController › getReviews › should return an empty array if no reviews exist for the resource (positive)[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 100 |[39m             [36mawait[39m [33mReviewController[39m[33m.[39mgetReviews(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 101 |[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 102 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 103 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith({[22m
[2m     [90m 104 |[39m                 message[33m:[39m [32m"Reviews fetched successfully"[39m[33m,[39m[22m
[2m     [90m 105 |[39m                 data[33m:[39m [][33m,[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:102:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mIntegration Tests for ReviewController › getReviews › should return 500 if there is an error fetching reviews (negative)[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 117 |[39m[22m
[2m     [90m 118 |[39m             [36mawait[39m [33mReviewController[39m[33m.[39mgetReviews(req[33m,[39m res)[33m;[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 119 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 120 |[39m[22m
[2m     [90m 121 |[39m             jest[33m.[39mrestoreAllMocks()[33m;[39m[22m
[2m     [90m 122 |[39m         })[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:119:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mIntegration Tests for ReviewController › getReviews › should return 500 if there is an error fetching reviews (negative)[39m[22m

    Database Error
[2m[22m
[2m    [0m [90m 108 |[39m[22m
[2m     [90m 109 |[39m         it([32m"should return 500 if there is an error fetching reviews (negative)"[39m[33m,[39m [36masync[39m () [33m=>[39m {[22m
[2m    [31m[1m>[22m[2m[39m[90m 110 |[39m             jest[33m.[39mspyOn(dbConnection[33m,[39m [32m"query"[39m)[33m.[39mmockRejectedValueOnce([36mnew[39m [33mError[39m([32m"Database Error"[39m))[33m;[39m[22m
[2m     [90m     |[39m                                                                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 111 |[39m[22m
[2m     [90m 112 |[39m             [36mconst[39m req [33m=[39m { params[33m:[39m { resourceId[33m:[39m [35m1[39m } }[33m;[39m[22m
[2m     [90m 113 |[39m             [36mconst[39m res [33m=[39m {[0m[22m
[2m[22m
[2m      [2mat _callee7$ ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:110:69)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat _next ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Object.<anonymous> ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mIntegration Tests for ReviewController › addReview › should add a new review successfully (positive)[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m201[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 142 |[39m             [36mawait[39m [33mReviewController[39m[33m.[39maddReview(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 143 |[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 144 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m201[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 145 |[39m[22m
[2m     [90m 146 |[39m             [36mconst[39m [rows] [33m=[39m [36mawait[39m dbConnection[33m.[39mquery([22m
[2m     [90m 147 |[39m                 [32m"SELECT * FROM resource_reviews WHERE review_content = ?"[39m[33m,[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:144:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mIntegration Tests for ReviewController › addReview › should return 500 if there is an error adding the review (negative)[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m201[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 192 |[39m[22m
[2m     [90m 193 |[39m             [36mawait[39m [33mReviewController[39m[33m.[39maddReview(req[33m,[39m res)[33m;[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 194 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m201[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 195 |[39m[22m
[2m     [90m 196 |[39m             jest[33m.[39mrestoreAllMocks()[33m;[39m[22m
[2m     [90m 197 |[39m         })[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:194:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mIntegration Tests for ReviewController › addReview › should return 500 if there is an error adding the review (negative)[39m[22m

    Database Error
[2m[22m
[2m    [0m [90m 179 |[39m[22m
[2m     [90m 180 |[39m         it([32m"should return 500 if there is an error adding the review (negative)"[39m[33m,[39m [36masync[39m () [33m=>[39m {[22m
[2m    [31m[1m>[22m[2m[39m[90m 181 |[39m             jest[33m.[39mspyOn(dbConnection[33m,[39m [32m"query"[39m)[33m.[39mmockRejectedValueOnce([36mnew[39m [33mError[39m([32m"Database Error"[39m))[33m;[39m[22m
[2m     [90m     |[39m                                                                     [31m[1m^[22m[2m[39m[22m
[2m     [90m 182 |[39m[22m
[2m     [90m 183 |[39m             [36mconst[39m req [33m=[39m {[22m
[2m     [90m 184 |[39m                 params[33m:[39m { resourceId[33m:[39m [35m1[39m }[33m,[39m[0m[22m
[2m[22m
[2m      [2mat _callee11$ ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:181:69)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat _next ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Object.<anonymous> ([22m[2m[0m[36mtests/integration/reviewController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[0m[7m[1m[31m FAIL [39m[22m[27m[0m [2mtests/integration/[22m[1mannouncement.test.js[22m ([0m[1m[41m5.429 s[49m[22m[0m)
[1m[31m  [1m● [22m[1mAnnouncement Feature Integration Test › sendAnnouncement › should send an announcement successfully[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 54 |[39m[22m
[2m     [90m 55 |[39m             [90m// Verify the response[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 56 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m    |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 57 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39mobjectContaining({[22m
[2m     [90m 58 |[39m                 message[33m:[39m [32m'Message sent successfully'[39m[33m,[39m[22m
[2m     [90m 59 |[39m                 result[33m:[39m expect[33m.[39many([33mObject[39m)[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:56:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mAnnouncement Feature Integration Test › Negative Test Cases for sendAnnouncement › should fail when message content is missing[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32mObjectContaining {"error": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null", "message": "Error sending message"}[39m
    Received: [31m{"error": "Unknown column 'account_status' in 'where clause'", "message": "Error sending message"}[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 111 |[39m             [90m// Verify the response[39m[22m
[2m     [90m 112 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m500[39m)[33m;[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 113 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39mobjectContaining({[22m
[2m     [90m     |[39m                              [31m[1m^[22m[2m[39m[22m
[2m     [90m 114 |[39m                 message[33m:[39m [32m'Error sending message'[39m[33m,[39m[22m
[2m     [90m 115 |[39m                 error[33m:[39m [32m'Bind parameters must not contain undefined. To pass SQL NULL specify JS null'[39m[22m
[2m     [90m 116 |[39m             }))[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:113:30)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mAnnouncement Feature Integration Test › Negative Test Cases for sendAnnouncement › should fail when the user does not exist[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32mObjectContaining {"error": "User with username 'nonExistentUser' not found.", "message": "Error sending message"}[39m
    Received: [31m{"error": "Unknown column 'account_status' in 'where clause'", "message": "Error sending message"}[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 135 |[39m             [90m// Verify the response[39m[22m
[2m     [90m 136 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m500[39m)[33m;[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 137 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39mobjectContaining({[22m
[2m     [90m     |[39m                              [31m[1m^[22m[2m[39m[22m
[2m     [90m 138 |[39m                 message[33m:[39m [32m'Error sending message'[39m[33m,[39m[22m
[2m     [90m 139 |[39m                 error[33m:[39m [32m"User with username 'nonExistentUser' not found."[39m[22m
[2m     [90m 140 |[39m             }))[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:137:30)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mAnnouncement Feature Integration Test › getAllAnnouncements › should retrieve all announcements[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 165 |[39m[22m
[2m     [90m 166 |[39m             [90m// Verify the response[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 167 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 168 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39many([33mArray[39m))[33m;[39m[22m
[2m     [90m 169 |[39m             [36mconst[39m announcements [33m=[39m res[33m.[39mjson[33m.[39mmock[33m.[39mcalls[[35m0[39m][[35m0[39m][33m;[39m[22m
[2m     [90m 170 |[39m             expect(announcements[33m.[39mlength)[33m.[39mtoBeGreaterThan([35m0[39m)[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:167:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mAnnouncement Feature Integration Test › Negative Test Cases for getAllAnnouncements › should return an empty array when there are no announcements[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 192 |[39m[22m
[2m     [90m 193 |[39m             [90m// Verify the response[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 194 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 195 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith([])[33m;[39m[22m
[2m     [90m 196 |[39m         })[33m;[39m[22m
[2m     [90m 197 |[39m     })[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:194:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/announcement.test.js[39m[0m[2m:2:1)[22m[2m[22m

[0m[7m[1m[31m FAIL [39m[22m[27m[0m [2mtests/integration/[22m[1mwalletControllet.test.js[22m ([0m[1m[41m5.568 s[49m[22m[0m)
[1m[31m  [1m● [22m[1mWalletController Integration Test › getBalance › should return the correct balance for a user[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 48 |[39m             [36mawait[39m [33mWalletController[39m[33m.[39mgetBalance(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 49 |[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 50 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m    |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 51 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith({ balance[33m:[39m [32m"500.00"[39m })[33m;[39m[22m
[2m     [90m 52 |[39m         })[33m;[39m[22m
[2m     [90m 53 |[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:50:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mWalletController Integration Test › getBalance › should return 404 if wallet not found[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m404[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 61 |[39m             [36mawait[39m [33mWalletController[39m[33m.[39mgetBalance(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 62 |[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 63 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m404[39m)[33m;[39m[22m
[2m     [90m    |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 64 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith({ message[33m:[39m [32m'Wallet not found'[39m })[33m;[39m[22m
[2m     [90m 65 |[39m         })[33m;[39m[22m
[2m     [90m 66 |[39m     })[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:63:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mWalletController Integration Test › getCards › should return all cards for a user[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 76 |[39m             [36mawait[39m [33mWalletController[39m[33m.[39mgetCards(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 77 |[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 78 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m    |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 79 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39many([33mArray[39m))[33m;[39m[22m
[2m     [90m 80 |[39m         })[33m;[39m[22m
[2m     [90m 81 |[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:78:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mWalletController Integration Test › getCards › should return an empty array if user has no cards[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 89 |[39m             [36mawait[39m [33mWalletController[39m[33m.[39mgetCards(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 90 |[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 91 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m    |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 92 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith([])[33m;[39m[22m
[2m     [90m 93 |[39m         })[33m;[39m[22m
[2m     [90m 94 |[39m     })[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:91:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mWalletController Integration Test › processDonation › should process a donation successfully[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 110 |[39m             [36mawait[39m [33mWalletController[39m[33m.[39mprocessDonation(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 111 |[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 112 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 113 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith({ message[33m:[39m [32m'Donation successful'[39m })[33m;[39m[22m
[2m     [90m 114 |[39m[22m
[2m     [90m 115 |[39m             [36mconst[39m [rows] [33m=[39m [36mawait[39m dbConnection[33m.[39mquery([32m`[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:112:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mWalletController Integration Test › processDonation › should fail if sender has insufficient balance[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m400[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 134 |[39m             [36mawait[39m [33mWalletController[39m[33m.[39mprocessDonation(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 135 |[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 136 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m400[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 137 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith({ message[33m:[39m [32m'Insufficient balance'[39m })[33m;[39m[22m
[2m     [90m 138 |[39m         })[33m;[39m[22m
[2m     [90m 139 |[39m     })[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:136:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/walletControllet.test.js[39m[0m[2m:2:1)[22m[2m[22m

[0m[7m[1m[31m FAIL [39m[22m[27m[0m [2mtests/unit/[22m[1mincidentPostModel.test.js[22m
[1m[31m  [1m● [22m[1mIncidentPostModel Unit Tests › createIncidentPost › should create a new incident post and return the created post[39m[22m

    Failed to create incident post. Please try again later.
[2m[22m
[2m    [0m [90m 63 |[39m         } [36mcatch[39m (err) {[22m
[2m     [90m 64 |[39m             console[33m.[39merror([32m'Error inserting incident post:'[39m[33m,[39m err[33m.[39mmessage)[33m;[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 65 |[39m             [36mthrow[39m [36mnew[39m [33mError[39m([32m'Failed to create incident post. Please try again later.'[39m)[33m;[39m[22m
[2m     [90m    |[39m                   [31m[1m^[22m[2m[39m[22m
[2m     [90m 66 |[39m         }              [22m
[2m     [90m 67 |[39m     }[22m
[2m     [90m 68 |[39m     [0m[22m
[2m[22m
[2m      [2mat _callee$ ([22m[2mmodels/incidentPostModel.js[2m:65:19)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mIncidentPostModel Unit Tests › insertImage › should insert an image successfully[39m[22m

    TypeError: Invalid attempt to destructure non-iterable instance.
    In order to be iterable, non-array objects must have a [Symbol.iterator]() method.
[2m[22m
[2m    [0m [90m 1 |[39m [36mimport[39m { json } [36mfrom[39m [32m'express'[39m[33m;[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 2 |[39m [36mimport[39m { getDatabaseConnection } [36mfrom[39m [32m'../configurations/dbConfig.js'[39m[33m;[39m[22m
[2m     [90m   |[39m [31m[1m^[22m[2m[39m[22m
[2m     [90m 3 |[39m[22m
[2m     [90m 4 |[39m [36mclass[39m [33mIncidentPostModel[39m {[22m
[2m     [90m 5 |[39m     [36mstatic[39m [36masync[39m createIncidentPost(title[33m,[39m details[33m,[39m resource_details[33m,[39m sender_name[33m,[39m sender_status) {[0m[22m
[2m[22m
[2m      [2mat _nonIterableRest ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat _nonIterableRest ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat _slicedToArray ([22m[2mmodels/incidentPostModel.js[2m:81:72)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostModel.js[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mIncidentPostModel Unit Tests › insertImage › should handle database errors gracefully[39m[22m

    Database error
[2m[22m
[2m    [0m [90m 93 |[39m[22m
[2m     [90m 94 |[39m     it([32m"should handle database errors gracefully"[39m[33m,[39m [36masync[39m () [33m=>[39m {[22m
[2m    [31m[1m>[22m[2m[39m[90m 95 |[39m       mockDb[33m.[39mexecute[33m.[39mmockRejectedValueOnce([36mnew[39m [33mError[39m([32m"Database error"[39m))[33m;[39m[22m
[2m     [90m    |[39m                                            [31m[1m^[22m[2m[39m[22m
[2m     [90m 96 |[39m       [36mconst[39m result [33m=[39m [36mawait[39m [33mIncidentPostModel[39m[33m.[39minsertImage([22m
[2m     [90m 97 |[39m         [32m"testuser"[39m[33m,[39m[22m
[2m     [90m 98 |[39m         [35m1[39m[33m,[39m[0m[22m
[2m[22m
[2m      [2mat _callee4$ ([22m[2m[0m[36mtests/unit/incidentPostModel.test.js[39m[0m[2m:95:44)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/unit/incidentPostModel.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/unit/incidentPostModel.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/unit/incidentPostModel.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/unit/incidentPostModel.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/unit/incidentPostModel.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat _next ([22m[2m[0m[36mtests/unit/incidentPostModel.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Object.<anonymous> ([22m[2m[0m[36mtests/unit/incidentPostModel.test.js[39m[0m[2m:2:1)[22m[2m[22m

[0m[7m[1m[31m FAIL [39m[22m[27m[0m [2mtests/unit/[22m[1mincidentPostMessageModel.test.js[22m
[1m[31m  [1m● [22m[1mIncidentPostMessageModel Unit Tests › createIncidentPostMessageByincidentID › should create a new incident message and return the inserted record[39m[22m

    An error occurred while creating the incident message
[2m[22m
[2m    [0m [90m 59 |[39m         } [36mcatch[39m (err) {[22m
[2m     [90m 60 |[39m             console[33m.[39merror([32m"Error creating incident message:"[39m[33m,[39m err[33m.[39mmessage)[33m;[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 61 |[39m             [36mthrow[39m [36mnew[39m [33mError[39m([32m"An error occurred while creating the incident message"[39m)[33m;[39m[22m
[2m     [90m    |[39m                   [31m[1m^[22m[2m[39m[22m
[2m     [90m 62 |[39m         }        [22m
[2m     [90m 63 |[39m     }[22m
[2m     [90m 64 |[39m[0m[22m
[2m[22m
[2m      [2mat _callee$ ([22m[2mmodels/incidentPostMessageModel.js[2m:61:19)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/incidentPostMessageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/incidentPostMessageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mmodels/incidentPostMessageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostMessageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/incidentPostMessageModel.js[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mIncidentPostMessageModel Unit Tests › createIncidentPostMessageByincidentID › should throw an error if the INSERT query fails[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledTimes[2m([22m[32mexpected[39m[2m)[22m

    Expected number of calls: [32m1[39m
    Received number of calls: [31m2[39m
[2m[22m
[2m    [0m [90m 61 |[39m       )[33m.[39mrejects[33m.[39mtoThrow([32m"An error occurred while creating the incident message"[39m)[33m;[39m[22m
[2m     [90m 62 |[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 63 |[39m       expect(mockDb[33m.[39mexecute)[33m.[39mtoHaveBeenCalledTimes([35m1[39m)[33m;[39m[22m
[2m     [90m    |[39m                              [31m[1m^[22m[2m[39m[22m
[2m     [90m 64 |[39m     })[33m;[39m[22m
[2m     [90m 65 |[39m   })[33m;[39m[22m
[2m     [90m 66 |[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledTimes ([22m[2m[0m[36mtests/unit/incidentPostMessageModel.test.js[39m[0m[2m:63:30)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/unit/incidentPostMessageModel.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/unit/incidentPostMessageModel.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/unit/incidentPostMessageModel.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/unit/incidentPostMessageModel.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/unit/incidentPostMessageModel.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mIncidentPostMessageModel Unit Tests › getIncidentPostMessagesByincidentID › should fetch all messages for a given incident post ID[39m[22m

    [2mexpect([22m[31mreceived[39m[2m).[22mtoEqual[2m([22m[32mexpected[39m[2m) // deep equality[22m

    [32m- Expected  -  3[39m
    [31m+ Received  + 12[39m

    [2m  Array [[22m
    [32m-   "SELECT id, text, sent_time, sender_name, sender_status, incidentPost_id[39m
    [32m-                  FROM incidentMessage[39m
    [32m-                  WHERE incidentPost_id = ?;",[39m
    [31m+   "[39m
    [31m+                     SELECT im.id,[39m
    [31m+                         im.text,[39m
    [31m+                         im.sent_time,[39m
    [31m+                         u.user_name AS sender_name,[39m
    [31m+                         u.status AS sender_status,[39m
    [31m+                         im.incidentPost_id[39m
    [31m+                     FROM incidentMessage im[39m
    [31m+                     JOIN user u ON im.sender_id = u.id[39m
    [31m+                     WHERE im.incidentPost_id = ?[39m
    [31m+                     AND u.account_status = 'active';[39m
    [31m+                  ",[39m
    [2m    Array [[22m
    [2m      1,[22m
    [2m    ],[22m
    [2m  ][22m
[2m[22m
[2m    [0m [90m 91 |[39m[22m
[2m     [90m 92 |[39m       expect(mockDb[33m.[39mexecute)[33m.[39mtoHaveBeenCalledTimes([35m1[39m)[33m;[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 93 |[39m       expect(mockDb[33m.[39mexecute[33m.[39mmock[33m.[39mcalls[[35m0[39m])[33m.[39mtoEqual([[22m
[2m     [90m    |[39m                                            [31m[1m^[22m[2m[39m[22m
[2m     [90m 94 |[39m         [32m`SELECT id, text, sent_time, sender_name, sender_status, incidentPost_id[39m[22m
[2m     [90m 95 |[39m [32m                 FROM incidentMessage[39m[22m
[2m     [90m 96 |[39m [32m                 WHERE incidentPost_id = ?;`[39m[33m,[39m[0m[22m
[2m[22m
[2m      [2mat toEqual ([22m[2m[0m[36mtests/unit/incidentPostMessageModel.test.js[39m[0m[2m:93:44)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/unit/incidentPostMessageModel.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/unit/incidentPostMessageModel.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/unit/incidentPostMessageModel.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/unit/incidentPostMessageModel.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/unit/incidentPostMessageModel.test.js[39m[0m[2m:2:1)[22m[2m[22m

[0m[7m[1m[31m FAIL [39m[22m[27m[0m [2mtests/unit/[22m[1mmessageModel.test.js[22m
[1m[31m  [1m● [22m[1mMessageModel › createMessage › should create a public message successfully[39m[22m

    TypeError: Invalid attempt to destructure non-iterable instance.
    In order to be iterable, non-array objects must have a [Symbol.iterator]() method.
[2m[22m
[2m    [0m [90m 1 |[39m [36mimport[39m { getDatabaseConnection } [36mfrom[39m [32m'../configurations/dbConfig.js'[39m[33m;[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 2 |[39m[22m
[2m     [90m   |[39m [31m[1m^[22m[2m[39m[22m
[2m     [90m 3 |[39m [36mclass[39m [33mMessageModel[39m {[22m
[2m     [90m 4 |[39m     [90m// Existing method to create a public message[39m[22m
[2m     [90m 5 |[39m     [36mstatic[39m [36masync[39m createMessage(messageText[33m,[39m sender[33m,[39m status[33m,[39m timestamp[33m,[39m conversationId) {[0m[22m
[2m[22m
[2m      [2mat _nonIterableRest ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat _nonIterableRest ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat _slicedToArray ([22m[2mmodels/messageModel.js[2m:16:87)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mMessageModel › createPrivateMessage › should create a private message successfully[39m[22m

    TypeError: Invalid attempt to destructure non-iterable instance.
    In order to be iterable, non-array objects must have a [Symbol.iterator]() method.
[2m[22m
[2m    [0m [90m 1 |[39m [36mimport[39m { getDatabaseConnection } [36mfrom[39m [32m'../configurations/dbConfig.js'[39m[33m;[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 2 |[39m[22m
[2m     [90m   |[39m [31m[1m^[22m[2m[39m[22m
[2m     [90m 3 |[39m [36mclass[39m [33mMessageModel[39m {[22m
[2m     [90m 4 |[39m     [90m// Existing method to create a public message[39m[22m
[2m     [90m 5 |[39m     [36mstatic[39m [36masync[39m createMessage(messageText[33m,[39m sender[33m,[39m status[33m,[39m timestamp[33m,[39m conversationId) {[0m[22m
[2m[22m
[2m      [2mat _nonIterableRest ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat _nonIterableRest ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat _slicedToArray ([22m[2mmodels/messageModel.js[2m:202:85)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m

[0m[7m[1m[31m FAIL [39m[22m[27m[0m [2mtests/unit/[22m[1mreviewModel.test.js[22m
[1m[31m  [1m● [22m[1mReviewModel › getReviewsByResourceId › should fetch reviews by resource ID successfully (positive)[39m[22m

    [2mexpect([22m[31mreceived[39m[2m).[22mtoBe[2m([22m[32mexpected[39m[2m) // Object.is equality[22m

    Expected: [32m"SELECT reviewer_name, review_content, upvote_downvote, created_at FROM resource_reviews WHERE resource_id = ? ORDER BY created_at DESC"[39m
    Received: [31m"SELECT [7mu.user_name AS [27mreviewer_name, [7mrr.[27mreview_content, [7mrr.[27mupvote_downvote, [7mrr.[27mcreated_at FROM resource_reviews [7mrr JOIN user u ON rr.reviewer_id = u.id [27mWHERE [7mrr.[27mresource_id = ?[7m AND u.account_status = 'active'[27m ORDER BY [7mrr.[27mcreated_at DESC[7m;[27m"[39m
[2m[22m
[2m    [0m [90m 36 |[39m [32m            `[39m[33m;[39m[22m
[2m     [90m 37 |[39m             [36mconst[39m normalizeQuery [33m=[39m (query) [33m=>[39m query[33m.[39mreplace([35m/\s+/g[39m[33m,[39m [32m" "[39m)[33m.[39mtrim()[33m;[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 38 |[39m             expect(normalizeQuery(mockConnection[33m.[39mexecute[33m.[39mmock[33m.[39mcalls[[35m0[39m][[35m0[39m]))[33m.[39mtoBe(normalizeQuery(expectedQuery))[33m;[39m[22m
[2m     [90m    |[39m                                                                             [31m[1m^[22m[2m[39m[22m
[2m     [90m 39 |[39m             expect(mockConnection[33m.[39mexecute[33m.[39mmock[33m.[39mcalls[[35m0[39m][[35m1[39m])[33m.[39mtoEqual([[35m1[39m])[33m;[39m[22m
[2m     [90m 40 |[39m             expect(result)[33m.[39mtoEqual(reviews)[33m;[39m[22m
[2m     [90m 41 |[39m         })[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toBe ([22m[2m[0m[36mtests/unit/reviewModel.test.js[39m[0m[2m:38:77)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/unit/reviewModel.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/unit/reviewModel.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/unit/reviewModel.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/unit/reviewModel.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/unit/reviewModel.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mReviewModel › addReview › should add a new review successfully (positive)[39m[22m

    TypeError: Invalid attempt to destructure non-iterable instance.
    In order to be iterable, non-array objects must have a [Symbol.iterator]() method.
[2m[22m
[2m    [0m [90m 1 |[39m [36mimport[39m { getDatabaseConnection } [36mfrom[39m [32m"../configurations/dbConfig.js"[39m[33m;[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 2 |[39m[22m
[2m     [90m   |[39m [31m[1m^[22m[2m[39m[22m
[2m     [90m 3 |[39m [36mclass[39m [33mReviewModel[39m {[22m
[2m     [90m 4 |[39m     [90m// Fetch reviews by resource ID[39m[22m
[2m     [90m 5 |[39m     [36mstatic[39m [36masync[39m getReviewsByResourceId(resourceId) {[0m[22m
[2m[22m
[2m      [2mat _nonIterableRest ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat _nonIterableRest ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat _slicedToArray ([22m[2mmodels/reviewModel.js[2m:40:91)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/reviewModel.js[2m:2:1)[22m[2m[22m

[0m[7m[1m[31m FAIL [39m[22m[27m[0m [2mtests/integration/[22m[1memergencyContactController.test.js[22m ([0m[1m[41m6.804 s[49m[22m[0m)
[1m[31m  [1m● [22m[1mEmergencyContactController Integration Test › sendConnectRequest › should send a connect request from testA to testB[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 76 |[39m             [36mawait[39m [33mEmergencyContactController[39m[33m.[39msendConnectRequest(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 77 |[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 78 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m    |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 79 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith([22m
[2m     [90m 80 |[39m                 expect[33m.[39mobjectContaining({[22m
[2m     [90m 81 |[39m                     message[33m:[39m [32m"Connect request sent successfully"[39m[33m,[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/emergencyContactController.test.js[39m[0m[2m:78:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/emergencyContactController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/emergencyContactController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/emergencyContactController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/emergencyContactController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/emergencyContactController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mEmergencyContactController Integration Test › acceptConnectRequest › should accept a connect request from testA to testB[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 145 |[39m             [36mawait[39m [33mEmergencyContactController[39m[33m.[39macceptConnectRequest(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 146 |[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 147 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 148 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith([22m
[2m     [90m 149 |[39m                 expect[33m.[39mobjectContaining({[22m
[2m     [90m 150 |[39m                     message[33m:[39m [32m"Connect request accepted successfully"[39m[33m,[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/emergencyContactController.test.js[39m[0m[2m:147:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/emergencyContactController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/emergencyContactController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/emergencyContactController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/emergencyContactController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/emergencyContactController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[0m[7m[1m[31m FAIL [39m[22m[27m[0m [2mtests/integration/[22m[1mmessageController.test.js[22m ([0m[1m[41m7.466 s[49m[22m[0m)
[1m[31m  [1m● [22m[1mMessageController Integration Test › sendPrivateMessage › should send multiple private messages from testA to testB[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 68 |[39m[22m
[2m     [90m 69 |[39m                 [90m// Verify the response[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 70 |[39m                 expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m    |[39m                                    [31m[1m^[22m[2m[39m[22m
[2m     [90m 71 |[39m                 expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39mobjectContaining({[22m
[2m     [90m 72 |[39m                     message[33m:[39m [32m'Private message sent successfully'[39m[33m,[39m[22m
[2m     [90m 73 |[39m                     result[33m:[39m expect[33m.[39many([33mObject[39m)[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:70:36)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mMessageController Integration Test › Negative Test Cases › should fail when sending a message to a non-existent recipient[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m404[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 109 |[39m[22m
[2m     [90m 110 |[39m             [90m// Verify the response[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 111 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m404[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 112 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39mobjectContaining({[22m
[2m     [90m 113 |[39m                 error[33m:[39m [32m'Sender or recipient not found.'[39m[22m
[2m     [90m 114 |[39m             }))[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:111:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mMessageController Integration Test › getPrivateMessages › should retrieve private messages between testA and testB[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 201 |[39m[22m
[2m     [90m 202 |[39m             [90m// Verify the response[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 203 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 204 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39many([33mArray[39m))[33m;[39m[22m
[2m     [90m 205 |[39m[22m
[2m     [90m 206 |[39m             [90m// Verify that the messages include the ones we sent earlier[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:203:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mMessageController Integration Test › Negative Test Cases › should return an empty array when there are no messages between users[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 238 |[39m[22m
[2m     [90m 239 |[39m             [90m// Verify the response[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 240 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 241 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith([])[33m;[39m[22m
[2m     [90m 242 |[39m         })[33m;[39m[22m
[2m     [90m 243 |[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:240:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mMessageController Integration Test › Negative Test Cases › should fail when recipient does not exist[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m404[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 258 |[39m[22m
[2m     [90m 259 |[39m             [90m// Verify the response[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 260 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m404[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 261 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39mobjectContaining({[22m
[2m     [90m 262 |[39m                 error[33m:[39m [32m'Sender or recipient not found.'[39m[22m
[2m     [90m 263 |[39m             }))[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:260:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mMessageController Integration Test › getUnreadMessages › should retrieve unread messages from testA to testB[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 290 |[39m[22m
[2m     [90m 291 |[39m             [90m// Verify the response[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 292 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 293 |[39m             [36mconst[39m unreadMessages [33m=[39m res[33m.[39mjson[33m.[39mmock[33m.[39mcalls[[35m0[39m][[35m0[39m][33m;[39m[22m
[2m     [90m 294 |[39m             expect([33mArray[39m[33m.[39misArray(unreadMessages))[33m.[39mtoBe([36mtrue[39m)[33m;[39m[22m
[2m     [90m 295 |[39m             expect(unreadMessages[33m.[39mlength)[33m.[39mtoBeGreaterThan([35m0[39m)[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:292:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mMessageController Integration Test › Negative Test Cases › should return an empty array when there are no unread messages[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 330 |[39m[22m
[2m     [90m 331 |[39m             [90m// Verify the response[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 332 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 333 |[39m             [36mconst[39m unreadMessages [33m=[39m res[33m.[39mjson[33m.[39mmock[33m.[39mcalls[[35m0[39m][[35m0[39m][33m;[39m[22m
[2m     [90m 334 |[39m             expect([33mArray[39m[33m.[39misArray(unreadMessages))[33m.[39mtoBe([36mtrue[39m)[33m;[39m[22m
[2m     [90m 335 |[39m             expect(unreadMessages[33m.[39mlength)[33m.[39mtoBe([35m0[39m)[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:332:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mMessageController Integration Test › Negative Test Cases › should fail when recipient does not exist[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m404[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 351 |[39m[22m
[2m     [90m 352 |[39m             [90m// Verify the response[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 353 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m404[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 354 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39mobjectContaining({[22m
[2m     [90m 355 |[39m                 error[33m:[39m [32m'Sender or recipient not found.'[39m[22m
[2m     [90m 356 |[39m             }))[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:353:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mMessageController Integration Test › markMessagesAsRead › should mark messages as read between testA and testB[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 383 |[39m[22m
[2m     [90m 384 |[39m             [90m// Verify the response[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 385 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 386 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39mobjectContaining({[22m
[2m     [90m 387 |[39m                 message[33m:[39m [32m'Messages marked as read'[39m[33m,[39m[22m
[2m     [90m 388 |[39m                 result[33m:[39m expect[33m.[39many([33mObject[39m)[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:385:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mMessageController Integration Test › Negative Test Cases › should fail when recipient does not exist[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m404[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 415 |[39m[22m
[2m     [90m 416 |[39m             [90m// Verify the response[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 417 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m404[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 418 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39mobjectContaining({[22m
[2m     [90m 419 |[39m                 error[33m:[39m [32m'Recipient or user not found'[39m[22m
[2m     [90m 420 |[39m             }))[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:417:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/messageController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[0m[7m[1m[31m FAIL [39m[22m[27m[0m [2mtests/integration/[22m[1mresourceController.test.js[22m ([0m[1m[41m7.573 s[49m[22m[0m)
[1m[31m  [1m● [22m[1mResourceController Integration Tests › getUserResources › should fetch the resources for a specific user[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 57 |[39m             [36mawait[39m [33mResourceController[39m[33m.[39mgetUserResources(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 58 |[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 59 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m    |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 60 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith({[22m
[2m     [90m 61 |[39m                 username[33m:[39m [32m'testUser1'[39m[33m,[39m[22m
[2m     [90m 62 |[39m                 water[33m:[39m [35m10[39m[33m,[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:59:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mResourceController Integration Tests › getUserResources › should return 404 if the user is not found[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m404[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 75 |[39m             [36mawait[39m [33mResourceController[39m[33m.[39mgetUserResources(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 76 |[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 77 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m404[39m)[33m;[39m[22m
[2m     [90m    |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 78 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39mobjectContaining({[22m
[2m     [90m 79 |[39m                 error[33m:[39m [32m'User resources not found'[39m[33m,[39m[22m
[2m     [90m 80 |[39m             }))[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:77:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mResourceController Integration Tests › createResourceRequest › should create a new resource request from user1 to user2[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m201[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 163 |[39m             [36mawait[39m [33mResourceController[39m[33m.[39mcreateResourceRequest(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 164 |[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 165 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m201[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 166 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39mobjectContaining({[22m
[2m     [90m 167 |[39m                 message[33m:[39m [32m'Resource request created successfully'[39m[33m,[39m[22m
[2m     [90m 168 |[39m                 request[33m:[39m expect[33m.[39many([33mObject[39m)[33m,[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:165:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mResourceController Integration Tests › createResourceRequest › should return 404 if requested user does not exist[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m404[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 194 |[39m             [36mawait[39m [33mResourceController[39m[33m.[39mcreateResourceRequest(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 195 |[39m         [22m
[2m    [31m[1m>[22m[2m[39m[90m 196 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m404[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 197 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith({[22m
[2m     [90m 198 |[39m                 error[33m:[39m [32m'Requested user not found or has no resources available.'[39m[33m,[39m[22m
[2m     [90m 199 |[39m             })[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:196:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mResourceController Integration Tests › createResourceRequest › should return 400 if the requested quantity exceeds available amount of user2[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m400[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 239 |[39m             [36mawait[39m [33mResourceController[39m[33m.[39mcreateResourceRequest(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 240 |[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 241 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m400[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 242 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith({[22m
[2m     [90m 243 |[39m                 error[33m:[39m [32m'Requested quantity exceeds available amount.'[39m[33m,[39m[22m
[2m     [90m 244 |[39m             })[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:241:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mResourceController Integration Tests › getAllSentRequests › should fetch all requests sent by a user[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 266 |[39m             [36mawait[39m [33mResourceController[39m[33m.[39mgetAllSentRequests(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 267 |[39m     [22m
[2m    [31m[1m>[22m[2m[39m[90m 268 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 269 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39marrayContaining([[22m
[2m     [90m 270 |[39m                 expect[33m.[39mobjectContaining({[22m
[2m     [90m 271 |[39m                     requester_username[33m:[39m [32m'testUser1'[39m[33m,[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:268:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mResourceController Integration Tests › getAllSentRequests › should return 404 if no sent requests found for this user[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m404[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 300 |[39m             [36mawait[39m [33mResourceController[39m[33m.[39mgetAllSentRequests(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 301 |[39m     [22m
[2m    [31m[1m>[22m[2m[39m[90m 302 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m404[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 303 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith({[22m
[2m     [90m 304 |[39m                 message[33m:[39m [32m'No sent requests found for this user'[39m[33m,[39m[22m
[2m     [90m 305 |[39m             })[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:302:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mResourceController Integration Tests › approveRequest › should approve a request and update resources for both users[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 332 |[39m             [36mawait[39m [33mResourceController[39m[33m.[39mapproveRequest(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 333 |[39m     [22m
[2m    [31m[1m>[22m[2m[39m[90m 334 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 335 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith({[22m
[2m     [90m 336 |[39m                 message[33m:[39m [32m'Request approved and resources updated'[39m[33m,[39m[22m
[2m     [90m 337 |[39m             })[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:334:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mResourceController Integration Tests › approveRequest › should return 404 if the request does not exist[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m404[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 364 |[39m             [36mawait[39m [33mResourceController[39m[33m.[39mapproveRequest(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 365 |[39m     [22m
[2m    [31m[1m>[22m[2m[39m[90m 366 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m404[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 367 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith({[22m
[2m     [90m 368 |[39m                 error[33m:[39m [32m'Request not found'[39m[33m,[39m[22m
[2m     [90m 369 |[39m             })[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:366:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/resourceController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[0m[7m[1m[31m FAIL [39m[22m[27m[0m [2mtests/integration/[22m[1mESNController.test.js[22m
[1m[31m  [1m● [22m[1mIntegration Test › getUserCitizenStatus › should return the citizen status and username of the test user[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 36 |[39m[22m
[2m     [90m 37 |[39m             [90m// Verify the response[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 38 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m    |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 39 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith({[22m
[2m     [90m 40 |[39m                 username[33m:[39m [32m'test'[39m[33m,[39m[22m
[2m     [90m 41 |[39m                 citizenStatus[33m:[39m [32m'Undefined'[39m[33m,[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/ESNController.test.js[39m[0m[2m:38:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/ESNController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/ESNController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/ESNController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/ESNController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/ESNController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mIntegration Test › updateUserCitizenStatus › should update the citizen status of the test user and verify it[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 78 |[39m[22m
[2m     [90m 79 |[39m             [90m// Verify the update response[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 80 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m    |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 81 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith({ message[33m:[39m [32m'Citizen status updated successfully'[39m })[33m;[39m[22m
[2m     [90m 82 |[39m[22m
[2m     [90m 83 |[39m             [90m// Now, verify the update by querying the database directly[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/ESNController.test.js[39m[0m[2m:80:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/ESNController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/ESNController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/ESNController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/ESNController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/ESNController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mIntegration Test › updateUserCitizenStatus › should return 404 when trying to update a user that does not exist[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m404[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 100 |[39m[22m
[2m     [90m 101 |[39m             [90m// Verify the response[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 102 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m404[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 103 |[39m             expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith({[22m
[2m     [90m 104 |[39m                 error[33m:[39m [32m'User not found'[39m[33m,[39m[22m
[2m     [90m 105 |[39m             })[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/ESNController.test.js[39m[0m[2m:102:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/ESNController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/ESNController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/ESNController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/ESNController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/ESNController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mIntegration Test › getAllUsers › should return a list of all users[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 117 |[39m             [36mawait[39m [33mESNController[39m[33m.[39mgetAllUsers(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 118 |[39m     [22m
[2m    [31m[1m>[22m[2m[39m[90m 119 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m     |[39m                                [31m[1m^[22m[2m[39m[22m
[2m     [90m 120 |[39m     [22m
[2m     [90m 121 |[39m             [90m// Expected users array with multiple entries for verification[39m[22m
[2m     [90m 122 |[39m             [36mconst[39m expectedUsers [33m=[39m [[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/ESNController.test.js[39m[0m[2m:119:32)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/ESNController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/ESNController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/ESNController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/ESNController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/ESNController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[0m[7m[1m[31m FAIL [39m[22m[27m[0m [2mtests/integration/[22m[1msearchController.test.js[22m
[1m[31m  [1m● [22m[1msearchController Integration Tests › postAmmouncementSearch › should return formatted announcement search results with wordList, limit, and offset (Positive Case)[39m[22m

    Unknown column 'u.account_status' in 'where clause'
[2m[22m
[2m    [0m [90m 69 |[39m     [22m
[2m     [90m 70 |[39m             [90m// Execute the query with the patterns as input[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 71 |[39m             [36mconst[39m [rows] [33m=[39m [36mawait[39m connection[33m.[39mexecute(query[33m,[39m searchPatterns)[33m;[39m[22m
[2m     [90m    |[39m                                             [31m[1m^[22m[2m[39m[22m
[2m     [90m 72 |[39m             console[33m.[39mlog([32m'Fetched announcements from database:'[39m[33m,[39m rows)[33m;[39m[22m
[2m     [90m 73 |[39m             [36mreturn[39m rows[33m;[39m[22m
[2m     [90m 74 |[39m         } [36mcatch[39m (error) {[0m[22m
[2m[22m
[2m      [2mat PromiseConnection.execute ([22m[2mnode_modules/mysql2/promise.js[2m:112:22)[22m[2m[22m
[2m      [2mat execute ([22m[2mmodels/messageModel.js[2m:71:45)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1msearchController Integration Tests › postPrivateMessageSearch › should return formatted private message search results (Positive Case)[39m[22m

    Unknown column 'u_sender.account_status' in 'where clause'
[2m[22m
[2m    [0m [90m 264 |[39m     [22m
[2m     [90m 265 |[39m             [90m// Execute the query[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 266 |[39m             [36mconst[39m [rows] [33m=[39m [36mawait[39m connection[33m.[39mexecute(query[33m,[39m queryParams)[33m;[39m[22m
[2m     [90m     |[39m                                             [31m[1m^[22m[2m[39m[22m
[2m     [90m 267 |[39m     [22m
[2m     [90m 268 |[39m             [36mreturn[39m rows[33m;[39m[22m
[2m     [90m 269 |[39m         } [36mcatch[39m (error) {[0m[22m
[2m[22m
[2m      [2mat PromiseConnection.execute ([22m[2mnode_modules/mysql2/promise.js[2m:112:22)[22m[2m[22m
[2m      [2mat execute ([22m[2mmodels/messageModel.js[2m:266:45)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1msearchController Integration Tests › postPublicMessageSearch › should return formatted public message search results (Positive Case)[39m[22m

    Unknown column 'u.account_status' in 'where clause'
[2m[22m
[2m    [0m [90m 101 |[39m     [22m
[2m     [90m 102 |[39m             [90m// Execute the query with the patterns as input[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 103 |[39m             [36mconst[39m [rows] [33m=[39m [36mawait[39m connection[33m.[39mexecute(query[33m,[39m searchPatterns)[33m;[39m[22m
[2m     [90m     |[39m                                             [31m[1m^[22m[2m[39m[22m
[2m     [90m 104 |[39m             console[33m.[39mlog([32m'Fetched announcements from database:'[39m[33m,[39m rows)[33m;[39m[22m
[2m     [90m 105 |[39m             [36mreturn[39m rows[33m;[39m[22m
[2m     [90m 106 |[39m         } [36mcatch[39m (error) {[0m[22m
[2m[22m
[2m      [2mat PromiseConnection.execute ([22m[2mnode_modules/mysql2/promise.js[2m:112:22)[22m[2m[22m
[2m      [2mat execute ([22m[2mmodels/messageModel.js[2m:103:45)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/messageModel.js[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1msearchController Integration Tests › postStatusSearch › should return user status search results (Positive Case)[39m[22m

    Unknown column 'account_status' in 'where clause'
[2m[22m
[2m    [0m [90m 138 |[39m[22m
[2m     [90m 139 |[39m             [90m// Execute query with the provided citizen status[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 140 |[39m             [36mconst[39m [rows] [33m=[39m [36mawait[39m connection[33m.[39mexecute(query[33m,[39m [citizenStatus])[33m;[39m[22m
[2m     [90m     |[39m                                             [31m[1m^[22m[2m[39m[22m
[2m     [90m 141 |[39m[22m
[2m     [90m 142 |[39m             [36mif[39m (rows[33m.[39mlength [33m===[39m [35m0[39m) {[22m
[2m     [90m 143 |[39m                 console[33m.[39mlog([32m`No users found with status: ${citizenStatus}`[39m)[33m;[39m[0m[22m
[2m[22m
[2m      [2mat PromiseConnection.execute ([22m[2mnode_modules/mysql2/promise.js[2m:112:22)[22m[2m[22m
[2m      [2mat execute ([22m[2mmodels/userModel.js[2m:140:45)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1msearchController Integration Tests › postUsernameSearch › should return username search results (Positive Case)[39m[22m

    Unknown column 'account_status' in 'where clause'
[2m[22m
[2m    [0m [90m 242 |[39m[22m
[2m     [90m 243 |[39m             [90m// Add wildcards to search for partial matches[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 244 |[39m             [36mconst[39m [rows] [33m=[39m [36mawait[39m connection[33m.[39mexecute(query[33m,[39m [[22m
[2m     [90m     |[39m                                             [31m[1m^[22m[2m[39m[22m
[2m     [90m 245 |[39m                 [32m`%${partialUsername}%`[39m[33m,[39m[22m
[2m     [90m 246 |[39m             ])[33m;[39m[22m
[2m     [90m 247 |[39m[0m[22m
[2m[22m
[2m      [2mat PromiseConnection.execute ([22m[2mnode_modules/mysql2/promise.js[2m:112:22)[22m[2m[22m
[2m      [2mat execute ([22m[2mmodels/userModel.js[2m:244:45)[22m[2m[22m
[2m      [2mat call ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2mmodels/userModel.js[2m:2:1)[22m[2m[22m

[0m[7m[1m[31m FAIL [39m[22m[27m[0m [2mtests/integration/[22m[1mincidentPostMessageController.test.js[22m ([0m[1m[41m10.204 s[49m[22m[0m)
[1m[31m  [1m● [22m[1mIncidentPostMessageController Integration Tests › getIncidentPosts › should fetch all incident posts with associated images[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 77 |[39m       [36mawait[39m [33mIncidentPostMessageController[39m[33m.[39mgetIncidentPosts(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 78 |[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 79 |[39m       expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m    |[39m                          [31m[1m^[22m[2m[39m[22m
[2m     [90m 80 |[39m       expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39mobjectContaining({[22m
[2m     [90m 81 |[39m         message[33m:[39m [32m"Incident posts retrieved successfully"[39m[33m,[39m[22m
[2m     [90m 82 |[39m         data[33m:[39m expect[33m.[39many([33mArray[39m)[33m,[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:79:26)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mIncidentPostMessageController Integration Tests › getIncidentPosts › should return 404 if no incident posts exist[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m404[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 90 |[39m       [36mawait[39m [33mIncidentPostMessageController[39m[33m.[39mgetIncidentPosts(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 91 |[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 92 |[39m       expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m404[39m)[33m;[39m[22m
[2m     [90m    |[39m                          [31m[1m^[22m[2m[39m[22m
[2m     [90m 93 |[39m       expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39mobjectContaining({[22m
[2m     [90m 94 |[39m         message[33m:[39m [32m"No incident posts found"[39m[33m,[39m[22m
[2m     [90m 95 |[39m       }))[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:92:26)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mIncidentPostMessageController Integration Tests › getIncidentPostByID › should fetch a single incident post by its ID[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 103 |[39m       [36mawait[39m [33mIncidentPostMessageController[39m[33m.[39mgetIncidentPostByID(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 104 |[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 105 |[39m       expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m     |[39m                          [31m[1m^[22m[2m[39m[22m
[2m     [90m 106 |[39m       expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39mobjectContaining({[22m
[2m     [90m 107 |[39m         message[33m:[39m [32m"Incident post retrieved successfully"[39m[33m,[39m[22m
[2m     [90m 108 |[39m         data[33m:[39m expect[33m.[39mobjectContaining({[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:105:26)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mIncidentPostMessageController Integration Tests › getIncidentPostByID › should return 404 if the incident post does not exist[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m404[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 117 |[39m       [36mawait[39m [33mIncidentPostMessageController[39m[33m.[39mgetIncidentPostByID(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 118 |[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 119 |[39m       expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m404[39m)[33m;[39m[22m
[2m     [90m     |[39m                          [31m[1m^[22m[2m[39m[22m
[2m     [90m 120 |[39m       expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39mobjectContaining({[22m
[2m     [90m 121 |[39m         message[33m:[39m [32m"Incident post not found"[39m[33m,[39m[22m
[2m     [90m 122 |[39m       }))[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:119:26)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mIncidentPostMessageController Integration Tests › getIncidentCommentByincidentID › should fetch all responses for a specific incident post[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m200[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 141 |[39m       [36mawait[39m [33mIncidentPostMessageController[39m[33m.[39mgetIncidentCommentByincidentID(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 142 |[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 143 |[39m       expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m200[39m)[33m;[39m[22m
[2m     [90m     |[39m                          [31m[1m^[22m[2m[39m[22m
[2m     [90m 144 |[39m       expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39mobjectContaining({[22m
[2m     [90m 145 |[39m         message[33m:[39m [32m"Incident responses retrieved successfully"[39m[33m,[39m[22m
[2m     [90m 146 |[39m         data[33m:[39m expect[33m.[39many([33mArray[39m)[33m,[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:143:26)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mIncidentPostMessageController Integration Tests › getIncidentCommentByincidentID › should return 404 if no responses exist for the incident post[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m404[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 156 |[39m       [36mawait[39m [33mIncidentPostMessageController[39m[33m.[39mgetIncidentCommentByincidentID(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 157 |[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 158 |[39m       expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m404[39m)[33m;[39m[22m
[2m     [90m     |[39m                          [31m[1m^[22m[2m[39m[22m
[2m     [90m 159 |[39m       expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39mobjectContaining({[22m
[2m     [90m 160 |[39m         message[33m:[39m [32m"No incident responses found"[39m[33m,[39m[22m
[2m     [90m 161 |[39m       }))[33m;[39m[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:158:26)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m

[1m[31m  [1m● [22m[1mIncidentPostMessageController Integration Tests › newIncidentCommentByincidentID › should create a new response for an incident post[39m[22m

    [2mexpect([22m[31mjest.fn()[39m[2m).[22mtoHaveBeenCalledWith[2m([22m[32m...expected[39m[2m)[22m

    Expected: [32m201[39m
    Received: [31m500[39m

    Number of calls: [31m1[39m
[2m[22m
[2m    [0m [90m 174 |[39m       [36mawait[39m [33mIncidentPostMessageController[39m[33m.[39mnewIncidentCommentByincidentID(req[33m,[39m res)[33m;[39m[22m
[2m     [90m 175 |[39m[22m
[2m    [31m[1m>[22m[2m[39m[90m 176 |[39m       expect(res[33m.[39mstatus)[33m.[39mtoHaveBeenCalledWith([35m201[39m)[33m;[39m[22m
[2m     [90m     |[39m                          [31m[1m^[22m[2m[39m[22m
[2m     [90m 177 |[39m       expect(res[33m.[39mjson)[33m.[39mtoHaveBeenCalledWith(expect[33m.[39mobjectContaining({[22m
[2m     [90m 178 |[39m         message[33m:[39m [32m"Incident response created successfully"[39m[33m,[39m[22m
[2m     [90m 179 |[39m         data[33m:[39m expect[33m.[39mobjectContaining({[0m[22m
[2m[22m
[2m      [2mat toHaveBeenCalledWith ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:176:26)[22m[2m[22m
[2m      [2mat call ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator.tryCatch ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat Generator._invoke [as next] ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m
[2m      [2mat asyncGeneratorStep ([22m[2m[0m[36mtests/integration/incidentPostMessageController.test.js[39m[0m[2m:2:1)[22m[2m[22m


[1mTest Suites: [22m[1m[31m13 failed[39m[22m, [1m[32m11 passed[39m[22m, 24 total
[1mTests:       [22m[1m[31m63 failed[39m[22m, [1m[32m193 passed[39m[22m, 256 total
[1mSnapshots:   [22m0 total
[1mTime:[22m        11.799 s, estimated 13 s
[2mRan all test suites[22m[2m.[22m
